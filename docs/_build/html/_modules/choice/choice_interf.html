<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>choice.choice_interf &mdash; CHOICE  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            CHOICE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../source/api/choice.html">CHOICE</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">CHOICE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">choice.choice_interf</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for choice.choice_interf</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Module choice_interf</span>

<span class="sd">Choice interface: used to set the required parameters for the noise calculation and call the physics-based methods from</span>
<span class="sd">the module choice_physics.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">choice.choice_physics</span> <span class="k">as</span> <span class="nn">choice_physics</span>
<span class="kn">import</span> <span class="nn">choice.choice_aux</span> <span class="k">as</span> <span class="nn">choice_aux</span>
<span class="kn">import</span> <span class="nn">choice.choice_data</span> <span class="k">as</span> <span class="nn">choice_data</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>

<span class="n">maxNoPts</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># Maximum number of operating points</span>
<span class="n">version_num</span> <span class="o">=</span> <span class="s1">&#39;1.0&#39;</span>


<div class="viewcode-block" id="get_version_num">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.get_version_num">[docs]</a>
<span class="k">def</span> <span class="nf">get_version_num</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Writes CHOICE version number in output file. &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;! Choice version: &#39;</span> <span class="o">+</span> <span class="n">version_num</span><span class="p">)</span></div>



<div class="viewcode-block" id="WeightChoice">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.WeightChoice">[docs]</a>
<span class="k">class</span> <span class="nc">WeightChoice</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Instantiate the engine size and architecture data.</span>

<span class="sd">    :param dict weightFile: Engine sizing data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weightFile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Constructs all the necessary attributes for the noise calculation, from the provided weightAircraft file.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">MtipD_fan</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MtipFan&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">MtipD_fan</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MtipD_fan</span> <span class="o">&gt;</span> <span class="mf">3.0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MtipD_fan</span> <span class="o">&lt;</span> <span class="mf">0.7</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;unexpected value on MtipD_fan in WeightChoice in choice_interf&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xnlD_fan</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xnl&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xnlD_fan</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">xnlD_fan</span> <span class="o">&gt;</span> <span class="mi">600</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;xnl from weightFile very large. Unit should always be rps!&#39;</span><span class="p">,</span> <span class="s1">&#39;setFan&#39;</span><span class="p">,</span> <span class="s1">&#39;SetWeightChoice&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rss_fan</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FanRss&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rss_fan</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rss_fan</span> <span class="o">&gt;</span> <span class="mf">300.0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rss_fan</span> <span class="o">&lt;</span> <span class="mf">5.0</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;unexpected value on rss_fan in WeightChoice in choice_interf&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N_rotors_fan</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FanR1BNb&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N_stators_fan</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FanVsOgvNb&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">A2_fan</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FanA2&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">A2_fan</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">A2_fan</span> <span class="o">&gt;</span> <span class="mf">50.0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">A2_fan</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;unexpected value on A2_fan in WeightChoice in choice_interf&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">D1_fan</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FanR1BDiaOuter&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">D1_fan</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">D1_fan</span> <span class="o">&lt;</span> <span class="mf">0.1</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">D1_fan</span> <span class="o">&gt;</span> <span class="mf">10.0</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;unexpected value on D1_fan in WeightChoice in choice_interf&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">n_stages_LPC</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;stages_LPC&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gbx_ratio</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;GBX_ratio&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MtipD_lpc</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MtipLpc&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xnlD_lpc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xnlD_fan</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gbx_ratio</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rss_lpc</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;RSS_compr&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N_rotors_lpc</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;N_compr&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N_stators_lpc</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;S_compr&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">D1_lpc</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;r_compr&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Dh1_lpc</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rh_compr&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">gbx_ratio</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;GBX_ratio&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N_rotors_lpt</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LptStgLastBNb&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SRS_lpt</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SRS&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_stages_lpt</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;stages_LPT&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">De_lpt</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LptStgLastDiaOuter&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ae_lpt</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LptStgLastAExit&#39;</span><span class="p">)</span>

        <span class="c1"># Build-in combustor model data, derived from the noise prediction method development literature</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_comb</span> <span class="o">=</span> <span class="s1">&#39;SAC&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Nfmax_comb</span> <span class="o">=</span> <span class="mi">40</span>  <span class="c1"># total number of DAC fuel nozzles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Aec_comb</span> <span class="o">=</span> <span class="mf">0.13926166</span> <span class="o">/</span> <span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">ft2m</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># combustor exit area (ft^2)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">De_comb</span> <span class="o">=</span> <span class="mf">10.543032</span> <span class="o">/</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">ft2m</span>  <span class="c1"># exhaust nozzle exit plane effective diameter (ft)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Dh_comb</span> <span class="o">=</span> <span class="mf">4.218432</span> <span class="o">/</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">ft2m</span>  <span class="c1"># exhaust nozzle exit plane hydraulic diameter (ft)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Lc_comb</span> <span class="o">=</span> <span class="mf">0.13968984</span> <span class="o">/</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">ft2m</span>  <span class="c1"># combustor nominal length (ft)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_comb</span> <span class="o">=</span> <span class="mf">0.06348984</span> <span class="o">/</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">ft2m</span>  <span class="c1"># annulus height at combustor exit (ft)</span>

        <span class="k">if</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CombType&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">type_comb</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CombType&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;maxNo_nozzles_dac&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Nfmax_comb</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;maxNo_nozzles_dac&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;A_comb_exit&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Aec_comb</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;A_comb_exit&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">ft2m</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Deff_comb&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">De_comb</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Deff_comb&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">ft2m</span>
        <span class="k">if</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Dhyd_comb&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Dh_comb</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Dhyd_comb&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">ft2m</span>
        <span class="k">if</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Lc_comb&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Lc_comb</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Lc_comb&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">ft2m</span>
        <span class="k">if</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;h_annulus_comb&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">h_comb</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;h_annulus_comb&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">ft2m</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">A_core_caj</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;A_core&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">A_bypass_caj</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;A_bypass&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">MtipD_ff</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Mtipff&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">MtipD_ff</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MtipD_ff</span> <span class="o">&gt;</span> <span class="mf">3.0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MtipD_ff</span> <span class="o">&lt;</span> <span class="mf">0.7</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;unexpected value on MtipD_ff in WeightChoice in choice_interf&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xnlD_ff</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xnlff&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xnlD_ff</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">xnlD_ff</span> <span class="o">&gt;</span> <span class="mi">600</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;xnlff from weightFile very large. Unit should always be rps!&#39;</span><span class="p">,</span> <span class="s1">&#39;setff&#39;</span><span class="p">,</span> <span class="s1">&#39;SetWeightChoice&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rss_ff</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ffRss&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rss_ff</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rss_ff</span> <span class="o">&gt;</span> <span class="mf">300.0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rss_ff</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">5.0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;unexpected value on rss_ff in WeightChoice in choice_interf&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N_rotors_ff</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ffR1BNb&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N_stators_ff</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ffVsOgvNb&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">A2_ff</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ffA2&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">A2_ff</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">A2_ff</span> <span class="o">&gt;</span> <span class="mf">50.0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">A2_ff</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;unexpected value on A2_ff in WeightChoice in choice_interf&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">D1_ff</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ffR1BDiaOuter&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">D1_ff</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">D1_ff</span> <span class="o">&lt;</span> <span class="mf">0.1</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">D1_ff</span> <span class="o">&gt;</span> <span class="mf">10.0</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;unexpected value on D1_ff in WeightChoice in choice_interf&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">A_core_caj_ffn</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;A_core_ffn&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">A_bypass_caj_ffn</span> <span class="o">=</span> <span class="n">weightFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;A_bypass_ffn&#39;</span><span class="p">)</span></div>



<div class="viewcode-block" id="NoiseChoice">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.NoiseChoice">[docs]</a>
<span class="k">class</span> <span class="nc">NoiseChoice</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Instantiate the required input arguments for the noise prediction cases to be run.</span>

<span class="sd">    :param dict noiseFile: Definition of the noise cases to be performed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">noiseFile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Constructs all the necessary attributes for the noise calculation, from the provided inputNoise file. &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">opPnt</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;point&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nops</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opPnt</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nops</span> <span class="o">&gt;</span> <span class="n">maxNoPts</span><span class="p">:</span> <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s1">&#39;number of noise points greater than allowed&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">trajectory_performance</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="s1">&#39;true&#39;</span> <span class="ow">in</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;trajectory_performance&#39;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">trajectory_performance</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">use_trajectory_preparser</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="s1">&#39;true&#39;</span> <span class="ow">in</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;use_trajectory_preparser&#39;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_trajectory_preparser</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">gen_noise_source_matr</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="s1">&#39;true&#39;</span> <span class="ow">in</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;generate_noise_sources&#39;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen_noise_source_matr</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_source_spectra</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="s1">&#39;true&#39;</span> <span class="ow">in</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_source_spectra&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_source_spectra</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">directivity_plot</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;directivity_angle_to_plot&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">directivity_plot</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">use_ground_reflection</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s1">&#39;false&#39;</span> <span class="ow">in</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;use_ground_reflection&#39;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_ground_reflection</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">use_spherical_spreading</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s1">&#39;false&#39;</span> <span class="ow">in</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;use_spherical_spreading&#39;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_spherical_spreading</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">use_atmospheric_attenuation</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s1">&#39;false&#39;</span> <span class="ow">in</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;use_atmospheric_attenuation&#39;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_atmospheric_attenuation</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">use_suppression_factor</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">S_fan_inlet</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">S_fan_dis</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">S_lpt</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="s1">&#39;true&#39;</span> <span class="ow">in</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;use_suppression_factor&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_suppression_factor</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">S_fan_inlet</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fan_inlet_suppression&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">S_fan_dis</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fan_dis_suppression&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">S_lpt</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lpt_suppression&#39;</span><span class="p">)</span>

        <span class="c1"># type_nozzles only affects the total EPNL calculation. If it is set to mix, the fan discharge noise source</span>
        <span class="c1"># will be removed. The default is separate nozzles.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_nozzles</span> <span class="o">=</span> <span class="s2">&quot;separate&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_nozzles</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type_nozzles&#39;</span><span class="p">)</span>  <span class="c1"># &quot;separate&quot; or &quot;mix&quot;, other type will not be recognized</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fan_distortion</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fan_distortion&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fan_distortion</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ff_distortion</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ff_distortion&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ff_distortion</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fuselage_fan</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="s1">&#39;true&#39;</span> <span class="ow">in</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fuselage_fan&#39;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuselage_fan</span> <span class="o">=</span> <span class="kc">True</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">xmic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ymic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zmic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dt_mic</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dt_mic&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elevation</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ground_elevation&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Nf_comb_ign</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Nf_comb_pattern</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nops</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xmic</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xmic&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ymic</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ymic&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">zmic</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;zmic&#39;</span><span class="p">)</span>
            <span class="c1"># Combustor ignited nozzles</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Nf_comb_ign</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;comb_ign_nozzles&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Nf_comb_pattern</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dac_nozzle_pattern&#39;</span><span class="p">))</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">nops</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nops</span> <span class="o">&gt;</span> <span class="n">maxNoPts</span><span class="p">:</span> <span class="n">sys</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="s1">&#39;number of noise points greater than allowed&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">xmic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">xm</span><span class="p">)</span> <span class="k">for</span> <span class="n">xm</span> <span class="ow">in</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xmic&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xmic</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nops</span><span class="p">:</span> <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s1">&#39;xmic data not consistent with number of points&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ymic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">ym</span><span class="p">)</span> <span class="k">for</span> <span class="n">ym</span> <span class="ow">in</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ymic&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ymic</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nops</span><span class="p">:</span> <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s1">&#39;ymic data not consistent with number of points&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">zmic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">zm</span><span class="p">)</span> <span class="k">for</span> <span class="n">zm</span> <span class="ow">in</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;zmic&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zmic</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nops</span><span class="p">:</span> <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s1">&#39;zmic data not consistent with number of points&#39;</span><span class="p">)</span>

            <span class="c1"># Combustor ignited nozzles</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Nf_comb_ign</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">nf</span><span class="p">)</span> <span class="k">for</span> <span class="n">nf</span> <span class="ow">in</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;comb_ign_nozzles&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Nf_comb_pattern</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">nf</span><span class="p">)</span> <span class="k">for</span> <span class="n">nf</span> <span class="ow">in</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dac_nozzle_pattern&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Sw_airfrm</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;wing_area&#39;</span><span class="p">)</span>  <span class="c1"># wing area m2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">span_airfrm</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;wing_span&#39;</span><span class="p">)</span>  <span class="c1"># wing span m</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ND</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;jet_aircraft_coef&#39;</span><span class="p">))</span>  <span class="c1"># coefficient for te noise (1 -&gt; +6 dB)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flap_type</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;flap_type&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NoFlap</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;noFlaps&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NoFlap</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">S_flap_airfrm</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;flap_area&#39;</span><span class="p">)</span>  <span class="c1"># flap area m2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">span_flap_airfrm</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;flap_span&#39;</span><span class="p">)</span>  <span class="c1"># flap span m</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">S_flap_airfrm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span> <span class="k">for</span> <span class="n">sf</span> <span class="ow">in</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;flap_area&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">span_flap_airfrm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">bf</span><span class="p">)</span> <span class="k">for</span> <span class="n">bf</span> <span class="ow">in</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;flap_span&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slat_type</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;leading_edge_type&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">span_hor_tail</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;horizontal_tail_span&#39;</span><span class="p">)</span>  <span class="c1"># horizontal tail span m</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Sht</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;horizontal_tail_area&#39;</span><span class="p">)</span>  <span class="c1"># horizontal tail area m2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">span_ver_tail</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;vertical_tail_span&#39;</span><span class="p">)</span>  <span class="c1"># vertical tail span m</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Svt</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;vertical_tail_area&#39;</span><span class="p">)</span>  <span class="c1"># vertical tail area m2</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">no_engines</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;no_engines&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_engine</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;engine_height&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dtIsa</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dtIsa&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_weight_airfrm</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;aircraft_mass&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nlg_airfrm</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;noLG&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nlg_airfrm</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">d_wheel_airfrm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;d_wheel&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">ft2m</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">d_strut_airfrm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;d_strut&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">ft2m</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">d_wire_airfrm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;d_wire&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">ft2m</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">N_wheels_airfrm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Nwheels&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">N_struts_airfrm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Nstruts&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">d_wheel_airfrm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">dw</span><span class="p">)</span> <span class="k">for</span> <span class="n">dw</span> <span class="ow">in</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;d_wheel&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span> <span class="o">/</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">ft2m</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">d_strut_airfrm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span> <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;d_strut&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span> <span class="o">/</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">ft2m</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">d_wire_airfrm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">dw</span><span class="p">)</span> <span class="k">for</span> <span class="n">dw</span> <span class="ow">in</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;d_wire&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span> <span class="o">/</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">ft2m</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">N_wheels_airfrm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">nw</span><span class="p">)</span> <span class="k">for</span> <span class="n">nw</span> <span class="ow">in</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Nwheels&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">N_struts_airfrm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span> <span class="k">for</span> <span class="n">ns</span> <span class="ow">in</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Nstruts&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">defl_flap_airfrm_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">defl_slat_airfrm_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LandingGear</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nops</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">defl_flap_airfrm_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;defl_flap&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">defl_slat_airfrm_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;defl_slat&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LandingGear</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LandingGear_vec&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">defl_flap_airfrm_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;defl_flap&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">defl_slat_airfrm_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span> <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;defl_slat&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LandingGear</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">lg</span><span class="p">)</span> <span class="k">for</span> <span class="n">lg</span> <span class="ow">in</span> <span class="n">noiseFile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LandingGear_vec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span></div>



<div class="viewcode-block" id="Trajectory">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.Trajectory">[docs]</a>
<span class="k">class</span> <span class="nc">Trajectory</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Instantiate the trajectory data of the aircraft.</span>

<span class="sd">    :param int ipnt: Operating point (trajectory) number in order of appearance in the inputNoise.txt</span>
<span class="sd">    :param str opPnt: Operating point (trajectory), e.g. Approach, Cutback, Sideline</span>
<span class="sd">    :param NoiseChoice noise_choice: Noise prediction input data</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ipnt</span><span class="p">,</span> <span class="n">opPnt</span><span class="p">,</span> <span class="n">noise_choice</span><span class="p">,</span> <span class="n">input_folder</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Constructs all the necessary attributes for the trajectory object to be used in the noise calculation,</span>
<span class="sd">        for the selected trajectories. Computes distance to mic (r), flight path angle (clgr), time and angle between</span>
<span class="sd">        aircraft and microphone (xsi). &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">read_trajectory_input</span><span class="p">(</span><span class="n">opPnt</span><span class="p">,</span> <span class="n">input_folder</span><span class="p">,</span> <span class="n">noise_choice</span><span class="o">.</span><span class="n">h_engine</span><span class="p">)</span>  <span class="c1"># read trajectory data from file</span>

        <span class="k">if</span> <span class="s1">&#39;Approach&#39;</span> <span class="ow">in</span> <span class="n">opPnt</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">noise_choice</span><span class="o">.</span><span class="n">xmic</span><span class="p">[</span><span class="n">ipnt</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span>
                         <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">noise_choice</span><span class="o">.</span><span class="n">ymic</span><span class="p">[</span><span class="n">ipnt</span><span class="p">]</span> <span class="o">-</span> <span class="n">noise_choice</span><span class="o">.</span><span class="n">elevation</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span>
                         <span class="n">noise_choice</span><span class="o">.</span><span class="n">zmic</span><span class="p">[</span><span class="n">ipnt</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># distance along trajectory to microphone</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">clgr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj_pts</span><span class="p">)</span>  <span class="c1"># flight path angle along trajectory</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj_pts</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">clgr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">atan</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>

            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clgr</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span> <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s1">&#39;not a number (NaN) computed for clgr&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">clgr</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj_pts</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clgr</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj_pts</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">get_xsi</span><span class="p">(</span><span class="n">noise_choice</span><span class="o">.</span><span class="n">xmic</span><span class="p">[</span><span class="n">ipnt</span><span class="p">],</span> <span class="n">noise_choice</span><span class="o">.</span><span class="n">ymic</span><span class="p">[</span><span class="n">ipnt</span><span class="p">]</span> <span class="o">+</span> <span class="n">noise_choice</span><span class="o">.</span><span class="n">elevation</span><span class="p">,</span> <span class="n">noise_choice</span><span class="o">.</span><span class="n">zmic</span><span class="p">[</span><span class="n">ipnt</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xsi</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span> <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s1">&#39;not a number computed for xsi&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xsid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xsi</span><span class="p">)</span>

        <span class="c1"># time is computed for 2D trajectory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj_pts</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_traj_pts</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="c1"># aircraft is not moving - impossible to compute time =&gt; set a fictitious time</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># use average velocity</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">V_avg</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Va</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Va</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">V_avg</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span> <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s1">&#39;not a number computed for time&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Trajectory.set_time_vector">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.Trajectory.set_time_vector">[docs]</a>
    <span class="k">def</span> <span class="nf">set_time_vector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ipnt</span><span class="p">,</span> <span class="n">noise_choice</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the retarded time.</span>

<span class="sd">        :param int ipnt: Operating point (trajectory) number in order of appearance in the inputNoise.txt</span>
<span class="sd">        :param NoiseChoice noise_choice: NoiseChoice object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">noise_choice</span><span class="o">.</span><span class="n">dt_mic</span>

        <span class="c1"># create tmic (starting from when the first noise reaches the microphone from xstart (i.e. r[0]/a[0]) to when</span>
        <span class="c1"># the noise reaches the microphone from the last point)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tmic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dt</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">n_times</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tmic</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">t_source</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_times</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_source</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_times</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_source</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_times</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">va_source</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_times</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a_source</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_times</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_times</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clgr_source</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_times</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">x_source</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">noise_choice</span><span class="o">.</span><span class="n">xmic</span><span class="p">[</span><span class="n">ipnt</span><span class="p">]</span>  <span class="c1"># use mic-related coordinate system</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_source</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">noise_choice</span><span class="o">.</span><span class="n">ymic</span><span class="p">[</span><span class="n">ipnt</span><span class="p">]</span> <span class="o">+</span> <span class="n">noise_choice</span><span class="o">.</span><span class="n">elevation</span><span class="p">)</span>  <span class="c1"># use mic-related coordinate system</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">va_source</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Va</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a_source</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clgr_source</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clgr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z_source</span> <span class="o">=</span> <span class="n">noise_choice</span><span class="o">.</span><span class="n">zmic</span><span class="p">[</span><span class="n">ipnt</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_source</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_source</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_source</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="c1"># distance between source and microphone.</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_times</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">va_source</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">dx</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dx</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_source</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_source</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_source</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">clgr_source</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">a_source</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">va_source</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">r1</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">a_source</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="p">)</span>

            <span class="c1"># update using dx</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x_source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_source</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dx</span>
            <span class="n">dy</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clgr_source</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">y_source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_source</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dy</span>
            <span class="n">dr</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dx</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">r1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_source</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t_source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_source</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t_source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_source</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dr</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">va_source</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

            <span class="c1"># interpolate</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clgr_source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">clgr</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">)(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">x_source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">noise_choice</span><span class="o">.</span><span class="n">xmic</span><span class="p">[</span><span class="n">ipnt</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">va_source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Va</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">)(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">x_source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">noise_choice</span><span class="o">.</span><span class="n">xmic</span><span class="p">[</span><span class="n">ipnt</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">a_source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">)(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">x_source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">noise_choice</span><span class="o">.</span><span class="n">xmic</span><span class="p">[</span><span class="n">ipnt</span><span class="p">])</span></div>


<div class="viewcode-block" id="Trajectory.set_velocity">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.Trajectory.set_velocity">[docs]</a>
    <span class="k">def</span> <span class="nf">set_velocity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtIsa</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes ambient temperature (ta), speed of sound (a) and Mach number (Ma) along the trajectory</span>

<span class="sd">        :param float dtIsa: Deviation from ISA temperature</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">get_R</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pa</span> <span class="o">=</span> <span class="n">choice_physics</span><span class="o">.</span><span class="n">AtmosphericEffects</span><span class="o">.</span><span class="n">get_p_ambient</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ta</span> <span class="o">=</span> <span class="n">choice_physics</span><span class="o">.</span><span class="n">AtmosphericEffects</span><span class="o">.</span><span class="n">get_t_ambient</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">dtIsa</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">choice_physics</span><span class="o">.</span><span class="n">AtmosphericEffects</span><span class="o">.</span><span class="n">get_sound_speed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ta</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Va</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span></div>


<div class="viewcode-block" id="Trajectory.get_dx">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.Trajectory.get_dx">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_dx</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">Va</span><span class="p">,</span> <span class="n">tnext</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes distance travelled until the location of the next noise sample generation.</span>

<span class="sd">        :param float x1: x coordinate of first sample (in relation to microphone)</span>
<span class="sd">        :param float y1: y coordinate (height) of first sample (in relation to microphone)</span>
<span class="sd">        :param float z1: z coordinate of microphone</span>
<span class="sd">        :param float dt: Time interval between sounds reaching the microphone</span>
<span class="sd">        :param float gamma: Flight path angle</span>
<span class="sd">        :param float c0: Speed of sound at aircraft location</span>
<span class="sd">        :param float Va: Aircraft speed</span>
<span class="sd">        :param float tnext: Next sampling time</span>

<span class="sd">        :return float: The distance that the aircraft travelled</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">solution_found</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">tg</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">gamma</span><span class="p">))</span>
        <span class="n">r1</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x1</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">y1</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">z1</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

        <span class="n">a</span> <span class="o">=</span> <span class="p">((</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">tg</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">Va</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="n">Va</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">b</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">r1</span> <span class="o">+</span> <span class="n">c0</span> <span class="o">*</span> <span class="n">dt</span><span class="p">)</span> <span class="o">*</span> <span class="n">c0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">tg</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">Va</span> <span class="o">-</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">-</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">y1</span> <span class="o">*</span> <span class="n">tg</span>
        <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="n">c0</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">dt</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">r1</span> <span class="o">*</span> <span class="n">c0</span> <span class="o">*</span> <span class="n">dt</span>

        <span class="n">sol1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">b</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">c</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span>
        <span class="n">sol2</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">b</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">c</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span>

        <span class="c1"># pick solution</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">sol1</span>
        <span class="n">y2</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">sol1</span> <span class="o">*</span> <span class="n">tg</span>
        <span class="n">z2</span> <span class="o">=</span> <span class="n">z1</span>
        <span class="n">dr</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sol1</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">sol1</span> <span class="o">*</span> <span class="n">tg</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">attempt1</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x2</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">z2</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">c0</span> <span class="o">+</span> <span class="n">dr</span> <span class="o">/</span> <span class="n">Va</span>
        <span class="n">res</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">attempt1</span> <span class="o">-</span> <span class="n">tnext</span><span class="p">)</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">tnext</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">res</span> <span class="o">&lt;</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">sys</span><span class="o">.</span><span class="n">float_info</span><span class="o">.</span><span class="n">epsilon</span><span class="p">:</span>
            <span class="n">dx</span> <span class="o">=</span> <span class="n">sol1</span>
            <span class="n">solution_found</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">x2</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">sol2</span>
        <span class="n">y2</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">sol2</span> <span class="o">*</span> <span class="n">tg</span>
        <span class="n">dr</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sol2</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">sol2</span> <span class="o">*</span> <span class="n">tg</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">attempt2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x2</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">z2</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">c0</span> <span class="o">+</span> <span class="n">dr</span> <span class="o">/</span> <span class="n">Va</span>
        <span class="n">res</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">attempt2</span> <span class="o">-</span> <span class="n">tnext</span><span class="p">)</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">tnext</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">res</span> <span class="o">&lt;</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">sys</span><span class="o">.</span><span class="n">float_info</span><span class="o">.</span><span class="n">epsilon</span><span class="p">:</span>
            <span class="n">dx</span> <span class="o">=</span> <span class="n">sol2</span>
            <span class="n">solution_found</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">solution_found</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;failed to establish solution in get_dx in choice_interf&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dx</span></div>


<div class="viewcode-block" id="Trajectory.get_xsi">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.Trajectory.get_xsi">[docs]</a>
    <span class="k">def</span> <span class="nf">get_xsi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmic</span><span class="p">,</span> <span class="n">ymic</span><span class="p">,</span> <span class="n">zmic</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the angle between the direction of the aircraft&#39;s motion and the sound propagation path.</span>

<span class="sd">        :param float xmic: Microphone/observer horizontal distance (m)</span>
<span class="sd">        :param float ymic: Microphone/observer height (m)</span>
<span class="sd">        :param float zmic: Microphone/observer lateral horizontal distance (m)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">zmic</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ex</span> <span class="o">=</span> <span class="p">(</span><span class="n">xmic</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">xmic</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">zmic</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">ymic</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">ey</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">ymic</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">xmic</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">zmic</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">ymic</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">ez</span> <span class="o">=</span> <span class="n">zmic</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">xmic</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">zmic</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">ymic</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">ex_body</span> <span class="o">=</span> <span class="n">ex</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clgr</span><span class="p">))</span> <span class="o">-</span> <span class="n">ey</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clgr</span><span class="p">))</span>
            <span class="n">ey_body</span> <span class="o">=</span> <span class="n">ex</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clgr</span><span class="p">))</span> <span class="o">+</span> <span class="n">ey</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clgr</span><span class="p">))</span>
            <span class="n">ez_body</span> <span class="o">=</span> <span class="n">ez</span>
            <span class="n">fi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">ex_body</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xsi</span> <span class="o">=</span> <span class="n">fi</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">ey</span><span class="p">,</span> <span class="n">ez</span><span class="p">))</span>
            <span class="n">ex_body_w_alpha</span> <span class="o">=</span> <span class="n">ex</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clgr</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">))</span> <span class="o">-</span> \
                              <span class="n">ey</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clgr</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xsi_alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">ex_body_w_alpha</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">((</span><span class="n">xmic</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">ymic</span><span class="p">))</span>
            <span class="n">fi</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;=</span> <span class="n">ymic</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="n">psi</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">fi</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xsi</span> <span class="o">=</span> <span class="n">psi</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clgr</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xsi_alpha</span> <span class="o">=</span> <span class="n">psi</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clgr</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">)</span></div>


<div class="viewcode-block" id="Trajectory.read_trajectory_input">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.Trajectory.read_trajectory_input">[docs]</a>
    <span class="k">def</span> <span class="nf">read_trajectory_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">opPnt</span><span class="p">,</span> <span class="n">input_folder</span><span class="p">,</span> <span class="n">h_engine</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads and stores the trajectory data (position, velocity and angle of attack) for the provided operating point</span>

<span class="sd">        :param str opPnt: Operating point</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">file</span> <span class="o">=</span> <span class="n">input_folder</span> <span class="o">+</span> <span class="n">opPnt</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;.txt&#39;</span>

        <span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Va</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fp</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">line</span><span class="p">:</span>  <span class="c1"># omit blank lines</span>
                    <span class="n">li</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">li</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;!&#39;</span><span class="p">):</span>
                        <span class="n">string</span> <span class="o">=</span> <span class="n">li</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                        <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">string</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                        <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">string</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                        <span class="n">Va</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">string</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
                        <span class="n">alpha</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">string</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">continue</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">h_engine</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Va</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Va</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_traj_pts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span></div>


<div class="viewcode-block" id="Trajectory.set">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.Trajectory.set">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">ipnt</span><span class="p">,</span> <span class="n">opPnt</span><span class="p">,</span> <span class="n">noise_choice</span><span class="p">,</span> <span class="n">input_folder</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the required trajectory details for the noise calculation.</span>

<span class="sd">        :param int ipnt: Operating point (trajectory) number in order of appearance in the inputNoise.txt</span>
<span class="sd">        :param str opPnt: Operating point (trajectory), e.g. Approach, Cutback, Sideline</span>
<span class="sd">        :param NoiseChoice noise_choice: NoiseChoice object</span>

<span class="sd">        :return Trajectory: A trajectory object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">traj</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">ipnt</span><span class="p">,</span> <span class="n">opPnt</span><span class="p">,</span> <span class="n">noise_choice</span><span class="p">,</span> <span class="n">input_folder</span><span class="p">)</span>  <span class="c1"># Compute r, clgr, xsi and time</span>
        <span class="n">traj</span><span class="o">.</span><span class="n">set_velocity</span><span class="p">(</span><span class="n">noise_choice</span><span class="o">.</span><span class="n">dtIsa</span><span class="p">)</span>  <span class="c1"># compute ta, a and Ma</span>
        <span class="n">traj</span><span class="o">.</span><span class="n">set_time_vector</span><span class="p">(</span><span class="n">ipnt</span><span class="p">,</span> <span class="n">noise_choice</span><span class="p">)</span>  <span class="c1"># compute &quot;retarded&quot; vectors at source</span>

        <span class="k">return</span> <span class="n">traj</span></div>
</div>



<div class="viewcode-block" id="set_rotational_speeds_choice">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.set_rotational_speeds_choice">[docs]</a>
<span class="k">def</span> <span class="nf">set_rotational_speeds_choice</span><span class="p">(</span><span class="n">mpd</span><span class="p">,</span> <span class="n">weightChoice</span><span class="p">,</span> <span class="n">comp</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Estimates absolute speeds from relative rotating speeds (from performance) using several points. </span>
<span class="sd">    </span>
<span class="sd">    :param MultptPerfData mpd: Multipoint performance data</span>
<span class="sd">    :param WeightChoice weightChoice: Engine sizing data</span>
<span class="sd">    :param str comp: Engine component</span>
<span class="sd">    </span>
<span class="sd">    :return MultptPerfData: Updated multipoint performance data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">comp</span> <span class="o">==</span> <span class="s1">&#39;Fan&#39;</span><span class="p">:</span>
        <span class="n">param</span> <span class="o">=</span> <span class="s1">&#39;NL&#39;</span>
        <span class="n">xnlD</span> <span class="o">=</span> <span class="n">weightChoice</span><span class="o">.</span><span class="n">xnlD_fan</span>
    <span class="k">elif</span> <span class="n">comp</span> <span class="o">==</span> <span class="s1">&#39;Fuselage_fan&#39;</span><span class="p">:</span>
        <span class="n">param</span> <span class="o">=</span> <span class="s1">&#39;NFF&#39;</span>
        <span class="n">xnlD</span> <span class="o">=</span> <span class="n">weightChoice</span><span class="o">.</span><span class="n">xnlD_ff</span>

    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">mpd</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
        <span class="n">N</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">mpd</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mpd</span><span class="o">.</span><span class="n">perf_file_sl</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">N</span><span class="p">[</span><span class="s2">&quot;perf_file_to&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">N</span><span class="p">[</span><span class="s2">&quot;perf_file_sl&quot;</span><span class="p">]</span>  <span class="c1"># use sideline data instead of take-off if</span>
    <span class="c1"># sideline exists.</span>

    <span class="c1"># form ratios and use the WEICO value</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">N</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">N</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">xnlD</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">/</span> <span class="n">N</span><span class="p">[</span><span class="s2">&quot;perf_file_toc&quot;</span><span class="p">])</span>
        <span class="n">mpd</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="n">N</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">mpd</span></div>



<div class="viewcode-block" id="PerformanceChoice">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.PerformanceChoice">[docs]</a>
<span class="k">class</span> <span class="nc">PerformanceChoice</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Instantiate the engine performance data.</span>

<span class="sd">    :param int ptr: Operating point (trajectory) number in order of appearance in the inputNoise.txt</span>
<span class="sd">    :param bool trajPerf: If true, trajectory data are used, else, single point study is performed</span>
<span class="sd">    :param str point: Operating point</span>
<span class="sd">    :param int n_traj: Number of trajectory points</span>
<span class="sd">    :param WeightChoice Weight_choice: Engine sizing data</span>
<span class="sd">    :param MultptPerfData mpd: Multipoint performance data</span>
<span class="sd">    :param str input_folder: Input files folder path</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ptr</span><span class="p">,</span> <span class="n">trajPerf</span><span class="p">,</span> <span class="n">point</span><span class="p">,</span> <span class="n">n_traj</span><span class="p">,</span> <span class="n">weight_choice</span><span class="p">,</span> <span class="n">mpd</span><span class="p">,</span> <span class="n">input_folder</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Constructs the basic attributes for the engine performance that are required for the noise calculation. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ptr</span> <span class="o">=</span> <span class="n">ptr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trajPerf</span> <span class="o">=</span> <span class="n">trajPerf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="n">point</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">openRotor</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span> <span class="o">=</span> <span class="n">n_traj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weight_choice</span> <span class="o">=</span> <span class="n">weight_choice</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mpd</span> <span class="o">=</span> <span class="n">mpd</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span> <span class="o">=</span> <span class="n">input_folder</span>

<div class="viewcode-block" id="PerformanceChoice.getIsOpenRotor">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.PerformanceChoice.getIsOpenRotor">[docs]</a>
    <span class="k">def</span> <span class="nf">getIsOpenRotor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">modules</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Checks if it is an open rotor. &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">module</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Prop&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">openRotor</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">openRotor</span></div>


<div class="viewcode-block" id="PerformanceChoice.coAxialJet">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.PerformanceChoice.coAxialJet">[docs]</a>
    <span class="k">def</span> <span class="nf">coAxialJet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Sets the jet performance parameters. &quot;&quot;&quot;</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_coAxialJet_performance.txt&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trajPerf</span><span class="p">:</span>
            <span class="n">storage_mat</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">loadStorageMat</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dmdt_1_caj</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dmdt_2_caj</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v_1_caj</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v_2_caj</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T_1_caj</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T_2_caj</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">5</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># 2 is cold.</span>
            <span class="n">W8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;W8&#39;</span><span class="p">)</span>
            <span class="n">W18</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;W18&#39;</span><span class="p">)</span>
            <span class="n">M8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;M8&#39;</span><span class="p">)</span>
            <span class="n">M18</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;M18&#39;</span><span class="p">)</span>
            <span class="n">T8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;T8&#39;</span><span class="p">)</span>
            <span class="n">T18</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;T18&#39;</span><span class="p">)</span>

            <span class="n">C18</span> <span class="o">=</span> <span class="n">choice_physics</span><span class="o">.</span><span class="n">AtmosphericEffects</span><span class="o">.</span><span class="n">getVel</span><span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">gamma_air</span><span class="p">,</span> <span class="n">T18</span><span class="p">,</span> <span class="n">M18</span><span class="p">)</span>
            <span class="n">C8</span> <span class="o">=</span> <span class="n">choice_physics</span><span class="o">.</span><span class="n">AtmosphericEffects</span><span class="o">.</span><span class="n">getVel</span><span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">gamma_gas</span><span class="p">,</span> <span class="n">T8</span><span class="p">,</span> <span class="n">M8</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">dmdt_1_caj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">W8</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dmdt_2_caj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">W18</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v_1_caj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">C8</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v_2_caj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">C18</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T_1_caj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">T8</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T_2_caj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">T18</span><span class="p">)</span></div>


<div class="viewcode-block" id="PerformanceChoice.setAirfrm">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.PerformanceChoice.setAirfrm">[docs]</a>
    <span class="k">def</span> <span class="nf">setAirfrm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">noise_choice</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Sets the airframe performance parameters. &quot;&quot;&quot;</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_airfrm_performance.txt&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trajPerf</span><span class="p">:</span>
            <span class="n">storage_mat</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">loadStorageMat</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">defl_flap_airfrm</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">defl_slat_airfrm</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LandingGear</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">defl_flap_airfrm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">noise_choice</span><span class="o">.</span><span class="n">defl_flap_airfrm_vec</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ptr</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">defl_slat_airfrm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">noise_choice</span><span class="o">.</span><span class="n">defl_slat_airfrm_vec</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ptr</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LandingGear</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">noise_choice</span><span class="o">.</span><span class="n">LandingGear</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ptr</span><span class="p">])</span></div>


<div class="viewcode-block" id="PerformanceChoice.setLpt">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.PerformanceChoice.setLpt">[docs]</a>
    <span class="k">def</span> <span class="nf">setLpt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Sets the low pressure turbine performance parameters. &quot;&quot;&quot;</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_lpt_performance.txt&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trajPerf</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">containsStars</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Discovered raw trajectory mission file (lpt) - computing *** and ** from other data and &#39;</span>
                      <span class="s1">&#39;re-writing file (this is done only once)&#39;</span><span class="p">)</span>
                <span class="n">choice_aux</span><span class="o">.</span><span class="n">preProcessLptFile</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_choice</span><span class="o">.</span><span class="n">De_lpt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_choice</span><span class="o">.</span><span class="n">Ae_lpt</span><span class="p">)</span>

            <span class="n">storage_mat</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">loadStorageMat</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Vtr_lpt</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Texit_lpt</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xnl_lpt</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mcore_lpt</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Cax_lpt</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># use performanceResults.txt file and additional data to estimate the trajectory variables.</span>
            <span class="n">xnl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;NL&#39;</span><span class="p">)</span>
            <span class="n">t5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;T5&#39;</span><span class="p">)</span>
            <span class="n">w5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;W5&#39;</span><span class="p">)</span>
            <span class="n">p5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;P5&#39;</span><span class="p">)</span>
            <span class="n">Cax</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">get_Cax</span><span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">gamma_gas</span><span class="p">,</span> <span class="n">p5</span><span class="p">,</span> <span class="n">t5</span><span class="p">,</span> <span class="n">w5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_choice</span><span class="o">.</span><span class="n">Ae_lpt</span><span class="p">)</span>

            <span class="n">xnl_lpt</span> <span class="o">=</span> <span class="n">xnl</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_choice</span><span class="o">.</span><span class="n">gbx_ratio</span>  <span class="c1"># xnl should be fan speed</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Vtr_lpt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_choice</span><span class="o">.</span><span class="n">De_lpt</span><span class="p">)</span> <span class="o">*</span> <span class="n">xnl_lpt</span> <span class="o">*</span> <span class="mf">0.70</span><span class="p">)</span>
            <span class="c1"># when the relative tip speed is unknown, use 70% of the blade tip speed</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Texit_lpt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">t5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xnl_lpt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">xnl</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_choice</span><span class="o">.</span><span class="n">gbx_ratio</span><span class="p">)</span>  <span class="c1"># xnl should be fan speed</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mcore_lpt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">w5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Cax_lpt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">Cax</span><span class="p">)</span></div>


<div class="viewcode-block" id="PerformanceChoice.setComb">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.PerformanceChoice.setComb">[docs]</a>
    <span class="k">def</span> <span class="nf">setComb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Sets the combustor performance parameters. &quot;&quot;&quot;</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_comb_performance.txt&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trajPerf</span><span class="p">:</span>
            <span class="n">storage_mat</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">loadStorageMat</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">P3_comb</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">P4_comb</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">P7_comb</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T3_comb</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T4_comb</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T5_comb</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">5</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">W3_comb</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">6</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># use performanceResults.txt file and additional data to estimate the trajectory variables.</span>
            <span class="n">P3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;P3&#39;</span><span class="p">)</span>
            <span class="n">P4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;P4&#39;</span><span class="p">)</span>
            <span class="n">P7</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;P5&#39;</span><span class="p">)</span>
            <span class="n">T3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;T3&#39;</span><span class="p">)</span>
            <span class="n">T4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;T4&#39;</span><span class="p">)</span>
            <span class="n">T5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;T5&#39;</span><span class="p">)</span>
            <span class="n">W3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;W3&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">P3_comb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">P3</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">P4_comb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">P4</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">P7_comb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">P7</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T3_comb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">T3</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T4_comb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">T4</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T5_comb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">T5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">W3_comb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">W3</span><span class="p">)</span></div>


<div class="viewcode-block" id="PerformanceChoice.setFan">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.PerformanceChoice.setFan">[docs]</a>
    <span class="k">def</span> <span class="nf">setFan</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Sets the fan performance parameters. &quot;&quot;&quot;</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_fan_performance.txt&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trajPerf</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">containsStars</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Discovered raw trajectory mission file (fan) - computing Mtip and Mu from other data and &#39;</span>
                      <span class="s1">&#39;re-writing file (this is done only once)&#39;</span><span class="p">)</span>
                <span class="n">choice_aux</span><span class="o">.</span><span class="n">preProcessFanFile</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_choice</span><span class="o">.</span><span class="n">D1_fan</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_choice</span><span class="o">.</span><span class="n">A2_fan</span><span class="p">)</span>

            <span class="n">storage_mat</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">loadStorageMat</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Mtip_fan</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Mu_fan</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xnl_fan</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dt_fan</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">g1_fan</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># use performanceResults.txt file and additional data to estimate the trajectory variables.</span>
            <span class="n">xnl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;NL&#39;</span><span class="p">)</span>
            <span class="n">g1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;W2&#39;</span><span class="p">)</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;T2&#39;</span><span class="p">)</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;T13&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="n">t1</span>
            <span class="n">p1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;P2&#39;</span><span class="p">)</span>
            <span class="p">[</span><span class="n">Mtip</span><span class="p">,</span> <span class="n">Mu</span><span class="p">,</span> <span class="n">Umid</span><span class="p">]</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">setMachNumbers</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_choice</span><span class="o">.</span><span class="n">A2_fan</span><span class="p">,</span>
                                                         <span class="bp">self</span><span class="o">.</span><span class="n">weight_choice</span><span class="o">.</span><span class="n">D1_fan</span><span class="p">,</span> <span class="n">xnl</span><span class="p">,</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">gamma_air</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">xnl_fan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">xnl</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dt_fan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">g1_fan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">g1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Mtip_fan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">Mtip</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Mu_fan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">Mu</span><span class="p">)</span></div>


<div class="viewcode-block" id="PerformanceChoice.setLpc">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.PerformanceChoice.setLpc">[docs]</a>
    <span class="k">def</span> <span class="nf">setLpc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Sets the low pressure compressor performance parameters. &quot;&quot;&quot;</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_lpc_performance.txt&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trajPerf</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">containsStars</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Discovered raw trajectory mission file (lpc) - computing Mtip and Mu from other data and &#39;</span>
                      <span class="s1">&#39;re-writing file (this is done only once)&#39;</span><span class="p">)</span>
                <span class="n">A2_lpc</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_choice</span><span class="o">.</span><span class="n">D1_lpc</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_choice</span><span class="o">.</span><span class="n">Dh1_lpc</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">choice_aux</span><span class="o">.</span><span class="n">preProcessFanFile</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_choice</span><span class="o">.</span><span class="n">D1_lpc</span><span class="p">,</span> <span class="n">A2_lpc</span><span class="p">)</span>

            <span class="n">storage_mat</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">loadStorageMat</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Mtip_lpc</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Mu_lpc</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xnl_lpc</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dt_lpc</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_choice</span><span class="o">.</span><span class="n">n_stages_LPC</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">g1_lpc</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># use performanceResults.txt file and additional data to estimate the trajectory variables.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">openRotor</span><span class="p">:</span>
                <span class="n">xnl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;NL&#39;</span><span class="p">)</span>
                <span class="n">xni</span> <span class="o">=</span> <span class="n">xnl</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_choice</span><span class="o">.</span><span class="n">gbx_ratio</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s1">&#39;no open rotor method yet - lpc&#39;</span><span class="p">)</span>

            <span class="n">g1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;W23&#39;</span><span class="p">)</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;T23&#39;</span><span class="p">)</span>
            <span class="n">p1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;P23&#39;</span><span class="p">)</span>
            <span class="n">A</span> <span class="o">=</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_choice</span><span class="o">.</span><span class="n">D1_lpc</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_choice</span><span class="o">.</span><span class="n">Dh1_lpc</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
            <span class="p">[</span><span class="n">Mtip</span><span class="p">,</span> <span class="n">Mu</span><span class="p">,</span> <span class="n">Umid</span><span class="p">]</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">setMachNumbers</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_choice</span><span class="o">.</span><span class="n">D1_lpc</span><span class="p">,</span> <span class="n">xni</span><span class="p">,</span>
                                                         <span class="n">choice_data</span><span class="o">.</span><span class="n">gamma_air</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_choice</span><span class="o">.</span><span class="n">gbx_ratio</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">dt</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.6</span> <span class="o">*</span> <span class="n">Umid</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">cp_air</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_choice</span><span class="o">.</span><span class="n">n_stages_LPC</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dt</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.45</span> <span class="o">*</span> <span class="n">Umid</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">cp_air</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_choice</span><span class="o">.</span><span class="n">n_stages_LPC</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">xnl_lpc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">xni</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dt_lpc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">g1_lpc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">g1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Mtip_lpc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">Mtip</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Mu_lpc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">Mu</span><span class="p">)</span></div>


<div class="viewcode-block" id="PerformanceChoice.setff">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.PerformanceChoice.setff">[docs]</a>
    <span class="k">def</span> <span class="nf">setff</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Sets the fuselage fan performance parameters. &quot;&quot;&quot;</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_fuselagefan_performance.txt&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trajPerf</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">containsStars</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Discovered raw trajectory mission file (fuselagefan) - computing Mtip and Mu from other data &#39;</span>
                      <span class="s1">&#39;and re-writing file (this is done only once)&#39;</span><span class="p">)</span>
                <span class="n">choice_aux</span><span class="o">.</span><span class="n">preProcessFanFile</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_choice</span><span class="o">.</span><span class="n">D1_ff</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_choice</span><span class="o">.</span><span class="n">A2_ff</span><span class="p">)</span>

            <span class="n">storage_mat</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">loadStorageMat</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Mtip_ff</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Mu_ff</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xnl_ff</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dt_ff</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">g1_ff</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># use performanceResults.txt file and additional data to estimate the trajectory variables.</span>
            <span class="n">xnl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;NFF&#39;</span><span class="p">)</span>
            <span class="n">g1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;Wff2&#39;</span><span class="p">)</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;Tff2&#39;</span><span class="p">)</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;Tff3&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="n">t1</span>
            <span class="n">p1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;Pff2&#39;</span><span class="p">)</span>
            <span class="p">[</span><span class="n">Mtip</span><span class="p">,</span> <span class="n">Mu</span><span class="p">,</span> <span class="n">Umid</span><span class="p">]</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">setMachNumbers</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_choice</span><span class="o">.</span><span class="n">A2_ff</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_choice</span><span class="o">.</span><span class="n">D1_ff</span><span class="p">,</span>
                                                         <span class="n">xnl</span><span class="p">,</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">gamma_air</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">xnl_ff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">xnl</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dt_ff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">g1_ff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">g1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Mtip_ff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">Mtip</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Mu_ff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">Mu</span><span class="p">)</span></div>


<div class="viewcode-block" id="PerformanceChoice.coAxialJet_ffn">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.PerformanceChoice.coAxialJet_ffn">[docs]</a>
    <span class="k">def</span> <span class="nf">coAxialJet_ffn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Sets the jet performance parameters for fuselage fan nozzle . &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trajPerf</span><span class="p">:</span>
            <span class="n">storage_mat</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">loadStorageMat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_ffnJet_performance.txt&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dmdt_1_caj_ffn</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dmdt_2_caj_ffn</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v_1_caj_ffn</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v_2_caj_ffn</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T_1_caj_ffn</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T_2_caj_ffn</span> <span class="o">=</span> <span class="n">storage_mat</span><span class="p">[:,</span> <span class="mi">5</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># 2 is cold.</span>
            <span class="n">Wffn8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;Wffn8&#39;</span><span class="p">)</span>
            <span class="n">Wffn18</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;Wffn18&#39;</span><span class="p">)</span>
            <span class="n">Mffn8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;Mffn8&#39;</span><span class="p">)</span>
            <span class="n">Mffn18</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;Mffn18&#39;</span><span class="p">)</span>
            <span class="n">Tffn8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;Tffn8&#39;</span><span class="p">)</span>
            <span class="n">Tffn18</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s1">&#39;Tffn18&#39;</span><span class="p">)</span>

            <span class="n">Cffn18</span> <span class="o">=</span> <span class="n">choice_physics</span><span class="o">.</span><span class="n">getVel</span><span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">gamma_air</span><span class="p">,</span> <span class="n">Tffn18</span><span class="p">,</span> <span class="n">Mffn18</span><span class="p">)</span>
            <span class="n">Cffn8</span> <span class="o">=</span> <span class="n">choice_physics</span><span class="o">.</span><span class="n">getVel</span><span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">gamma_gas</span><span class="p">,</span> <span class="n">Tffn8</span><span class="p">,</span> <span class="n">Mffn8</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">dmdt_1_caj_ffn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">Wffn8</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dmdt_2_caj_ffn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">Wffn18</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v_1_caj_ffn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">Cffn8</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v_2_caj_ffn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">Cffn18</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T_1_caj_ffn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">Tffn8</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T_2_caj_ffn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_traj</span><span class="p">,</span> <span class="n">Tffn18</span><span class="p">)</span></div>


<div class="viewcode-block" id="PerformanceChoice.get_variable">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.PerformanceChoice.get_variable">[docs]</a>
    <span class="k">def</span> <span class="nf">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Returns the value of the item with the specified key for the provided point. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">point</span> <span class="o">==</span> <span class="s1">&#39;Take-off&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpd</span><span class="o">.</span><span class="n">perf_file_to</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">point</span> <span class="o">==</span> <span class="s1">&#39;Sideline&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpd</span><span class="o">.</span><span class="n">perf_file_sl</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">point</span> <span class="o">==</span> <span class="s1">&#39;Cutback&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpd</span><span class="o">.</span><span class="n">perf_file_cutback</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">point</span> <span class="o">==</span> <span class="s1">&#39;Approach&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpd</span><span class="o">.</span><span class="n">perf_file_approach</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">point</span> <span class="o">==</span> <span class="s1">&#39;Cruise&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpd</span><span class="o">.</span><span class="n">perf_file_cr</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">point</span> <span class="o">==</span> <span class="s1">&#39;Top-of-climb&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpd</span><span class="o">.</span><span class="n">perf_file_toc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>


<div class="viewcode-block" id="PerformanceChoice.set">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.PerformanceChoice.set">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">ptr</span><span class="p">,</span> <span class="n">modules</span><span class="p">,</span> <span class="n">n_traj</span><span class="p">,</span> <span class="n">mpd</span><span class="p">,</span> <span class="n">noise_choice</span><span class="p">,</span> <span class="n">weight_choice</span><span class="p">,</span> <span class="n">input_folder</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the performance data for each component.</span>

<span class="sd">        :param int ptr: Operating point (trajectory) number in order of appearance in the inputNoise.txt</span>
<span class="sd">        :param list modules: Engine components</span>
<span class="sd">        :param int n_traj: Number of trajectory points</span>
<span class="sd">        :param MultptPerfData mpd: Multipoint performance data</span>
<span class="sd">        :param NoiseChoice noise_choice: Noise prediction input data</span>
<span class="sd">        :param WeightChoice weight_choice: Engine sizing data</span>
<span class="sd">        :param str input_folder: Input files folder</span>

<span class="sd">        :return PerformanceChoice: A PerformanceChoice object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">performance_choice</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span> <span class="n">noise_choice</span><span class="o">.</span><span class="n">trajectory_performance</span><span class="p">,</span> <span class="n">noise_choice</span><span class="o">.</span><span class="n">opPnt</span><span class="p">[</span><span class="n">ptr</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">n_traj</span><span class="p">,</span>
                                 <span class="n">weight_choice</span><span class="p">,</span> <span class="n">mpd</span><span class="p">,</span> <span class="n">input_folder</span><span class="p">)</span>
        <span class="n">openRotor</span> <span class="o">=</span> <span class="n">performance_choice</span><span class="o">.</span><span class="n">getIsOpenRotor</span><span class="p">(</span><span class="n">modules</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">openRotor</span><span class="p">:</span> <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s1">&#39;Model is open rotor - noise modelling not implemented yet&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">module</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">module</span> <span class="o">==</span> <span class="s1">&#39;Fan&#39;</span><span class="p">:</span> <span class="n">performance_choice</span><span class="o">.</span><span class="n">setFan</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">module</span> <span class="o">==</span> <span class="s1">&#39;Ipc&#39;</span> <span class="ow">or</span> <span class="n">module</span> <span class="o">==</span> <span class="s1">&#39;Lpc&#39;</span><span class="p">:</span> <span class="n">performance_choice</span><span class="o">.</span><span class="n">setLpc</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">module</span> <span class="o">==</span> <span class="s1">&#39;Lpt&#39;</span><span class="p">:</span> <span class="n">performance_choice</span><span class="o">.</span><span class="n">setLpt</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">module</span> <span class="o">==</span> <span class="s1">&#39;Comb&#39;</span><span class="p">:</span> <span class="n">performance_choice</span><span class="o">.</span><span class="n">setComb</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">module</span> <span class="o">==</span> <span class="s1">&#39;Cold_nozzle&#39;</span><span class="p">:</span> <span class="n">performance_choice</span><span class="o">.</span><span class="n">coAxialJet</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">module</span> <span class="o">==</span> <span class="s1">&#39;Fuselage_fan&#39;</span><span class="p">:</span> <span class="n">performance_choice</span><span class="o">.</span><span class="n">setff</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">module</span> <span class="o">==</span> <span class="s1">&#39;Ff_nozzle&#39;</span><span class="p">:</span> <span class="n">performance_choice</span><span class="o">.</span><span class="n">coAxialJet_ffn</span><span class="p">()</span>

        <span class="n">performance_choice</span><span class="o">.</span><span class="n">setAirfrm</span><span class="p">(</span><span class="n">noise_choice</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">performance_choice</span></div>
</div>



<div class="viewcode-block" id="Prms">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.Prms">[docs]</a>
<span class="k">class</span> <span class="nc">Prms</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Instantiate rms acoustic pressure for each aircraft noise component.</span>

<span class="sd">    :param int npts: Number of trajectory points</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">npts</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Initializes the prms matrix for each component. &quot;&quot;&quot;</span>
        <span class="n">nfreq</span> <span class="o">=</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">nfreq</span>
        <span class="n">nthet</span> <span class="o">=</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">nthet</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Fan_inlet_tone</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Fan_discharge_tone</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Fan_inlet_broadband</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Fan_discharge_broadband</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Fan_inlet_combination</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Fan_inlet</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Fan_discharge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Lpc_inlet_tone</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Lpc_discharge_tone</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Lpc_inlet_broadband</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Lpc_discharge_broadband</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Lpc_inlet_combination</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Lpc_inlet</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Lpc_discharge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Comb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Lpt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Caj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Airfrm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Airfrm_wing</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Airfrm_hor_tail</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Airfrm_slats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Airfrm_flaps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Airfrm_nose_lg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Airfrm_main_lg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Airfrm_lg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ff_inlet_tone</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ff_discharge_tone</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ff_inlet_broadband</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ff_discharge_broadband</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ff_inlet_combination</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ff_inlet</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ff_discharge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Caj_ffn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span></div>



<div class="viewcode-block" id="NoiseSources">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.NoiseSources">[docs]</a>
<span class="k">class</span> <span class="nc">NoiseSources</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Instantiate noise source object</span>

<span class="sd">    :param Prms prms: Acoustic pressure arrays for each aircraft noise component</span>
<span class="sd">    :param ndarray theta: 1D array containg directivity angles</span>
<span class="sd">    :param ndarray fband: 1D array containg the 1/3 octave band frequencies</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prms</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">fband</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prms</span> <span class="o">=</span> <span class="n">prms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fband</span> <span class="o">=</span> <span class="n">fband</span>

<div class="viewcode-block" id="NoiseSources.compute">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.NoiseSources.compute">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">compute</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">traj</span><span class="p">,</span> <span class="n">modules</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">performance</span><span class="p">,</span> <span class="n">nop</span><span class="p">,</span> <span class="n">output_folder</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the acoustic pressure for each noise component.</span>

<span class="sd">        :param Trajectory traj: A Trajectory object with the trajectory data</span>
<span class="sd">        :param list modules: Fan, Lpc, Lpt, etc.</span>
<span class="sd">        :param NoiseChoice noise: A NoiseChoice object with the required input arguments for the noise prediction</span>
<span class="sd">        :param WeightChoice weight: A WeightChoice object with the engine size and architecture</span>
<span class="sd">        :param PerformanceChoice performance: A PerformanceChoice object with the engine performance data</span>
<span class="sd">        :param int nop: Number of operating point</span>
<span class="sd">        :param str output_folder: Output folder path</span>
<span class="sd">        :param str ext: File extension for noise source matrices</span>

<span class="sd">        :return NoiseSources: A Prms object with the rms acoustic pressure for each component, the directivity angles</span>
<span class="sd">                             and the 1/3 octave band frequencies</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="mf">5.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">nthet</span><span class="p">)])</span>
        <span class="p">[</span><span class="n">fband</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">freq</span><span class="p">]</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">set_frequencies</span><span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">nb</span><span class="p">,</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">nfreq</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">fmin</span><span class="p">),</span>
                                                      <span class="nb">float</span><span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">fmax</span><span class="p">))</span>
        
        <span class="c1"># flyover plane</span>
        <span class="n">prms</span> <span class="o">=</span> <span class="n">Prms</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">n_traj_pts</span><span class="p">)</span>

        <span class="n">operatingPoint</span> <span class="o">=</span> <span class="n">noise</span><span class="o">.</span><span class="n">opPnt</span><span class="p">[</span><span class="n">nop</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">airframe</span> <span class="o">=</span> <span class="n">choice_physics</span><span class="o">.</span><span class="n">Airframe</span><span class="p">(</span><span class="n">operatingPoint</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">N_wheels_airfrm</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">N_struts_airfrm</span><span class="p">,</span>
                                           <span class="n">noise</span><span class="o">.</span><span class="n">nlg_airfrm</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">d_wheel_airfrm</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">d_strut_airfrm</span><span class="p">,</span>
                                           <span class="n">noise</span><span class="o">.</span><span class="n">d_wire_airfrm</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">NoFlap</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">S_flap_airfrm</span><span class="p">,</span>
                                           <span class="n">noise</span><span class="o">.</span><span class="n">span_flap_airfrm</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">Sw_airfrm</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">span_airfrm</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">ND</span><span class="p">,</span>
                                           <span class="n">noise</span><span class="o">.</span><span class="n">span_hor_tail</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">Sht</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">span_ver_tail</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">Svt</span><span class="p">,</span>
                                           <span class="n">noise</span><span class="o">.</span><span class="n">flap_type</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">slat_type</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">fband</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;Cold_nozzle&#39;</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span> <span class="n">jet</span> <span class="o">=</span> <span class="n">choice_physics</span><span class="o">.</span><span class="n">Jet</span><span class="p">(</span><span class="n">weight</span><span class="o">.</span><span class="n">A_core_caj</span><span class="p">,</span> <span class="n">weight</span><span class="o">.</span><span class="n">A_bypass_caj</span><span class="p">,</span>
                                                              <span class="n">noise</span><span class="o">.</span><span class="n">type_nozzles</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">fband</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;Comb&#39;</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
            <span class="n">comb</span> <span class="o">=</span> <span class="n">choice_physics</span><span class="o">.</span><span class="n">Combustor</span><span class="p">(</span><span class="n">weight</span><span class="o">.</span><span class="n">type_comb</span><span class="p">,</span> <span class="n">weight</span><span class="o">.</span><span class="n">Aec_comb</span><span class="p">,</span> <span class="n">weight</span><span class="o">.</span><span class="n">De_comb</span><span class="p">,</span> <span class="n">weight</span><span class="o">.</span><span class="n">Dh_comb</span><span class="p">,</span>
                                            <span class="n">weight</span><span class="o">.</span><span class="n">Lc_comb</span><span class="p">,</span> <span class="n">weight</span><span class="o">.</span><span class="n">h_comb</span><span class="p">,</span> <span class="n">weight</span><span class="o">.</span><span class="n">Nfmax_comb</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">fband</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;Lpt&#39;</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
            <span class="n">turb</span> <span class="o">=</span> <span class="n">choice_physics</span><span class="o">.</span><span class="n">Turbine</span><span class="p">(</span><span class="n">weight</span><span class="o">.</span><span class="n">N_rotors_lpt</span><span class="p">,</span> <span class="n">weight</span><span class="o">.</span><span class="n">n_stages_lpt</span><span class="p">,</span> <span class="n">weight</span><span class="o">.</span><span class="n">SRS_lpt</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">fband</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;Fan&#39;</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
            <span class="n">fan</span> <span class="o">=</span> <span class="n">choice_physics</span><span class="o">.</span><span class="n">FanCompressor</span><span class="p">(</span><span class="s1">&#39;Fan&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">.</span><span class="n">MtipD_fan</span><span class="p">,</span> <span class="n">weight</span><span class="o">.</span><span class="n">N_rotors_fan</span><span class="p">,</span> <span class="n">weight</span><span class="o">.</span><span class="n">N_stators_fan</span><span class="p">,</span>
                                               <span class="n">weight</span><span class="o">.</span><span class="n">rss_fan</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">fband</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">fan_distortion</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;Ipc&#39;</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
            <span class="n">lpc</span> <span class="o">=</span> <span class="n">choice_physics</span><span class="o">.</span><span class="n">FanCompressor</span><span class="p">(</span><span class="s1">&#39;Ipc&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">.</span><span class="n">MtipD_lpc</span><span class="p">,</span> <span class="n">weight</span><span class="o">.</span><span class="n">N_rotors_lpc</span><span class="p">,</span> <span class="n">weight</span><span class="o">.</span><span class="n">N_stators_lpc</span><span class="p">,</span>
                                               <span class="n">weight</span><span class="o">.</span><span class="n">rss_lpc</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">fband</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;Lpc&#39;</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
            <span class="n">lpc</span> <span class="o">=</span> <span class="n">choice_physics</span><span class="o">.</span><span class="n">FanCompressor</span><span class="p">(</span><span class="s1">&#39;Lpc&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">.</span><span class="n">MtipD_lpc</span><span class="p">,</span> <span class="n">weight</span><span class="o">.</span><span class="n">N_rotors_lpc</span><span class="p">,</span> <span class="n">weight</span><span class="o">.</span><span class="n">N_stators_lpc</span><span class="p">,</span>
                                               <span class="n">weight</span><span class="o">.</span><span class="n">rss_lpc</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">fband</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;Fuselage_fan&#39;</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
            <span class="n">ffan</span> <span class="o">=</span> <span class="n">choice_physics</span><span class="o">.</span><span class="n">FanCompressor</span><span class="p">(</span><span class="s1">&#39;Fuselage_fan&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">.</span><span class="n">MtipD_ff</span><span class="p">,</span> <span class="n">weight</span><span class="o">.</span><span class="n">N_rotors_ff</span><span class="p">,</span>
                                                <span class="n">weight</span><span class="o">.</span><span class="n">N_stators_ff</span><span class="p">,</span> <span class="n">weight</span><span class="o">.</span><span class="n">rss_ff</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">fband</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span>
                                                <span class="n">noise</span><span class="o">.</span><span class="n">ff_distortion</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;Ff_nozzle&#39;</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span> <span class="n">ffjet</span> <span class="o">=</span> <span class="n">choice_physics</span><span class="o">.</span><span class="n">Jet</span><span class="p">(</span><span class="n">weight</span><span class="o">.</span><span class="n">A_core_caj_ffn</span><span class="p">,</span> <span class="n">weight</span><span class="o">.</span><span class="n">A_bypass_caj_ffn</span><span class="p">,</span> <span class="s1">&#39;mix&#39;</span><span class="p">)</span>

        <span class="c1"># evaluate component noise models</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">n_traj_pts</span><span class="p">):</span>  <span class="c1"># for all points along trajectory - evaluate noise sources</span>
            <span class="n">pa</span> <span class="o">=</span> <span class="n">choice_physics</span><span class="o">.</span><span class="n">AtmosphericEffects</span><span class="o">.</span><span class="n">get_p_ambient</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">module</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>  <span class="c1"># evaluate all noise sources in this engine model</span>
                <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Fan&#39;</span><span class="p">:</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">calc</span><span class="p">(</span><span class="n">operatingPoint</span><span class="p">,</span> <span class="n">performance</span><span class="o">.</span><span class="n">Mtip_fan</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">performance</span><span class="o">.</span><span class="n">Mu_fan</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                    <span class="n">performance</span><span class="o">.</span><span class="n">dt_fan</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">performance</span><span class="o">.</span><span class="n">xnl_fan</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">performance</span><span class="o">.</span><span class="n">g1_fan</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

                    <span class="k">if</span> <span class="n">noise</span><span class="o">.</span><span class="n">use_suppression_factor</span><span class="p">:</span>
                        <span class="n">prms</span><span class="o">.</span><span class="n">Fan_inlet</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">suppression</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">noise</span><span class="o">.</span><span class="n">S_fan_inlet</span><span class="p">)</span>
                        <span class="n">prms</span><span class="o">.</span><span class="n">Fan_discharge</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">suppression</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">noise</span><span class="o">.</span><span class="n">S_fan_dis</span><span class="p">)</span>
                        <span class="n">prms</span><span class="o">.</span><span class="n">Fan_inlet_tone</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">suppression</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">noise</span><span class="o">.</span><span class="n">S_fan_inlet</span><span class="p">)</span>
                        <span class="n">prms</span><span class="o">.</span><span class="n">Fan_discharge_tone</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">suppression</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">noise</span><span class="o">.</span><span class="n">S_fan_dis</span><span class="p">)</span>
                        <span class="n">prms</span><span class="o">.</span><span class="n">Fan_inlet_broadband</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">suppression</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">noise</span><span class="o">.</span><span class="n">S_fan_inlet</span><span class="p">)</span>
                        <span class="n">prms</span><span class="o">.</span><span class="n">Fan_discharge_broadband</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">suppression</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">noise</span><span class="o">.</span><span class="n">S_fan_dis</span><span class="p">)</span>
                        <span class="n">prms</span><span class="o">.</span><span class="n">Fan_inlet_combination</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">suppression</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">noise</span><span class="o">.</span><span class="n">S_fan_inlet</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">prms</span><span class="o">.</span><span class="n">Fan_inlet</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
                        <span class="n">prms</span><span class="o">.</span><span class="n">Fan_discharge</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
                        <span class="n">prms</span><span class="o">.</span><span class="n">Fan_inlet_tone</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">prms</span><span class="o">.</span><span class="n">Fan_discharge_tone</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">prms</span><span class="o">.</span><span class="n">Fan_inlet_broadband</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                        <span class="n">prms</span><span class="o">.</span><span class="n">Fan_discharge_broadband</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                        <span class="n">prms</span><span class="o">.</span><span class="n">Fan_inlet_combination</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">module</span> <span class="o">==</span> <span class="s1">&#39;Ipc&#39;</span> <span class="ow">or</span> <span class="n">module</span> <span class="o">==</span> <span class="s1">&#39;Lpc&#39;</span><span class="p">:</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="n">lpc</span><span class="o">.</span><span class="n">calc</span><span class="p">(</span><span class="n">operatingPoint</span><span class="p">,</span> <span class="n">performance</span><span class="o">.</span><span class="n">Mtip_lpc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">performance</span><span class="o">.</span><span class="n">Mu_lpc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                    <span class="n">performance</span><span class="o">.</span><span class="n">dt_lpc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">performance</span><span class="o">.</span><span class="n">xnl_lpc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">performance</span><span class="o">.</span><span class="n">g1_lpc</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="n">prms</span><span class="o">.</span><span class="n">Lpc_inlet_tone</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">prms</span><span class="o">.</span><span class="n">Lpc_inlet_broadband</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                    <span class="n">prms</span><span class="o">.</span><span class="n">Lpc_inlet_combination</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
                    <span class="n">prms</span><span class="o">.</span><span class="n">Lpc_inlet</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">module</span> <span class="o">==</span> <span class="s1">&#39;Lpt&#39;</span><span class="p">:</span>
                    <span class="n">prms</span><span class="o">.</span><span class="n">Lpt</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">turb</span><span class="o">.</span><span class="n">calc</span><span class="p">(</span><span class="n">performance</span><span class="o">.</span><span class="n">Vtr_lpt</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">performance</span><span class="o">.</span><span class="n">Texit_lpt</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                                  <span class="n">performance</span><span class="o">.</span><span class="n">xnl_lpt</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">performance</span><span class="o">.</span><span class="n">mcore_lpt</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                                  <span class="n">performance</span><span class="o">.</span><span class="n">Cax_lpt</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

                    <span class="k">if</span> <span class="n">noise</span><span class="o">.</span><span class="n">use_suppression_factor</span><span class="p">:</span>
                        <span class="n">prms</span><span class="o">.</span><span class="n">Lpt</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">turb</span><span class="o">.</span><span class="n">suppression</span><span class="p">(</span><span class="n">prms</span><span class="o">.</span><span class="n">Lpt</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">noise</span><span class="o">.</span><span class="n">S_lpt</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">module</span> <span class="o">==</span> <span class="s1">&#39;Comb&#39;</span><span class="p">:</span>
                    <span class="n">prms</span><span class="o">.</span><span class="n">Comb</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">comb</span><span class="o">.</span><span class="n">calc</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">noise</span><span class="o">.</span><span class="n">Nf_comb_ign</span><span class="p">[</span><span class="n">nop</span><span class="p">],</span> <span class="n">weight</span><span class="o">.</span><span class="n">Nfmax_comb</span><span class="p">),</span>
                                                   <span class="n">noise</span><span class="o">.</span><span class="n">Nf_comb_pattern</span><span class="p">,</span> <span class="n">pa</span><span class="p">,</span> <span class="n">performance</span><span class="o">.</span><span class="n">P3_comb</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                                   <span class="n">performance</span><span class="o">.</span><span class="n">P4_comb</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">performance</span><span class="o">.</span><span class="n">P7_comb</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">traj</span><span class="o">.</span><span class="n">ta</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                                   <span class="n">performance</span><span class="o">.</span><span class="n">T3_comb</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">performance</span><span class="o">.</span><span class="n">T4_comb</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                                   <span class="n">performance</span><span class="o">.</span><span class="n">T5_comb</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">performance</span><span class="o">.</span><span class="n">W3_comb</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">elif</span> <span class="n">module</span> <span class="o">==</span> <span class="s1">&#39;Cold_nozzle&#39;</span><span class="p">:</span>
                    <span class="n">prms</span><span class="o">.</span><span class="n">Caj</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">jet</span><span class="o">.</span><span class="n">calc</span><span class="p">(</span><span class="n">performance</span><span class="o">.</span><span class="n">dmdt_1_caj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">performance</span><span class="o">.</span><span class="n">dmdt_2_caj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                                 <span class="n">performance</span><span class="o">.</span><span class="n">v_1_caj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">performance</span><span class="o">.</span><span class="n">v_2_caj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">performance</span><span class="o">.</span><span class="n">T_1_caj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                                 <span class="n">performance</span><span class="o">.</span><span class="n">T_2_caj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">traj</span><span class="o">.</span><span class="n">ta</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">pa</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">module</span> <span class="o">==</span> <span class="s1">&#39;Fuselage_fan&#39;</span><span class="p">:</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="n">ffan</span><span class="o">.</span><span class="n">calc</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">operatingPoint</span><span class="p">,</span> <span class="n">performance</span><span class="o">.</span><span class="n">Mtip_ff</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">performance</span><span class="o">.</span><span class="n">Mu_ff</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                     <span class="n">performance</span><span class="o">.</span><span class="n">dt_ff</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">performance</span><span class="o">.</span><span class="n">xnl_ff</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">performance</span><span class="o">.</span><span class="n">g1_ff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="n">prms</span><span class="o">.</span><span class="n">Ff_inlet_tone</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">prms</span><span class="o">.</span><span class="n">Ff_discharge_tone</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">prms</span><span class="o">.</span><span class="n">Ff_inlet_broadband</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                    <span class="n">prms</span><span class="o">.</span><span class="n">Ff_discharge_broadband</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                    <span class="n">prms</span><span class="o">.</span><span class="n">Ff_inlet_combination</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
                    <span class="n">prms</span><span class="o">.</span><span class="n">Ff_inlet</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
                    <span class="n">prms</span><span class="o">.</span><span class="n">Ff_discharge</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">module</span> <span class="o">==</span> <span class="s1">&#39;ff_nozzle&#39;</span><span class="p">:</span>
                    <span class="n">prms</span><span class="o">.</span><span class="n">Caj_ffn</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ffjet</span><span class="o">.</span><span class="n">calc</span><span class="p">(</span><span class="n">performance</span><span class="o">.</span><span class="n">dmdt_1_caj_ffn</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">performance</span><span class="o">.</span><span class="n">v_1_caj_ffn</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                                       <span class="mf">0.0</span><span class="p">,</span> <span class="n">performance</span><span class="o">.</span><span class="n">T_1_caj_ffn</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">ta</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">pa</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s1">&#39;phi&#39;</span><span class="p">):</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">airframe</span><span class="o">.</span><span class="n">calc</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">ta</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">traj</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">traj</span><span class="o">.</span><span class="n">Ma</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">traj</span><span class="o">.</span><span class="n">Va</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">traj</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                     <span class="n">performance</span><span class="o">.</span><span class="n">defl_flap_airfrm</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">performance</span><span class="o">.</span><span class="n">defl_slat_airfrm</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                     <span class="n">performance</span><span class="o">.</span><span class="n">LandingGear</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">airframe</span><span class="o">.</span><span class="n">calc</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">ta</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">traj</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">traj</span><span class="o">.</span><span class="n">Ma</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">traj</span><span class="o">.</span><span class="n">Va</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">performance</span><span class="o">.</span><span class="n">defl_flap_airfrm</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                     <span class="n">performance</span><span class="o">.</span><span class="n">defl_slat_airfrm</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">performance</span><span class="o">.</span><span class="n">LandingGear</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">prms</span><span class="o">.</span><span class="n">Airfrm</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">prms</span><span class="o">.</span><span class="n">Airfrm_wing</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">prms</span><span class="o">.</span><span class="n">Airfrm_hor_tail</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">prms</span><span class="o">.</span><span class="n">Airfrm_slats</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">prms</span><span class="o">.</span><span class="n">Airfrm_flaps</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
            <span class="n">prms</span><span class="o">.</span><span class="n">Airfrm_nose_lg</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
            <span class="n">prms</span><span class="o">.</span><span class="n">Airfrm_main_lg</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
            <span class="n">prms</span><span class="o">.</span><span class="n">Airfrm_lg</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>

        <span class="c1"># include multiple engines</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">prms</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;Airfrm&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="n">prms</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">include_multiple_engines</span><span class="p">(</span><span class="n">noise</span><span class="o">.</span><span class="n">no_engines</span><span class="p">,</span> <span class="n">prms</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">noise</span><span class="o">.</span><span class="n">gen_noise_source_matr</span><span class="p">:</span>
            <span class="n">choice_aux</span><span class="o">.</span><span class="n">gen_noise_source_matr_subr</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="n">operatingPoint</span><span class="p">,</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">nthet</span><span class="p">,</span>
                                                  <span class="n">traj</span><span class="o">.</span><span class="n">n_traj_pts</span><span class="p">,</span> <span class="n">prms</span><span class="p">,</span> <span class="n">ext</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">noise</span><span class="o">.</span><span class="n">plot_source_spectra</span><span class="p">:</span>
            <span class="n">i_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">xsid</span> <span class="o">-</span> <span class="n">noise</span><span class="o">.</span><span class="n">directivity_plot</span><span class="p">))</span>
            <span class="n">choice_aux</span><span class="o">.</span><span class="n">plot_source</span><span class="p">(</span><span class="n">fband</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">prms</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">directivity_plot</span><span class="p">,</span> <span class="n">i_plot</span><span class="p">,</span> <span class="n">modules</span><span class="p">)</span>
            <span class="n">choice_aux</span><span class="o">.</span><span class="n">plot_airframe_source</span><span class="p">(</span><span class="n">fband</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">prms</span><span class="o">.</span><span class="n">Airfrm</span><span class="p">,</span> <span class="n">prms</span><span class="o">.</span><span class="n">Airfrm_wing</span><span class="p">,</span> <span class="n">prms</span><span class="o">.</span><span class="n">Airfrm_hor_tail</span><span class="p">,</span>
                                            <span class="n">prms</span><span class="o">.</span><span class="n">Airfrm_flaps</span><span class="p">,</span> <span class="n">prms</span><span class="o">.</span><span class="n">Airfrm_slats</span><span class="p">,</span> <span class="n">prms</span><span class="o">.</span><span class="n">Airfrm_main_lg</span><span class="p">,</span> <span class="n">prms</span><span class="o">.</span><span class="n">Airfrm_lg</span><span class="p">,</span>
                                            <span class="n">prms</span><span class="o">.</span><span class="n">Airfrm_nose_lg</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">directivity_plot</span><span class="p">,</span> <span class="n">i_plot</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">prms</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">fband</span><span class="p">)</span></div>


<div class="viewcode-block" id="NoiseSources.include_multiple_engines">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.NoiseSources.include_multiple_engines">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">include_multiple_engines</span><span class="p">(</span><span class="n">no_engines</span><span class="p">,</span> <span class="n">prms</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Account for multiple engines on the aircraft. &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">no_engines</span><span class="p">)</span> <span class="o">*</span> <span class="n">prms</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="NoiseMatrices">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.NoiseMatrices">[docs]</a>
<span class="k">class</span> <span class="nc">NoiseMatrices</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class that defines the noise level for each aircraft noise component.</span>

<span class="sd">    :param list modules: Fan, Lpc, Lpt, etc.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">modules</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Initializes the noise level matrix for each component. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">modules</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;Fan&#39;</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Fan_inlet</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Fan_discharge</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Fan_inlet_tone</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Fan_discharge_tone</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Fan_inlet_broadband</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Fan_discharge_broadband</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Fan_inlet_combination</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="s1">&#39;Ipc&#39;</span> <span class="ow">or</span> <span class="s1">&#39;Lpc&#39;</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Lpc_inlet</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Lpc_inlet_tone</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Lpc_inlet_broadband</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Lpc_inlet_combination</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="s1">&#39;Lpt&#39;</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lpt</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="s1">&#39;Comb&#39;</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">Comb</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="s1">&#39;Cold_nozzle&#39;</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">Caj</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="s1">&#39;Fuselage_fan&#39;</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ff_inlet</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ff_discharge</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="s1">&#39;Ff_nozzle&#39;</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Caj_ffn</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Airfrm</span> <span class="o">=</span> <span class="p">[]</span></div>



<div class="viewcode-block" id="interpolate_to_t_source">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.interpolate_to_t_source">[docs]</a>
<span class="k">def</span> <span class="nf">interpolate_to_t_source</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">modules</span><span class="p">,</span> <span class="n">prms</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the Sound Pressure Level for the times that the sound reaches the microphone.</span>

<span class="sd">    :param Trajectory traj: A Trajectory object with the trajectory data</span>
<span class="sd">    :param list modules: Fan, Lpc, Lpt, etc.</span>
<span class="sd">    :param Prms prms: A Prms object with the rms acoustic pressure for each component</span>

<span class="sd">    :return: For the times that the sound reaches the microphone, a NoiseMatrices object with the Sound Pressure Level</span>
<span class="sd">            for each component, the observation angle, the Mach number and the angle of attack</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">traj</span><span class="o">.</span><span class="n">xsii</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">xsi</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">)(</span><span class="n">traj</span><span class="o">.</span><span class="n">t_source</span><span class="p">)</span>
    <span class="n">traj</span><span class="o">.</span><span class="n">Mai</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">Ma</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">)(</span><span class="n">traj</span><span class="o">.</span><span class="n">t_source</span><span class="p">)</span>
    <span class="n">traj</span><span class="o">.</span><span class="n">Tai</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">ta</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">)(</span><span class="n">traj</span><span class="o">.</span><span class="n">t_source</span><span class="p">)</span>
    <span class="n">traj</span><span class="o">.</span><span class="n">xsi_alphai</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">xsi_alpha</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">)(</span><span class="n">traj</span><span class="o">.</span><span class="n">t_source</span><span class="p">)</span>
    <span class="n">traj</span><span class="o">.</span><span class="n">alphai</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">)(</span><span class="n">traj</span><span class="o">.</span><span class="n">t_source</span><span class="p">)</span>
    <span class="n">traj</span><span class="o">.</span><span class="n">pai</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">pa</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">)(</span><span class="n">traj</span><span class="o">.</span><span class="n">t_source</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s1">&#39;phi&#39;</span><span class="p">):</span>
        <span class="n">traj</span><span class="o">.</span><span class="n">phii</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">phi</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">)(</span><span class="n">traj</span><span class="o">.</span><span class="n">t_source</span><span class="p">)</span>

    <span class="n">SPLi</span> <span class="o">=</span> <span class="n">NoiseMatrices</span><span class="p">(</span><span class="n">modules</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">SPLi</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
        <span class="n">SPLi</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">compute_SPLi</span><span class="p">(</span><span class="n">source_interpolation</span><span class="p">(</span><span class="n">prms</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">traj</span><span class="p">))</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">SPLi</span><span class="p">,</span> <span class="n">traj</span><span class="p">]</span></div>



<div class="viewcode-block" id="compute_SPLi">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.compute_SPLi">[docs]</a>
<span class="k">def</span> <span class="nf">compute_SPLi</span><span class="p">(</span><span class="n">prmsi</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Computes Sound Pressure Level matrix from rms acoustic pressure. &quot;&quot;&quot;</span>
    <span class="n">prmsi</span><span class="p">[</span><span class="n">prmsi</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">p0</span>
    <span class="k">return</span> <span class="mf">20.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">prmsi</span> <span class="o">/</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">p0</span><span class="p">)</span></div>



<div class="viewcode-block" id="source_interpolation">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.source_interpolation">[docs]</a>
<span class="k">def</span> <span class="nf">source_interpolation</span><span class="p">(</span><span class="n">prms</span><span class="p">,</span> <span class="n">traj</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Interpolate the rms acoustic pressure for the times that reach the microphone. &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">interp1d</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">prms</span><span class="p">[</span><span class="n">ifr</span><span class="p">,</span> <span class="n">jth</span><span class="p">,</span> <span class="p">:],</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">)(</span><span class="n">traj</span><span class="o">.</span><span class="n">t_source</span><span class="p">)</span> <span class="k">for</span> <span class="n">jth</span> <span class="ow">in</span>
                      <span class="nb">range</span><span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">nthet</span><span class="p">)]</span> <span class="k">for</span> <span class="n">ifr</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)])</span></div>



<span class="k">class</span> <span class="nc">GroundNoise</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">SPLp</span><span class="p">,</span> <span class="n">fobs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SPLp</span> <span class="o">=</span> <span class="n">SPLp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fobs</span> <span class="o">=</span> <span class="n">fobs</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">compute_flight_effects</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">use_ground_refl</span><span class="p">,</span> <span class="n">spherical_spr</span><span class="p">,</span> <span class="n">atm_atten</span><span class="p">,</span> <span class="n">traj</span><span class="p">,</span> <span class="n">ymic</span><span class="p">,</span> <span class="n">dTisa</span><span class="p">,</span> <span class="n">elevation</span><span class="p">,</span> <span class="n">SPLi</span><span class="p">,</span>
                               <span class="n">theta</span><span class="p">,</span> <span class="n">fband</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the sound pressure level matrices along the trajectory accounting for propagation effects.</span>

<span class="sd">        :param bool use_ground_refl: True to account for ground reflection or False else</span>
<span class="sd">        :param bool spherical_spr: True to account for spherical spreading or False else</span>
<span class="sd">        :param bool atm_atten: True to account for atmospheric attenuation or False else</span>
<span class="sd">        :param Trajectory traj: A Trajectory object with the trajectory data</span>
<span class="sd">        :param float ymic: Microphone height (m)</span>
<span class="sd">        :param float dTisa: Deviation from ISA temperature (K)</span>
<span class="sd">        :param float elevation: Ground elevation at microphone location (m)</span>
<span class="sd">        :param ndarray SPLi: 3D array containing Sound Pressure Level</span>
<span class="sd">        :param ndarray theta: 1D array containing directivity angles (deg)</span>
<span class="sd">        :param ndarray fband: 1D array containing 1/3 octave band frequencies (Hz)</span>

<span class="sd">        :return GroundNoise: Sound Pressure Level accounting for flight effects and shifted frequency due to aircraft</span>
<span class="sd">                            motion</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">propagation</span> <span class="o">=</span> <span class="n">choice_physics</span><span class="o">.</span><span class="n">PropagationEffects</span><span class="p">(</span><span class="n">ymic</span><span class="p">,</span> <span class="n">use_ground_refl</span><span class="p">,</span> <span class="n">spherical_spr</span><span class="p">,</span> <span class="n">atm_atten</span><span class="p">,</span> <span class="n">fband</span><span class="p">,</span>
                                                        <span class="n">traj</span><span class="o">.</span><span class="n">xsii</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">Mai</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">xsi_alphai</span><span class="p">,</span> <span class="n">dTisa</span><span class="p">,</span> <span class="n">elevation</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s1">&#39;phii&#39;</span><span class="p">):</span>
            <span class="n">phi</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">phii</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">SPLp</span> <span class="o">=</span> <span class="n">NoiseMatrices</span><span class="p">()</span>
        <span class="n">prmsp</span> <span class="o">=</span> <span class="n">NoiseMatrices</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">SPLi</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
            <span class="p">[</span><span class="n">SPLp</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">prmsp</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]]</span> <span class="o">=</span> \
                <span class="n">propagation</span><span class="o">.</span><span class="n">flightEffects</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">n_times</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">x_source</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">y_source</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">r1</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">Tai</span><span class="p">,</span>
                                          <span class="n">SPLi</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">key</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">SPLp</span><span class="p">,</span> <span class="n">propagation</span><span class="o">.</span><span class="n">fobs</span><span class="p">)</span>


<div class="viewcode-block" id="NoiseMatricesCerification">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.NoiseMatricesCerification">[docs]</a>
<span class="k">class</span> <span class="nc">NoiseMatricesCerification</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class that defines the noise level for each aircraft noise component.</span>

<span class="sd">    :param list modules: Fan, Lpc, Lpt, etc.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">modules</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Initializes the noise level matrix for each component. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">modules</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;Fan&#39;</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Fan_inlet</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Fan_discharge</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="s1">&#39;Ipc&#39;</span> <span class="ow">or</span> <span class="s1">&#39;Lpc&#39;</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lpc_inlet</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="s1">&#39;Lpt&#39;</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lpt</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="s1">&#39;Comb&#39;</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">Comb</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="s1">&#39;Cold_nozzle&#39;</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">Caj</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="s1">&#39;Fuselage_fan&#39;</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ff_inlet</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ff_discharge</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="s1">&#39;Ff_nozzle&#39;</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Caj_ffn</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Airfrm</span> <span class="o">=</span> <span class="p">[]</span></div>



<span class="k">class</span> <span class="nc">CertificationData</span><span class="p">:</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">compute</span><span class="p">(</span><span class="n">n_times</span><span class="p">,</span> <span class="n">fobs</span><span class="p">,</span> <span class="n">fband</span><span class="p">,</span> <span class="n">SPLp</span><span class="p">,</span> <span class="n">modules</span><span class="p">,</span> <span class="n">dt_mic</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the Effective Perceived Noise Level (EPNL) for each aircraft noise source and for the total</span>
<span class="sd">        aircraft.</span>

<span class="sd">        :param int n_times: Number of points</span>
<span class="sd">        :param ndarray fobs: 1D array containing Doppler shifted frequency (Hz)</span>
<span class="sd">        :param ndarray fband: 1D array containing 1/3 octave band frequencies (Hz)</span>
<span class="sd">        :param NoiseSources SPLp: Sound Pressure Level (dB)</span>
<span class="sd">        :param list modules: Fan, Lpc, Lpt, etc.</span>
<span class="sd">        :param float dt_mic: Sampling time interval or timestep at microphone (sec)</span>

<span class="sd">        :return NoiseSources: EPNL for each aircraft noise source and for the total aircraft</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">PNL</span> <span class="o">=</span> <span class="n">NoiseMatricesCerification</span><span class="p">(</span><span class="n">modules</span><span class="p">)</span>
        <span class="n">PNLT</span> <span class="o">=</span> <span class="n">NoiseMatricesCerification</span><span class="p">(</span><span class="n">modules</span><span class="p">)</span>
        <span class="n">EPNL</span> <span class="o">=</span> <span class="n">NoiseMatricesCerification</span><span class="p">(</span><span class="n">modules</span><span class="p">)</span>
        <span class="n">SPLp_total</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">SPLp</span><span class="o">.</span><span class="n">Airfrm</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">PNL</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
            <span class="n">PNL</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">choice_physics</span><span class="o">.</span><span class="n">PerceivedNoiseMetrics</span><span class="o">.</span><span class="n">getPNL</span><span class="p">(</span><span class="n">n_times</span><span class="p">,</span> <span class="n">fobs</span><span class="p">,</span> <span class="n">SPLp</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="n">PNLT</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">choice_physics</span><span class="o">.</span><span class="n">PerceivedNoiseMetrics</span><span class="o">.</span><span class="n">getPNLT</span><span class="p">(</span><span class="n">n_times</span><span class="p">,</span> <span class="n">fband</span><span class="p">,</span> <span class="n">PNL</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
                                                                              <span class="n">SPLp</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="n">EPNL</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">choice_physics</span><span class="o">.</span><span class="n">PerceivedNoiseMetrics</span><span class="o">.</span><span class="n">getEPNL</span><span class="p">(</span><span class="n">PNLT</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">dt_mic</span><span class="p">)</span>
            <span class="n">SPLp_total</span> <span class="o">+=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">SPLp</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">SPLp_total</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">SPLp_total</span><span class="p">)</span>

        <span class="n">PNL</span><span class="o">.</span><span class="n">tot</span> <span class="o">=</span> <span class="n">choice_physics</span><span class="o">.</span><span class="n">PerceivedNoiseMetrics</span><span class="o">.</span><span class="n">getPNL</span><span class="p">(</span><span class="n">n_times</span><span class="p">,</span> <span class="n">fobs</span><span class="p">,</span> <span class="n">SPLp_total</span><span class="p">)</span>
        <span class="n">PNLT</span><span class="o">.</span><span class="n">tot</span> <span class="o">=</span> <span class="n">choice_physics</span><span class="o">.</span><span class="n">PerceivedNoiseMetrics</span><span class="o">.</span><span class="n">getPNLT</span><span class="p">(</span><span class="n">n_times</span><span class="p">,</span> <span class="n">fband</span><span class="p">,</span> <span class="n">PNL</span><span class="o">.</span><span class="n">tot</span><span class="p">,</span> <span class="n">SPLp_total</span><span class="p">)</span>
        <span class="n">EPNL</span><span class="o">.</span><span class="n">tot</span> <span class="o">=</span> <span class="n">choice_physics</span><span class="o">.</span><span class="n">PerceivedNoiseMetrics</span><span class="o">.</span><span class="n">getEPNL</span><span class="p">(</span><span class="n">PNLT</span><span class="o">.</span><span class="n">tot</span><span class="p">,</span> <span class="n">dt_mic</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">EPNL</span>


<div class="viewcode-block" id="certificationLimits">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_interf.certificationLimits">[docs]</a>
<span class="k">def</span> <span class="nf">certificationLimits</span><span class="p">(</span><span class="n">noEngines</span><span class="p">,</span> <span class="n">MTOW</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Computes EPNL certification limits. &quot;&quot;&quot;</span>

    <span class="n">EPNL</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">chapter3</span><span class="p">(</span><span class="n">noEngines</span><span class="p">,</span> <span class="n">MTOW</span><span class="p">)</span>

    <span class="n">EPNL_cum</span> <span class="o">=</span> <span class="n">EPNL</span><span class="o">.</span><span class="n">lateral</span> <span class="o">+</span> <span class="n">EPNL</span><span class="o">.</span><span class="n">cutback</span> <span class="o">+</span> <span class="n">EPNL</span><span class="o">.</span><span class="n">approach</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Evangelia Maria Thoma, Xin Zhao, Tomas Grönstedt.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>