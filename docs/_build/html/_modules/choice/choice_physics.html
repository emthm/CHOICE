<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>choice.choice_physics &mdash; CHOICE  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            CHOICE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../source/api/choice.html">CHOICE</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">CHOICE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">choice.choice_physics</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for choice.choice_physics</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: cp1252 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Module choice_physics</span>

<span class="sd">Physics and methods for the noise prediction broken down in modules.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">cmath</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">interpolate</span><span class="p">,</span> <span class="n">special</span>
<span class="kn">import</span> <span class="nn">choice.choice_data</span> <span class="k">as</span> <span class="nn">choice_data</span>
<span class="kn">import</span> <span class="nn">choice.choice_aux</span> <span class="k">as</span> <span class="nn">choice_aux</span>


<span class="k">class</span> <span class="nc">AtmosphericEffects</span><span class="p">:</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_t_ambient</span><span class="p">(</span><span class="n">alt</span><span class="p">,</span> <span class="n">dTisa</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the ambient temperature at a given altitude.</span>

<span class="sd">        :param ndarray alt: Altitude (m)</span>
<span class="sd">        :param ndarray dTisa: Deviation from ISA temperature</span>

<span class="sd">        :return ndarray: Ambient temperature at given altitude</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">alt</span><span class="p">)</span>
        <span class="n">alt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">alt</span><span class="p">)</span>
        <span class="n">temp</span><span class="p">[</span><span class="n">alt</span> <span class="o">&lt;</span> <span class="mf">11000.0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">288.15</span> <span class="o">-</span> <span class="mf">6.5e-3</span> <span class="o">*</span> <span class="n">alt</span><span class="p">[</span><span class="n">alt</span> <span class="o">&lt;</span> <span class="mf">11000.0</span><span class="p">]</span> <span class="o">+</span> <span class="n">dTisa</span>
        <span class="n">temp</span><span class="p">[(</span><span class="mf">11000.0</span> <span class="o">&lt;=</span> <span class="n">alt</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mf">25000.0</span> <span class="o">&gt;</span> <span class="n">alt</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">216.65</span> <span class="o">+</span> <span class="n">dTisa</span>

        <span class="k">return</span> <span class="n">temp</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_p_ambient</span><span class="p">(</span><span class="n">alt</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the ambient pressure at a given altitude.</span>

<span class="sd">        :param ndarray alt: Altitude (m)</span>

<span class="sd">        :return ndarray: Ambient pressure at given altitude</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">alt</span><span class="p">)</span>
        <span class="n">alt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">alt</span><span class="p">)</span>
        <span class="n">pa</span><span class="p">[</span><span class="n">alt</span> <span class="o">&lt;</span> <span class="mf">11000.0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">101325.0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">2.2557E-5</span> <span class="o">*</span> <span class="n">alt</span><span class="p">[</span><span class="n">alt</span> <span class="o">&lt;</span> <span class="mf">11000.0</span><span class="p">])</span> <span class="o">**</span> <span class="mf">5.2561</span>
        <span class="n">pa</span><span class="p">[(</span><span class="mf">11000.0</span> <span class="o">&lt;=</span> <span class="n">alt</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mf">25000.0</span> <span class="o">&gt;</span> <span class="n">alt</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">22632.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
            <span class="mf">1.5769e-4</span> <span class="o">*</span> <span class="p">(</span><span class="n">alt</span><span class="p">[(</span><span class="mf">11000.0</span> <span class="o">&lt;=</span> <span class="n">alt</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mf">25000.0</span> <span class="o">&gt;</span> <span class="n">alt</span><span class="p">)]</span> <span class="o">-</span> <span class="mf">11000.0</span><span class="p">))</span>
        <span class="n">pa</span><span class="p">[</span><span class="n">alt</span> <span class="o">&gt;=</span> <span class="mf">25000.0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">22632.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">1.5769e-4</span> <span class="o">*</span> <span class="p">(</span><span class="n">alt</span><span class="p">[</span><span class="n">alt</span> <span class="o">&gt;=</span> <span class="mf">25000.0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">11000.0</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">pa</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">getVel</span><span class="p">(</span><span class="n">gam</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">M</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes speed from temperature and Mach number.</span>

<span class="sd">        :param float gam: Specific hear ratio</span>
<span class="sd">        :param float T: Temperature (K)</span>
<span class="sd">        :param float M: Mach number</span>

<span class="sd">        return float: Speed (m/s)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ts</span> <span class="o">=</span> <span class="n">T</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="p">((</span><span class="n">gam</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">M</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">gam</span> <span class="o">*</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">Risa</span> <span class="o">*</span> <span class="n">ts</span><span class="p">)</span> <span class="o">*</span> <span class="n">M</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_sound_speed</span><span class="p">(</span><span class="n">temp</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes speed of sound for the given temperature.</span>

<span class="sd">        :param ndarray temp: Ambient temperature (K)</span>
<span class="sd">        </span>
<span class="sd">        :return ndarray: Sound speed (m/s)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="mf">331.4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">temp</span> <span class="o">/</span> <span class="mf">273.15</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">c</span>


<span class="k">class</span> <span class="nc">NoiseSource</span><span class="p">:</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">suppression</span><span class="p">(</span><span class="n">prms</span><span class="p">,</span> <span class="n">s_db</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Calculates the suppressed acoustic pressure. &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">prms</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">s_db</span> <span class="o">/</span> <span class="mi">10</span><span class="p">))</span>


<div class="viewcode-block" id="Airframe">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.Airframe">[docs]</a>
<span class="k">class</span> <span class="nc">Airframe</span><span class="p">(</span><span class="n">NoiseSource</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Instantiate airframe source noise prediction.</span>

<span class="sd">    :param list opPoint: Approach, Cutback, Sideline</span>
<span class="sd">    :param int N_wheels: Array containing the number of wheels in each landing gear system</span>
<span class="sd">    :param int N_struts: Array containing the number of main struts in each landing gear system</span>
<span class="sd">    :param int nlg: Number of landing gear systems</span>
<span class="sd">    :param ndarray d_wheel: 1D array containing the diameters of landing gear wheels (in)</span>
<span class="sd">    :param ndarray d_strut: 1D array containing typical diameter of landing gear struts (in)</span>
<span class="sd">    :param ndarray d_wire: 1D array containing typical diameter of landing gear wire/small pipes (in)</span>
<span class="sd">    :param int NoFlap: Number of flap elements</span>
<span class="sd">    :param ndarray S_flap: 1D array containing the area of each flap (m**2)</span>
<span class="sd">    :param ndarray span_flap: 1D array containing the span of each flap (m)</span>
<span class="sd">    :param float Sw: Aircraft reference area (m**2)</span>
<span class="sd">    :param float span: Wing span (m)</span>
<span class="sd">    :param int ND: Coefficient for jet aircraft (1 =&gt; + 6dB in wing trailing edge OASPL)</span>
<span class="sd">    :param float span_hor_tail: Horizontal tail span (m)</span>
<span class="sd">    :param float Sht: Horizontal tail area (m)</span>
<span class="sd">    :param float span_ver_tail: Vertical tail span (m)</span>
<span class="sd">    :param float Svt: Vertical tail area (m)</span>
<span class="sd">    :param str flap_type: Flap type: 1slot, 2slot, 3slot</span>
<span class="sd">    :param str slat_type: Leading edge high-lift system type: slat, le_flap</span>
<span class="sd">    :param ndarray theta: 1D array containing the longitudinal directivity angles (deg)</span>
<span class="sd">    :param ndarray fband: 1D array containing the 1/3 octave band frequencies (Hz)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">opPoint</span><span class="p">,</span> <span class="n">N_wheels</span><span class="p">,</span> <span class="n">N_struts</span><span class="p">,</span> <span class="n">nlg</span><span class="p">,</span> <span class="n">d_wheel</span><span class="p">,</span> <span class="n">d_strut</span><span class="p">,</span> <span class="n">d_wire</span><span class="p">,</span> <span class="n">NoFlap</span><span class="p">,</span> <span class="n">S_flap</span><span class="p">,</span> <span class="n">span_flap</span><span class="p">,</span> <span class="n">Sw</span><span class="p">,</span> <span class="n">span</span><span class="p">,</span>
                 <span class="n">ND</span><span class="p">,</span> <span class="n">span_hor_tail</span><span class="p">,</span> <span class="n">Sht</span><span class="p">,</span> <span class="n">span_ver_tail</span><span class="p">,</span> <span class="n">Svt</span><span class="p">,</span> <span class="n">flap_type</span><span class="p">,</span> <span class="n">slat_type</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">fband</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opPoint</span> <span class="o">=</span> <span class="n">opPoint</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N_wheels</span> <span class="o">=</span> <span class="n">N_wheels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N_struts</span> <span class="o">=</span> <span class="n">N_struts</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NoLG</span> <span class="o">=</span> <span class="n">nlg</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">d_wheel</span> <span class="o">=</span> <span class="n">d_wheel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">d_strut</span> <span class="o">=</span> <span class="n">d_strut</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">d_wire</span> <span class="o">=</span> <span class="n">d_wire</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NoFlaps</span> <span class="o">=</span> <span class="n">NoFlap</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Sf</span> <span class="o">=</span> <span class="n">S_flap</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bf</span> <span class="o">=</span> <span class="n">span_flap</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Sw</span> <span class="o">=</span> <span class="n">Sw</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bw</span> <span class="o">=</span> <span class="n">span</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ND</span> <span class="o">=</span> <span class="n">ND</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bht</span> <span class="o">=</span> <span class="n">span_hor_tail</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Sht</span> <span class="o">=</span> <span class="n">Sht</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bvt</span> <span class="o">=</span> <span class="n">span_ver_tail</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Svt</span> <span class="o">=</span> <span class="n">Svt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flap_type</span> <span class="o">=</span> <span class="n">flap_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slat_type</span> <span class="o">=</span> <span class="n">slat_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fband</span> <span class="o">=</span> <span class="n">fband</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nthet</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fband</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Po</span> <span class="o">=</span> \
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">9.877825</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.675465</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.771083</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.700787</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.791079</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.001907e1</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.975054</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.008466e1</span><span class="p">],</span>
                      <span class="p">[</span><span class="o">-</span><span class="mf">7.632699</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.857752</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.604022</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.892989</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.587548</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.9668</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.810322</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.393665</span><span class="p">],</span>
                      <span class="p">[</span><span class="mf">1.661801e-1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.117547</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.498093</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.764243e-1</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.746056e-1</span><span class="p">,</span> <span class="mf">2.283479</span><span class="p">,</span> <span class="mf">2.421265</span><span class="p">,</span> <span class="mf">6.13125</span><span class="p">],</span>
                      <span class="p">[</span><span class="o">-</span><span class="mf">1.444081</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.222514</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.675554e-1</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.764243e-1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.553996</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.257356</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.296517</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.564913</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Qo</span> <span class="o">=</span> \
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">1.025003e1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.066351e1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.018087e1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.033656e1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.044686e1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.076274e1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.076015e1</span><span class="p">,</span>
                       <span class="o">-</span><span class="mf">1.059679</span><span class="p">],</span>
                      <span class="p">[</span><span class="o">-</span><span class="mf">7.112481</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.831999</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.14302</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.058539e1</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.7798</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.142915e1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.086217e1</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.508286</span><span class="p">],</span>
                      <span class="p">[</span><span class="o">-</span><span class="mf">1.52365e1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.315696e1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.525915e1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.234325e1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.48048e1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.585081e1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.434196e1</span><span class="p">,</span>
                       <span class="o">-</span><span class="mf">1.494926e1</span><span class="p">],</span>
                      <span class="p">[</span><span class="mf">1.0224451e1</span><span class="p">,</span> <span class="mf">9.298285</span><span class="p">,</span> <span class="mf">5.283273</span><span class="p">,</span> <span class="mf">8.264513</span><span class="p">,</span> <span class="mf">5.24673</span><span class="p">,</span> <span class="mf">9.143245</span><span class="p">,</span> <span class="mf">9.873318</span><span class="p">,</span> <span class="mf">1.202191e1</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">So</span> <span class="o">=</span> \
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">3.379221</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.897243</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.820157</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.295315</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.8834</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.390352</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.588916</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.84597</span><span class="p">],</span>
                      <span class="p">[</span><span class="mf">3.370469e1</span><span class="p">,</span> <span class="mf">2.333926e1</span><span class="p">,</span> <span class="mf">7.075035</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.580083</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.700693e1</span><span class="p">,</span> <span class="mf">3.915408e1</span><span class="p">,</span> <span class="mf">5.34791</span><span class="p">,</span> <span class="mf">1.130759e1</span><span class="p">],</span>
                      <span class="p">[</span><span class="o">-</span><span class="mf">2.713406e2</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.496018e2</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.482546e2</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.907594e2</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.803207e2</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.636399e2</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.92612e2</span><span class="p">,</span>
                       <span class="o">-</span><span class="mf">2.409802e2</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> \
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">9.992824</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.587345</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.474888e1</span><span class="p">,</span> <span class="mf">3.307829e1</span><span class="p">,</span> <span class="mf">1.141251e2</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.080667e2</span><span class="p">,</span> <span class="mf">2.104914e2</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.519879e1</span><span class="p">])</span>

<div class="viewcode-block" id="Airframe.calc">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.Airframe.calc">[docs]</a>
    <span class="k">def</span> <span class="nf">calc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Ta</span><span class="p">,</span> <span class="n">Ha</span><span class="p">,</span> <span class="n">Ma</span><span class="p">,</span> <span class="n">Va</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">defl_flap</span><span class="p">,</span> <span class="n">defl_slat</span><span class="p">,</span> <span class="n">LG</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Airframe source noise model based on a combination of methods found in public literature. Trailing-edge and</span>
<span class="sd">        landing gear noise are modelled separately. The references for each method are found in the description of the</span>
<span class="sd">        corresponding functions.</span>

<span class="sd">        :param float Ta: Atmospheric static temperature (K)</span>
<span class="sd">        :param float Ha: Flight altitude (m)</span>
<span class="sd">        :param float Ma: Aircraft Mach number</span>
<span class="sd">        :param float Va: Aircraft speed (m/s)</span>
<span class="sd">        :param float phi: Lateral directivity angle (deg)</span>
<span class="sd">        :param float defl_flap: Flap deflection angle (rad)</span>
<span class="sd">        :param float defl_flap: Slat deflection angle (rad)</span>
<span class="sd">        :param int LG: Landing gear position (0 =&gt; retracted, 1 =&gt; extended)</span>
<span class="sd">        :return ndarray: 2D array of Rms or effective acoustic pressure for airframe component</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">Pa</span> <span class="o">=</span> <span class="n">AtmosphericEffects</span><span class="o">.</span><span class="n">get_p_ambient</span><span class="p">(</span><span class="n">Ha</span><span class="p">)</span>
        <span class="n">rho0</span> <span class="o">=</span> <span class="n">Pa</span> <span class="o">/</span> <span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">Risa</span> <span class="o">*</span> <span class="n">Ta</span><span class="p">)</span>

        <span class="c1"># Fink&#39;s model for trailing edge noise</span>
        <span class="k">if</span> <span class="n">Va</span> <span class="o">&gt;</span> <span class="mf">0.001</span> <span class="ow">and</span> <span class="n">Ha</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">LG</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">LG</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">defl_flap</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">flaps</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">flaps</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">defl_slat</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">slats</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">slats</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">LG</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">lgs</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">lgs</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">opPoint</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Approach&#39;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">opPoint</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Sideline&#39;</span><span class="p">:</span>
                    <span class="n">flaps</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">slats</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">lgs</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">flaps</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="n">slats</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="n">lgs</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="c1"># Noise from wing</span>
            <span class="n">ny</span> <span class="o">=</span> <span class="n">DynamicViscocity</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">Ta</span><span class="p">)</span> <span class="o">/</span> <span class="n">rho0</span>
            <span class="n">phi_sid</span> <span class="o">=</span> <span class="n">phi</span>  <span class="c1"># Sideline angle (lateral directivity) is calculated from the flyover plane-&gt;In flyover, phi=0</span>
            <span class="n">horizontal_factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">phi_sid</span><span class="p">))</span>
            <span class="n">wing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_wing_and_tail</span><span class="p">(</span><span class="n">Va</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sw</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bw</span><span class="p">,</span> <span class="n">horizontal_factor</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ND</span><span class="p">)</span>
            <span class="n">prms_wing</span> <span class="o">=</span> <span class="n">wing</span>
            <span class="n">ps_trailing_edge</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">wing</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

            <span class="c1"># Noise from horizontal tail</span>
            <span class="n">hor_tail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_wing_and_tail</span><span class="p">(</span><span class="n">Va</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sht</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bht</span><span class="p">,</span> <span class="n">horizontal_factor</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">prms_hor_tail</span> <span class="o">=</span> <span class="n">hor_tail</span>
            <span class="n">ps_trailing_edge</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">hor_tail</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">ps_trailing_edge</span>

            <span class="c1"># Noise from vertical tail (0 when lateral directivity is fixed to 90 degrees)</span>
            <span class="n">vertical_factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">phi_sid</span><span class="p">))</span>
            <span class="n">ver_tail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_wing_and_tail</span><span class="p">(</span><span class="n">Va</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Svt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bvt</span><span class="p">,</span> <span class="n">vertical_factor</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">ps_trailing_edge</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">ver_tail</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">ps_trailing_edge</span>
            <span class="n">ps_flap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nthet</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">flaps</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">iflap</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NoFlaps</span><span class="p">):</span>
                    <span class="n">flap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_te_flaps</span><span class="p">(</span><span class="n">Va</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sf</span><span class="p">[</span><span class="n">iflap</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">bf</span><span class="p">[</span><span class="n">iflap</span><span class="p">],</span> <span class="n">defl_flap</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">flap_type</span><span class="p">,</span> <span class="n">phi_sid</span><span class="p">)</span>
                    <span class="n">ps_trailing_edge</span> <span class="o">=</span> <span class="n">ps_trailing_edge</span> <span class="o">+</span> <span class="nb">pow</span><span class="p">(</span><span class="n">flap</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="n">ps_flap</span> <span class="o">=</span> <span class="n">ps_flap</span> <span class="o">+</span> <span class="nb">pow</span><span class="p">(</span><span class="n">flap</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ps_flap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">ps_trailing_edge</span><span class="p">))</span>
            <span class="n">prms_flap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ps_flap</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">slats</span><span class="p">:</span>
                <span class="n">horizontal_factor</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">phi_sid</span><span class="p">))</span>
                <span class="n">p_slat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_le_slats</span><span class="p">(</span><span class="n">Va</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sw</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bw</span><span class="p">,</span> <span class="n">horizontal_factor</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ND</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">slat_type</span><span class="p">)</span>
                <span class="n">ps_trailing_edge</span> <span class="o">=</span> <span class="n">ps_trailing_edge</span> <span class="o">+</span> <span class="nb">pow</span><span class="p">(</span><span class="n">p_slat</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">p_slat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">ps_trailing_edge</span><span class="p">))</span>
            <span class="n">prms_slat</span> <span class="o">=</span> <span class="n">p_slat</span>

            <span class="n">SPLte</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">prms2SPL</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ps_trailing_edge</span><span class="p">))</span> <span class="o">-</span> <span class="mi">3</span>  <span class="c1"># Method predicts the level 3 dB above free field</span>
            <span class="n">prms_trailing_edge</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">SPLte</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">lgs</span><span class="p">:</span>
                <span class="n">ps_lg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">ps_trailing_edge</span><span class="p">))</span>
                <span class="n">ps_lg_m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">ps_trailing_edge</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">ilg</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NoLG</span><span class="p">):</span>
                    <span class="n">p_landinggear</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLandingGear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_wheels</span><span class="p">[</span><span class="n">ilg</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_struts</span><span class="p">[</span><span class="n">ilg</span><span class="p">],</span> <span class="n">Ma</span> <span class="o">*</span> <span class="mf">0.75</span><span class="p">,</span>
                                                        <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">gamma_air</span> <span class="o">*</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">Risa</span> <span class="o">*</span> <span class="n">Ta</span><span class="p">),</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">d_strut</span><span class="p">[</span><span class="n">ilg</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">d_wire</span><span class="p">[</span><span class="n">ilg</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">d_wheel</span><span class="p">[</span><span class="n">ilg</span><span class="p">])</span>
                    <span class="n">ps_lg</span> <span class="o">=</span> <span class="n">ps_lg</span> <span class="o">+</span> <span class="nb">pow</span><span class="p">(</span><span class="n">p_landinggear</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">ilg</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">ps_lg_m</span> <span class="o">=</span> <span class="n">ps_lg_m</span> <span class="o">+</span> <span class="nb">pow</span><span class="p">(</span><span class="n">p_landinggear</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                        <span class="n">prms_main_lg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ps_lg_m</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">prms_nose_lg</span> <span class="o">=</span> <span class="n">p_landinggear</span>

                <span class="n">prms_lg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ps_lg</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">prms_lg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">ps_trailing_edge</span><span class="p">))</span>
                <span class="n">prms_nose_lg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">ps_trailing_edge</span><span class="p">))</span>
                <span class="n">prms_main_lg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">ps_trailing_edge</span><span class="p">))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">prms_trailing_edge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nthet</span><span class="p">))</span>
            <span class="n">prms_wing</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nthet</span><span class="p">))</span>
            <span class="n">prms_hor_tail</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nthet</span><span class="p">))</span>
            <span class="n">prms_slat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nthet</span><span class="p">))</span>
            <span class="n">prms_flap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nthet</span><span class="p">))</span>
            <span class="n">prms_nose_lg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nthet</span><span class="p">))</span>
            <span class="n">prms_main_lg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nthet</span><span class="p">))</span>
            <span class="n">prms_lg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nthet</span><span class="p">))</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">prms_trailing_edge</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="nb">pow</span><span class="p">(</span><span class="n">prms_lg</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">prms_wing</span><span class="p">,</span> <span class="n">prms_hor_tail</span><span class="p">,</span> <span class="n">prms_slat</span><span class="p">,</span> <span class="n">prms_flap</span><span class="p">,</span>
                <span class="n">prms_nose_lg</span><span class="p">,</span> <span class="n">prms_main_lg</span><span class="p">,</span> <span class="n">prms_lg</span><span class="p">]</span></div>


<div class="viewcode-block" id="Airframe.get_wing_and_tail">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.Airframe.get_wing_and_tail">[docs]</a>
    <span class="k">def</span> <span class="nf">get_wing_and_tail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Va</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">dir_factor</span><span class="p">,</span> <span class="n">ND</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Trailing edge source noise model for wing and tail surfaces developed by Fink (M.R. Fink, &quot;Noise Component Method</span>
<span class="sd">        for Airframe Noise&quot;).</span>

<span class="sd">        :param float Va: Aircraft speed (m/s)</span>
<span class="sd">        :param float ny: Kinematic viscocity (m**2/s)</span>
<span class="sd">        :param float S: Wing or tail area (m**2)</span>
<span class="sd">        :param float b: Wing or tail span (m)</span>
<span class="sd">        :param float dir_factor: Equals cos(phi) where phi is lateral directivity calculated from the flyover plane</span>
<span class="sd">        :param int ND: Coefficient for jet aircraft (1 =&gt; + 6dB in wing trailing edge OASPL)</span>

<span class="sd">        :return ndarray: 2D array of Rms or effective acoustic pressure for wing and tail airframe component</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fband</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fband</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span>
        <span class="n">nfreq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span>
        <span class="n">nthet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nthet</span>
        <span class="n">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="mf">0.37</span> <span class="o">*</span> <span class="p">(</span><span class="n">S</span> <span class="o">/</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">Va</span> <span class="o">*</span> <span class="n">S</span> <span class="o">/</span> <span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">ny</span><span class="p">))</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">))</span>
        <span class="n">H</span> <span class="o">=</span> <span class="n">R</span>
        <span class="n">OASPL_theta</span> <span class="o">=</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Va</span> <span class="o">/</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">kt2mps</span><span class="p">))</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">delta</span> <span class="o">*</span> <span class="n">b</span> <span class="o">/</span> <span class="p">(</span><span class="n">H</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> \
                      <span class="n">ND</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">((</span><span class="n">dir_factor</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">101.3</span>
        <span class="n">OASPL_theta</span><span class="p">[(</span><span class="n">theta</span> <span class="o">==</span> <span class="mi">180</span><span class="p">)]</span> <span class="o">=</span> <span class="n">OASPL_theta</span><span class="p">[(</span><span class="n">theta</span> <span class="o">==</span> <span class="mi">175</span><span class="p">)]</span>
        <span class="n">OASPL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">OASPL_theta</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nthet</span><span class="p">)),</span> <span class="p">(</span><span class="n">nfreq</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

        <span class="n">fmax</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">Va</span> <span class="o">/</span> <span class="n">delta</span>  <span class="c1"># Maximum amplitude frequency</span>
        <span class="n">fb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">fband</span><span class="p">,</span> <span class="p">(</span><span class="n">nfreq</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nthet</span><span class="p">))</span>
        <span class="n">SPL</span> <span class="o">=</span> <span class="n">OASPL</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">0.613</span> <span class="o">*</span> <span class="p">((</span><span class="n">fb</span> <span class="o">/</span> <span class="n">fmax</span><span class="p">)</span> <span class="o">**</span> <span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="p">(((</span><span class="n">fb</span> <span class="o">/</span> <span class="n">fmax</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">3</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)))</span> <span class="o">-</span> \
              <span class="mf">0.03</span> <span class="o">*</span> <span class="p">(</span><span class="n">R</span> <span class="o">/</span> <span class="p">(</span><span class="mi">500</span> <span class="o">*</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">ft2m</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">fb</span> <span class="o">/</span> <span class="n">fmax</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">3</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">SPL</span><span class="p">)</span></div>


<div class="viewcode-block" id="Airframe.get_te_flaps">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.Airframe.get_te_flaps">[docs]</a>
    <span class="k">def</span> <span class="nf">get_te_flaps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Va</span><span class="p">,</span> <span class="n">Sf</span><span class="p">,</span> <span class="n">bf</span><span class="p">,</span> <span class="n">defl_flap</span><span class="p">,</span> <span class="n">flap_type</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Trailing edge flap source noise model developed by Fink (M.R. Fink, &quot;Airframe Noise Prediction Method&quot;,</span>
<span class="sd">        FAA-RD-77-29 and M.R. Fink, &quot;Noise Component Method for Airframe Noise&quot;).</span>

<span class="sd">        :param float Va: Aircraft speed (m/s)</span>
<span class="sd">        :param float Sf: Flap area (m**2)</span>
<span class="sd">        :param float bf: Flap span (m)</span>
<span class="sd">        :param float defl_flap: Flap deflection angle (rad)</span>
<span class="sd">        :param float phi: Lateral directivity calculated from the flyover plane</span>

<span class="sd">        :return ndarray: 2D array of Rms or effective acoustic pressure for trailing edge flaps</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fband</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fband</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span>
        <span class="n">nfreq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span>
        <span class="n">nthet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nthet</span>
        <span class="n">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span>
        <span class="n">H</span> <span class="o">=</span> <span class="n">R</span>
        <span class="n">cf</span> <span class="o">=</span> <span class="n">Sf</span> <span class="o">/</span> <span class="n">bf</span>
        <span class="n">St</span> <span class="o">=</span> <span class="n">fband</span> <span class="o">*</span> <span class="n">cf</span> <span class="o">/</span> <span class="n">Va</span>
        <span class="k">if</span> <span class="s2">&quot;1slot&quot;</span> <span class="ow">or</span> <span class="s2">&quot;2slot&quot;</span> <span class="ow">in</span> <span class="n">flap_type</span><span class="p">:</span>
            <span class="n">G67</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nfreq</span><span class="p">)</span>
            <span class="n">G67</span><span class="p">[(</span><span class="n">St</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">99</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">St</span><span class="p">[(</span><span class="n">St</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)])</span>
            <span class="n">G67</span><span class="p">[(</span><span class="mi">2</span> <span class="o">&lt;=</span> <span class="n">St</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">St</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">103.82</span> <span class="o">-</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">St</span><span class="p">[(</span><span class="mi">2</span> <span class="o">&lt;=</span> <span class="n">St</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">St</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">)])</span>
            <span class="n">G67</span><span class="p">[(</span><span class="mi">20</span> <span class="o">&lt;=</span> <span class="n">St</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">135.04</span> <span class="o">-</span> <span class="mi">30</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">St</span><span class="p">[(</span><span class="mi">20</span> <span class="o">&lt;=</span> <span class="n">St</span><span class="p">)])</span>
            <span class="n">G67_dir</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">G67</span><span class="p">,</span> <span class="p">(</span><span class="n">nfreq</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nthet</span><span class="p">))</span>
        <span class="k">elif</span> <span class="s2">&quot;3slot&quot;</span> <span class="ow">in</span> <span class="n">flap_type</span><span class="p">:</span>
            <span class="n">G67</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nfreq</span><span class="p">)</span>
            <span class="n">G67</span><span class="p">[(</span><span class="n">St</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">99</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">St</span><span class="p">[(</span><span class="n">St</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)])</span>
            <span class="n">G67</span><span class="p">[(</span><span class="mi">2</span> <span class="o">&lt;=</span> <span class="n">St</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">St</span> <span class="o">&lt;</span> <span class="mi">75</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">102.61</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">St</span><span class="p">[(</span><span class="mi">2</span> <span class="o">&lt;=</span> <span class="n">St</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">St</span> <span class="o">&lt;</span> <span class="mi">75</span><span class="p">)])</span>
            <span class="n">G67</span><span class="p">[(</span><span class="mi">75</span> <span class="o">&lt;=</span> <span class="n">St</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">155.11</span> <span class="o">-</span> <span class="mi">30</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">St</span><span class="p">[(</span><span class="mi">75</span> <span class="o">&lt;=</span> <span class="n">St</span><span class="p">)])</span>
            <span class="n">G67_dir</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">G67</span><span class="p">,</span> <span class="p">(</span><span class="n">nfreq</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nthet</span><span class="p">))</span>
        <span class="n">dir_factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">+</span> <span class="n">defl_flap</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span>
        <span class="n">dir_factor</span><span class="p">[</span><span class="n">dir_factor</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">dir_fac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dir_factor</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nthet</span><span class="p">)),</span> <span class="p">(</span><span class="n">nfreq</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">SPL</span> <span class="o">=</span> <span class="n">G67_dir</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Sf</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">defl_flap</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">H</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> \
              <span class="mi">60</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Va</span> <span class="o">/</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">kt2mps</span><span class="p">))</span> <span class="o">+</span> <span class="n">dir_fac</span>

        <span class="k">return</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">SPL</span><span class="p">)</span></div>


<div class="viewcode-block" id="Airframe.get_le_slats">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.Airframe.get_le_slats">[docs]</a>
    <span class="k">def</span> <span class="nf">get_le_slats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Va</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">dir_factor</span><span class="p">,</span> <span class="n">ND</span><span class="p">,</span> <span class="n">slat_type</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Leading edge high-lift system source noise model developed by Fink (M.R. Fink, &quot;Airframe Noise Prediction</span>
<span class="sd">        Method&quot;, FAA-RD-77-29 and M.R. Fink, &quot;Noise Component Method for Airframe Noise&quot;).</span>

<span class="sd">        :param float Va: Aircraft speed (m/s)</span>
<span class="sd">        :param float ny: Kinematic viscocity (m**2/s)</span>
<span class="sd">        :param float S: Wing or tail area (m**2)</span>
<span class="sd">        :param float b: Wing or tail span (m)</span>
<span class="sd">        :param float dir_factor: Equals cos(phi) where phi is lateral directivity calculated from the flyover plane</span>
<span class="sd">        :param int ND: Coefficient for jet aircraft (1 =&gt; + 6dB in wing trailing edge OASPL)</span>

<span class="sd">        :return ndarray: 2D array of Rms or effective acoustic pressure for leading edge flaps</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fband</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fband</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span>
        <span class="n">nfreq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span>
        <span class="n">nthet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nthet</span>
        <span class="n">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span>
        <span class="k">if</span> <span class="s2">&quot;slat&quot;</span> <span class="ow">in</span> <span class="n">slat_type</span><span class="p">:</span>
            <span class="n">SPLi</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">prms2SPL</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_wing_and_tail</span><span class="p">(</span><span class="n">Va</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">dir_factor</span><span class="p">,</span> <span class="n">ND</span><span class="p">))</span> <span class="o">+</span> <span class="mi">3</span>  <span class="c1"># spectrum 1</span>
            <span class="n">prmsi</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">SPLi</span><span class="p">)</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="mf">0.37</span> <span class="o">*</span> <span class="p">(</span><span class="n">S</span> <span class="o">/</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">Va</span> <span class="o">*</span> <span class="n">S</span> <span class="o">/</span> <span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">ny</span><span class="p">))</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">))</span>
            <span class="n">H</span> <span class="o">=</span> <span class="n">R</span>
            <span class="n">OASPL_theta</span> <span class="o">=</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Va</span> <span class="o">/</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">kt2mps</span><span class="p">))</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">delta</span> <span class="o">*</span> <span class="n">b</span> <span class="o">/</span> <span class="p">(</span><span class="n">H</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> \
                          <span class="n">ND</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">((</span><span class="n">dir_factor</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">101.3</span>
            <span class="n">OASPL_theta</span><span class="p">[(</span><span class="n">theta</span> <span class="o">==</span> <span class="mi">180</span><span class="p">)]</span> <span class="o">=</span> <span class="n">OASPL_theta</span><span class="p">[(</span><span class="n">theta</span> <span class="o">==</span> <span class="mi">175</span><span class="p">)]</span>
            <span class="n">OASPL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">OASPL_theta</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nthet</span><span class="p">)),</span> <span class="p">(</span><span class="n">nfreq</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">fmax</span> <span class="o">=</span> <span class="mf">0.4562</span> <span class="o">*</span> <span class="n">Va</span> <span class="o">/</span> <span class="n">delta</span>  <span class="c1"># Maximum amplitude frequency</span>
            <span class="n">fb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">fband</span><span class="p">,</span> <span class="p">(</span><span class="n">nfreq</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nthet</span><span class="p">))</span>
            <span class="n">SPLii</span> <span class="o">=</span> <span class="n">OASPL</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">0.613</span> <span class="o">*</span> <span class="p">((</span><span class="n">fb</span> <span class="o">/</span> <span class="n">fmax</span><span class="p">)</span> <span class="o">**</span> <span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="p">(((</span><span class="n">fb</span> <span class="o">/</span> <span class="n">fmax</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">3</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)))</span> <span class="o">-</span> \
                    <span class="mf">0.03</span> <span class="o">*</span> <span class="p">(</span><span class="n">R</span> <span class="o">/</span> <span class="p">(</span><span class="mi">500</span> <span class="o">*</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">ft2m</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">fb</span> <span class="o">/</span> <span class="n">fmax</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">3</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span>  <span class="c1"># spectrum 2</span>
            <span class="n">prmsii</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">SPLii</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s2">&quot;flap&quot;</span> <span class="ow">in</span> <span class="n">slat_type</span><span class="p">:</span>
            <span class="n">SPLi</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">prms2SPL</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_wing_and_tail</span><span class="p">(</span><span class="n">Va</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">dir_factor</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
            <span class="n">prmsi</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">SPLi</span><span class="p">)</span>
            <span class="n">prmsii</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">prmsi</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="nb">pow</span><span class="p">(</span><span class="n">prmsii</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span></div>


<div class="viewcode-block" id="Airframe.getLandingGear">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.Airframe.getLandingGear">[docs]</a>
    <span class="k">def</span> <span class="nf">getLandingGear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Nt</span><span class="p">,</span> <span class="n">Ns</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">dl</span><span class="p">,</span> <span class="n">dh</span><span class="p">,</span> <span class="n">dtire</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Landing gear source noise model based on the method presented by Sen et al. (R. Sen, B. Hardy, K. Yamamoto,</span>
<span class="sd">        Y. Guo., G. Miller &quot;Airframe Noise Sub-Component Definition and Model&quot;. NASA/CR-2004-213255.)</span>

<span class="sd">        :param int Nt: Number of wheels/tires</span>
<span class="sd">        :param int Ns: Number of main struts</span>
<span class="sd">        :param float M: Aircraft Mach number</span>
<span class="sd">        :param float c0: Speed of sound (m/s)</span>
<span class="sd">        :param float dl: Representative length scale for low frequency noise component (ft)</span>
<span class="sd">        :param float dh: Representative length scale for high frequency noise component (ft)</span>
<span class="sd">        :param float dtire: Representative length scale for tire noise component (ft)</span>

<span class="sd">        :return ndarray: 2D array of Rms or effective acoustic pressure for landing gear</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fband</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fband</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span>
        <span class="n">nfreq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span>
        <span class="n">nthet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nthet</span>
        <span class="n">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span>

        <span class="n">V</span> <span class="o">=</span> <span class="n">M</span> <span class="o">*</span> <span class="n">c0</span> <span class="o">/</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">ft2m</span>
        <span class="n">dmid</span> <span class="o">=</span> <span class="p">(</span><span class="n">dl</span> <span class="o">+</span> <span class="n">dh</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">R</span> <span class="o">/</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">ft2m</span>

        <span class="c1"># Step 1: Calculate lossless, de-Dopplerized OASPL(theta) for all components</span>

        <span class="c1"># 1a) Low freq. component</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.641991e2</span><span class="p">,</span> <span class="mf">4.48107e-4</span><span class="p">])</span>
        <span class="n">DELTA1</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">theta</span><span class="p">)</span>
        <span class="n">OASPL1</span> <span class="o">=</span> <span class="n">DELTA1</span> <span class="o">+</span> <span class="mi">60</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">+</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dl</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">/</span> <span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Ns</span> <span class="o">*</span> <span class="n">Nt</span><span class="p">)</span>

        <span class="c1"># 1b) High freq. component</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.220403e2</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.328178</span><span class="p">,</span> <span class="mf">1.325498e-2</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.2385e-5</span><span class="p">])</span>
        <span class="n">DELTA2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">nthet</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>
        <span class="n">DELTA2</span><span class="p">[</span><span class="n">theta</span> <span class="o">&gt;</span> <span class="mi">140</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">theta</span><span class="p">[</span><span class="n">theta</span> <span class="o">&gt;</span> <span class="mi">140</span><span class="p">]</span> <span class="o">+</span> <span class="n">C</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">theta</span><span class="p">[</span><span class="n">theta</span> <span class="o">&gt;</span> <span class="mi">140</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> \
                              <span class="n">C</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">theta</span><span class="p">[</span><span class="n">theta</span> <span class="o">&gt;</span> <span class="mi">140</span><span class="p">],</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">OASPL2</span> <span class="o">=</span> <span class="n">DELTA2</span> <span class="o">+</span> <span class="mi">60</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">+</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dh</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">/</span> <span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Ns</span> <span class="o">*</span> <span class="n">Nt</span><span class="p">)</span>

        <span class="c1"># 1c) Mid freq. component</span>
        <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.933593e2</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.55895e-1</span><span class="p">,</span> <span class="mf">1.795617e-3</span><span class="p">])</span>
        <span class="n">DELTA3</span> <span class="o">=</span> <span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">B</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">theta</span> <span class="o">+</span> <span class="n">B</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">OASPL3</span> <span class="o">=</span> <span class="n">DELTA3</span> <span class="o">+</span> <span class="mi">60</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">+</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dmid</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">/</span> <span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span>
            <span class="n">Ns</span> <span class="o">*</span> <span class="n">Nt</span><span class="p">)</span>

        <span class="c1"># 1d) Tire noise component</span>
        <span class="n">OASPL4</span> <span class="o">=</span> <span class="mi">162</span> <span class="o">+</span> <span class="mi">60</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">+</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dtire</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">/</span> <span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Ns</span> <span class="o">*</span> <span class="n">Nt</span><span class="p">)</span>

        <span class="c1"># Step 2: Calculate Strouhal number</span>

        <span class="n">St1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dl</span> <span class="o">*</span> <span class="n">fband</span> <span class="o">/</span> <span class="n">V</span><span class="p">)</span>
        <span class="n">St2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dh</span> <span class="o">*</span> <span class="n">fband</span> <span class="o">/</span> <span class="n">V</span><span class="p">)</span>
        <span class="n">St3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dmid</span> <span class="o">*</span> <span class="n">fband</span> <span class="o">/</span> <span class="n">V</span><span class="p">)</span>
        <span class="n">St4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dtire</span> <span class="o">*</span> <span class="n">fband</span> <span class="o">/</span> <span class="n">V</span><span class="p">)</span>

        <span class="c1"># Step 3: Calculate 1/3 octave SPL</span>

        <span class="c1"># 3a) Low freq. component</span>
        <span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Po</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">d1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span> <span class="n">P</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">St1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">P</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">St1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">P</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">St1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">3</span><span class="p">)</span>
                       <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nfreq</span><span class="p">)])</span>
        <span class="n">SPL1</span> <span class="o">=</span> <span class="n">OASPL1</span> <span class="o">+</span> <span class="n">d1</span>

        <span class="c1"># 3b) High freq. component</span>
        <span class="n">Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Qo</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">d2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span> <span class="n">Q</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">St2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">Q</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">St2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Q</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">St2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">3</span><span class="p">)</span>
                       <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nfreq</span><span class="p">)])</span>
        <span class="n">SPL2</span> <span class="o">=</span> <span class="n">OASPL2</span> <span class="o">+</span> <span class="n">d2</span>

        <span class="c1"># 3c) Mid freq. component</span>
        <span class="n">S</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">So</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">d3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span> <span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">St3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">S</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">St3</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nfreq</span><span class="p">)])</span>
        <span class="n">SPL3</span> <span class="o">=</span> <span class="n">OASPL3</span> <span class="o">+</span> <span class="n">d3</span>

        <span class="c1"># 3d) Tire noise component</span>
        <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span>
        <span class="n">d4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">St4</span> <span class="o">+</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">St4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">X</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">St4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">X</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">St4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span>
                                  <span class="n">X</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">St4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">X</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">St4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">X</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">St4</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="n">nfreq</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">nthet</span><span class="p">,</span>
                       <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">SPL4</span> <span class="o">=</span> <span class="n">OASPL4</span> <span class="o">+</span> <span class="n">d4</span>

        <span class="c1"># Step 5: Calculate total noise level</span>
        <span class="n">prms1</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">SPL1</span><span class="p">)</span>
        <span class="n">prms2</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">SPL2</span><span class="p">)</span>
        <span class="n">prms3</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">SPL3</span><span class="p">)</span>
        <span class="n">prms4</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">SPL4</span><span class="p">)</span>
        <span class="n">prms_tot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">prms1</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">prms2</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">prms3</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">prms4</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">prms_tot</span></div>


<div class="viewcode-block" id="Airframe.full_matrix">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.Airframe.full_matrix">[docs]</a>
    <span class="k">def</span> <span class="nf">full_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mato</span><span class="p">,</span> <span class="n">nl</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the coefficients that are required for the landing gear calculation for every directivity angle and</span>
<span class="sd">        returns a nc x nthet array where nc is the order of the equation of each noise component.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span>
        <span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nl</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">theta</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">th</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">theta</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">th</span> <span class="o">&lt;=</span> <span class="mi">60</span><span class="p">:</span>
                <span class="n">mat</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">mato</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="mi">60</span> <span class="o">&lt;</span> <span class="n">th</span> <span class="o">&lt;=</span> <span class="mi">120</span><span class="p">:</span>
                <span class="n">k</span> <span class="o">=</span> <span class="n">th</span> <span class="o">/</span> <span class="mi">10</span> <span class="o">-</span> <span class="mi">5</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nl</span><span class="p">):</span>
                    <span class="n">mat</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]),</span> <span class="n">mato</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:],</span>
                                                     <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">)(</span><span class="n">k</span><span class="p">)</span>
            <span class="k">elif</span> <span class="mi">120</span> <span class="o">&lt;</span> <span class="n">th</span> <span class="o">&lt;</span> <span class="mi">140</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nl</span><span class="p">):</span>
                    <span class="n">mat</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">120</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">140</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">mato</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">mato</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">mato</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mi">7</span><span class="p">]]),</span>
                        <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">)(</span><span class="n">th</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">th</span> <span class="o">&gt;=</span> <span class="mi">140</span><span class="p">:</span>
                <span class="n">mat</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">mato</span><span class="p">[:,</span> <span class="mi">7</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">mat</span></div>
</div>



<div class="viewcode-block" id="Jet">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.Jet">[docs]</a>
<span class="k">class</span> <span class="nc">Jet</span><span class="p">(</span><span class="n">NoiseSource</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Instantiate jet source noise prediction.</span>

<span class="sd">    :param float A_core_caj: Nozzle exit flow area of inner stream or circular jet (m^2)</span>
<span class="sd">    :param float A_bypass_caj: Nozzle exit flow area of outer stream (m^2)</span>
<span class="sd">    :param str type: Nozzle type, mix or separate</span>
<span class="sd">    :param ndarray theta: 1D array containing the directivity angles (deg)</span>
<span class="sd">    :param ndarray fband: 1D array containing the 1/3 octave band frequencies (Hz)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">A_core_caj</span><span class="p">,</span> <span class="n">A_bypass_caj</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">fband</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">A_1</span> <span class="o">=</span> <span class="n">A_core_caj</span>
        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;separate&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">type_jet</span> <span class="o">=</span> <span class="s1">&#39;coaxial&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">A_2</span> <span class="o">=</span> <span class="n">A_bypass_caj</span>
        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;mix&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">type_jet</span> <span class="o">=</span> <span class="s1">&#39;circular&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">A_2</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fband</span> <span class="o">=</span> <span class="n">fband</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nthet</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fband</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta_c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">60.0</span><span class="p">,</span> <span class="mf">90.0</span><span class="p">,</span> <span class="mf">120.0</span><span class="p">,</span> <span class="mf">150.0</span><span class="p">,</span> <span class="mf">180.0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eta_c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r_const</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_thetas</span> <span class="o">=</span> <span class="mi">7</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table_iv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[[</span><span class="o">-</span><span class="mf">41.64</span><span class="p">,</span> <span class="mf">64.84</span><span class="p">,</span> <span class="mf">5.85</span><span class="p">,</span> <span class="mf">45.66</span><span class="p">,</span> <span class="o">-</span><span class="mf">45.95</span><span class="p">,</span> <span class="mf">28.98</span><span class="p">,</span> <span class="o">-</span><span class="mf">67.28</span><span class="p">,</span> <span class="mf">65.60</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.78</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.81</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.14</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.75</span><span class="p">,</span> <span class="mf">14.77</span><span class="p">,</span> <span class="mf">37.95</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">11.83</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.53</span><span class="p">,</span> <span class="mf">12.77</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.63</span><span class="p">,</span> <span class="mf">5.05</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.12</span><span class="p">,</span> <span class="mf">11.86</span><span class="p">,</span> <span class="o">-</span><span class="mf">41.33</span><span class="p">,</span> <span class="mf">40.51</span><span class="p">,</span> <span class="o">-</span><span class="mf">37.63</span><span class="p">,</span> <span class="mf">29.26</span><span class="p">,</span> <span class="mf">33.74</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.19</span><span class="p">,</span> <span class="mf">68.07</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">69.25</span><span class="p">,</span> <span class="mf">23.03</span><span class="p">,</span> <span class="mf">10.90</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.15</span><span class="p">,</span> <span class="mf">34.02</span><span class="p">,</span> <span class="mf">8.42</span><span class="p">,</span> <span class="mf">43.73</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">12.43</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.35</span><span class="p">,</span> <span class="mf">3.35</span><span class="p">,</span> <span class="mf">5.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">75.93</span><span class="p">,</span> <span class="mf">142.80</span><span class="p">,</span> <span class="o">-</span><span class="mf">147.56</span><span class="p">,</span> <span class="mf">180.53</span><span class="p">,</span> <span class="mf">10.22</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.33</span><span class="p">,</span> <span class="mf">9.26</span><span class="p">,</span> <span class="mf">15.17</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.61</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">53.84</span><span class="p">,</span> <span class="mf">3.31</span><span class="p">,</span> <span class="mf">43.94</span><span class="p">,</span> <span class="o">-</span><span class="mf">43.15</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">44.33</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.68</span><span class="p">,</span> <span class="mf">37.70</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.70</span><span class="p">,</span> <span class="mf">18.73</span><span class="p">,</span> <span class="o">-</span><span class="mf">23.67</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.44</span><span class="p">,</span> <span class="o">-</span><span class="mf">43.67</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.22</span><span class="p">,</span>
              <span class="mf">19.20</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.82</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.62</span><span class="p">,</span> <span class="mf">50.11</span><span class="p">,</span> <span class="mf">23.04</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.11</span><span class="p">,</span> <span class="mf">3.65</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.43</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">10.57</span><span class="p">,</span> <span class="o">-</span><span class="mf">16.34</span><span class="p">,</span> <span class="mf">0.54</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.42</span><span class="p">,</span> <span class="o">-</span><span class="mf">56.72</span><span class="p">,</span> <span class="mf">107.84</span><span class="p">,</span> <span class="o">-</span><span class="mf">178.07</span><span class="p">,</span> <span class="mf">168.22</span><span class="p">,</span> <span class="mf">13.12</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.30</span><span class="p">,</span> <span class="mf">8.54</span><span class="p">,</span> <span class="mf">14.35</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.72</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.10</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">52.80</span><span class="p">,</span> <span class="mf">3.71</span><span class="p">,</span> <span class="mf">46.06</span><span class="p">,</span> <span class="o">-</span><span class="mf">34.62</span><span class="p">,</span> <span class="mf">3.37</span><span class="p">,</span> <span class="mf">25.17</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.74</span><span class="p">,</span> <span class="mf">13.31</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.93</span><span class="p">,</span> <span class="mf">18.16</span><span class="p">,</span> <span class="o">-</span><span class="mf">28.99</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.44</span><span class="p">,</span> <span class="o">-</span><span class="mf">32.07</span><span class="p">,</span> <span class="o">-</span><span class="mf">27.97</span><span class="p">,</span>
              <span class="mf">20.33</span><span class="p">,</span> <span class="mf">0.94</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.62</span><span class="p">,</span> <span class="mf">32.54</span><span class="p">,</span> <span class="mf">11.21</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.00</span><span class="p">,</span> <span class="mf">19.64</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.21</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">7.84</span><span class="p">,</span> <span class="o">-</span><span class="mf">16.71</span><span class="p">,</span> <span class="mf">1.26</span><span class="p">,</span> <span class="mf">11.35</span><span class="p">,</span> <span class="o">-</span><span class="mf">47.74</span><span class="p">,</span> <span class="mf">76.07</span><span class="p">,</span> <span class="o">-</span><span class="mf">192.58</span><span class="p">,</span> <span class="mf">119.55</span><span class="p">,</span> <span class="mf">13.54</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.39</span><span class="p">,</span> <span class="mf">3.45</span><span class="p">,</span> <span class="mf">5.40</span><span class="p">,</span> <span class="mf">13.00</span><span class="p">,</span> <span class="mf">0.91</span><span class="p">,</span> <span class="o">-</span><span class="mf">39.79</span><span class="p">,</span>
              <span class="mf">1.46</span><span class="p">,</span> <span class="mf">42.20</span><span class="p">,</span> <span class="o">-</span><span class="mf">24.48</span><span class="p">,</span> <span class="mf">4.10</span><span class="p">,</span> <span class="mf">6.61</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.62</span><span class="p">,</span> <span class="mf">5.29</span><span class="p">,</span> <span class="o">-</span><span class="mf">59.88</span><span class="p">,</span> <span class="mf">12.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">27.16</span><span class="p">,</span> <span class="mf">0.44</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.20</span><span class="p">,</span> <span class="o">-</span><span class="mf">54.74</span><span class="p">,</span> <span class="mf">23.72</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.97</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">5.29</span><span class="p">,</span> <span class="mf">26.46</span><span class="p">,</span> <span class="mf">4.20</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.86</span><span class="p">,</span> <span class="mf">27.43</span><span class="p">,</span> <span class="mf">7.00</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">4.54</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.48</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">,</span> <span class="o">-</span><span class="mf">28.69</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.32</span><span class="p">,</span> <span class="mf">28.13</span><span class="p">,</span> <span class="o">-</span><span class="mf">137.39</span><span class="p">,</span> <span class="mf">43.89</span><span class="p">,</span> <span class="mf">9.91</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.83</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.45</span><span class="p">,</span> <span class="mf">15.72</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">,</span> <span class="mf">3.07</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.75</span><span class="p">,</span>
              <span class="mf">1.27</span><span class="p">,</span> <span class="mf">33.04</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.60</span><span class="p">,</span> <span class="mf">9.30</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.50</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.88</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.63</span><span class="p">,</span> <span class="o">-</span><span class="mf">16.95</span><span class="p">,</span> <span class="mf">9.76</span><span class="p">,</span> <span class="o">-</span><span class="mf">35.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.72</span><span class="p">,</span> <span class="o">-</span><span class="mf">29.24</span><span class="p">,</span> <span class="o">-</span><span class="mf">37.21</span><span class="p">,</span> <span class="mf">23.68</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">4.61</span><span class="p">,</span> <span class="mf">3.08</span><span class="p">,</span> <span class="mf">15.57</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.62</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.54</span><span class="p">,</span> <span class="mf">10.65</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.40</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">0.44</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.83</span><span class="p">,</span> <span class="mf">2.24</span><span class="p">,</span> <span class="o">-</span><span class="mf">21.59</span><span class="p">,</span> <span class="mf">2.43</span><span class="p">,</span> <span class="mf">13.19</span><span class="p">,</span> <span class="o">-</span><span class="mf">83.21</span><span class="p">,</span> <span class="mf">55.58</span><span class="p">,</span> <span class="mf">5.39</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.46</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.91</span><span class="p">,</span> <span class="mf">10.19</span><span class="p">,</span> <span class="mf">9.09</span><span class="p">,</span> <span class="mf">5.28</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.67</span><span class="p">,</span>
              <span class="mf">2.11</span><span class="p">,</span> <span class="mf">16.57</span><span class="p">,</span> <span class="mf">0.30</span><span class="p">,</span> <span class="mf">5.16</span><span class="p">,</span> <span class="mf">1.27</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.52</span><span class="p">,</span> <span class="o">-</span><span class="mf">30.21</span><span class="p">,</span> <span class="o">-</span><span class="mf">22.64</span><span class="p">,</span> <span class="mf">2.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.17</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.14</span><span class="p">,</span> <span class="o">-</span><span class="mf">21.80</span><span class="p">,</span> <span class="o">-</span><span class="mf">48.71</span><span class="p">,</span> <span class="mf">11.00</span><span class="p">,</span> <span class="mf">6.05</span><span class="p">,</span>
              <span class="mf">1.40</span><span class="p">,</span> <span class="mf">26.99</span><span class="p">,</span> <span class="mf">9.05</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.49</span><span class="p">,</span> <span class="mf">3.77</span><span class="p">,</span> <span class="mf">21.33</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">6.29</span><span class="p">,</span> <span class="mf">6.87</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.65</span><span class="p">,</span> <span class="mf">8.96</span><span class="p">,</span> <span class="o">-</span><span class="mf">24.37</span><span class="p">,</span> <span class="mf">21.51</span><span class="p">,</span> <span class="o">-</span><span class="mf">30.98</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.83</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.42</span><span class="p">,</span> <span class="mf">2.45</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.38</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.63</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.27</span><span class="p">,</span> <span class="mf">17.42</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">1.23</span><span class="p">,</span> <span class="o">-</span><span class="mf">18.83</span><span class="p">,</span> <span class="mf">12.34</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.12</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.60</span><span class="p">,</span> <span class="mf">9.39</span><span class="p">,</span> <span class="mf">5.37</span><span class="p">,</span> <span class="mf">30.05</span><span class="p">,</span> <span class="mf">7.51</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.11</span><span class="p">,</span> <span class="mf">7.46</span><span class="p">,</span> <span class="mf">6.99</span><span class="p">,</span> <span class="mf">52.23</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.08</span><span class="p">,</span> <span class="mf">8.12</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">0.34</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.18</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.19</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.57</span><span class="p">,</span> <span class="mf">10.43</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.97</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">6.38</span><span class="p">,</span> <span class="mf">4.36</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.57</span><span class="p">,</span> <span class="o">-</span><span class="mf">51.73</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.87</span><span class="p">,</span> <span class="o">-</span><span class="mf">69.90</span><span class="p">,</span> <span class="mf">102.77</span><span class="p">,</span> <span class="mf">179.12</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.40</span><span class="p">,</span> <span class="mf">9.62</span><span class="p">,</span> <span class="mf">60.26</span><span class="p">,</span> <span class="mf">9.77</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.29</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.71</span><span class="p">,</span>
              <span class="mf">56.67</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.54</span><span class="p">,</span> <span class="o">-</span><span class="mf">24.69</span><span class="p">,</span> <span class="mf">16.01</span><span class="p">,</span> <span class="mf">31.81</span><span class="p">,</span> <span class="o">-</span><span class="mf">44.19</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.09</span><span class="p">,</span> <span class="mf">148.29</span><span class="p">,</span> <span class="mf">111.51</span><span class="p">,</span> <span class="mf">105.11</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.68</span><span class="p">,</span> <span class="mf">69.81</span><span class="p">,</span> <span class="mf">52.26</span><span class="p">,</span> <span class="mf">111.33</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">13.36</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.01</span><span class="p">,</span> <span class="mf">49.66</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.66</span><span class="p">,</span> <span class="o">-</span><span class="mf">60.82</span><span class="p">,</span> <span class="o">-</span><span class="mf">25.51</span><span class="p">,</span> <span class="o">-</span><span class="mf">44.59</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.41</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table_v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[[</span><span class="o">-</span><span class="mf">27.59</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.46</span><span class="p">,</span> <span class="mf">19.20</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">40.02</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">13.65</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.32</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span>
              <span class="mf">0.00</span><span class="p">,</span> <span class="mf">19.06</span><span class="p">,</span> <span class="mf">4.30</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.09</span><span class="p">,</span> <span class="o">-</span><span class="mf">36.86</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span>
              <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">14.16</span><span class="p">,</span> <span class="mf">8.44</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.12</span><span class="p">,</span> <span class="mf">25.92</span><span class="p">,</span> <span class="o">-</span><span class="mf">47.71</span><span class="p">,</span> <span class="mf">15.36</span><span class="p">,</span> <span class="o">-</span><span class="mf">138.82</span><span class="p">,</span> <span class="mf">103.69</span><span class="p">,</span> <span class="mf">2.61</span><span class="p">,</span> <span class="mf">2.16</span><span class="p">,</span> <span class="mf">10.82</span><span class="p">,</span> <span class="mf">8.90</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.14</span><span class="p">,</span> <span class="o">-</span><span class="mf">15.81</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">6.02</span><span class="p">,</span> <span class="mf">2.97</span><span class="p">,</span> <span class="mf">17.79</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.70</span><span class="p">,</span> <span class="mf">42.09</span><span class="p">,</span> <span class="o">-</span><span class="mf">27.74</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">2.81</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">72.96</span><span class="p">,</span>
              <span class="mf">98.39</span><span class="p">,</span> <span class="o">-</span><span class="mf">18.80</span><span class="p">,</span> <span class="o">-</span><span class="mf">74.92</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.34</span><span class="p">,</span> <span class="o">-</span><span class="mf">75.38</span><span class="p">,</span> <span class="mf">13.14</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.47</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">10.17</span><span class="p">,</span> <span class="mf">1.49</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.77</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.57</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.41</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.01</span><span class="p">,</span> <span class="mf">56.76</span><span class="p">,</span> <span class="mf">46.69</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.30</span><span class="p">,</span> <span class="mf">1.81</span><span class="p">,</span> <span class="o">-</span><span class="mf">24.04</span><span class="p">,</span> <span class="mf">12.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.07</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.73</span><span class="p">,</span> <span class="mf">19.18</span><span class="p">,</span>
              <span class="mf">0.77</span><span class="p">,</span> <span class="o">-</span><span class="mf">35.24</span><span class="p">,</span> <span class="mf">15.35</span><span class="p">,</span> <span class="mf">1.49</span><span class="p">,</span> <span class="o">-</span><span class="mf">21.10</span><span class="p">,</span> <span class="mf">6.32</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.08</span><span class="p">,</span> <span class="mf">57.68</span><span class="p">,</span> <span class="o">-</span><span class="mf">48.21</span><span class="p">,</span> <span class="mf">9.70</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.41</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.49</span><span class="p">,</span> <span class="mf">27.94</span><span class="p">,</span> <span class="o">-</span><span class="mf">64.83</span><span class="p">,</span> <span class="mf">52.29</span><span class="p">,</span>
              <span class="mf">12.53</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">8.12</span><span class="p">,</span> <span class="o">-</span><span class="mf">41.86</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.52</span><span class="p">,</span> <span class="mf">25.61</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.69</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">13.97</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.45</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.52</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.99</span><span class="p">,</span> <span class="mf">27.91</span><span class="p">,</span> <span class="o">-</span><span class="mf">16.45</span><span class="p">,</span> <span class="mf">113.51</span><span class="p">,</span> <span class="o">-</span><span class="mf">28.24</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.04</span><span class="p">,</span> <span class="mf">1.38</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.18</span><span class="p">,</span> <span class="mf">6.03</span><span class="p">,</span> <span class="mf">5.56</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.58</span><span class="p">,</span> <span class="mf">12.39</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">1.34</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.08</span><span class="p">,</span> <span class="mf">15.94</span><span class="p">,</span> <span class="o">-</span><span class="mf">22.60</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.46</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="o">-</span><span class="mf">30.83</span><span class="p">,</span> <span class="mf">11.72</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.29</span><span class="p">,</span> <span class="mf">39.73</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.39</span><span class="p">,</span> <span class="mf">5.86</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.40</span><span class="p">,</span> <span class="mf">7.96</span><span class="p">,</span> <span class="mf">5.73</span><span class="p">,</span>
              <span class="mf">4.15</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">8.41</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.54</span><span class="p">,</span> <span class="mf">32.27</span><span class="p">,</span> <span class="mf">16.43</span><span class="p">,</span> <span class="mf">12.21</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">17.56</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.33</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.44</span><span class="p">,</span> <span class="mf">2.30</span><span class="p">,</span> <span class="mf">21.08</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.99</span><span class="p">,</span> <span class="mf">148.84</span><span class="p">,</span> <span class="mf">60.35</span><span class="p">,</span> <span class="mf">11.00</span><span class="p">,</span> <span class="mf">3.47</span><span class="p">,</span> <span class="mf">38.23</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.64</span><span class="p">,</span> <span class="mf">8.09</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.32</span><span class="p">,</span> <span class="mf">5.69</span><span class="p">,</span>
              <span class="mf">2.86</span><span class="p">,</span> <span class="mf">29.79</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.78</span><span class="p">,</span> <span class="o">-</span><span class="mf">28.44</span><span class="p">,</span> <span class="mf">24.30</span><span class="p">,</span> <span class="mf">3.37</span><span class="p">,</span> <span class="mf">11.15</span><span class="p">,</span> <span class="mf">14.29</span><span class="p">,</span> <span class="mf">40.54</span><span class="p">,</span> <span class="mf">63.43</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.51</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.82</span><span class="p">,</span> <span class="o">-</span><span class="mf">35.42</span><span class="p">,</span> <span class="mf">81.68</span><span class="p">,</span> <span class="o">-</span><span class="mf">32.15</span><span class="p">,</span>
              <span class="mf">12.02</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">42.27</span><span class="p">,</span> <span class="mf">15.64</span><span class="p">,</span> <span class="mf">62.84</span><span class="p">,</span> <span class="o">-</span><span class="mf">34.37</span><span class="p">,</span> <span class="o">-</span><span class="mf">18.90</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">23.89</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.12</span><span class="p">,</span> <span class="o">-</span><span class="mf">24.48</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.53</span><span class="p">,</span> <span class="mf">81.36</span><span class="p">,</span> <span class="o">-</span><span class="mf">87.26</span><span class="p">,</span> <span class="mf">308.24</span><span class="p">,</span> <span class="mf">15.90</span><span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">5.54</span><span class="p">,</span> <span class="o">-</span><span class="mf">22.06</span><span class="p">,</span> <span class="mf">4.88</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.16</span><span class="p">,</span>
              <span class="mf">18.48</span><span class="p">,</span> <span class="mf">6.38</span><span class="p">,</span> <span class="mf">83.56</span><span class="p">,</span> <span class="o">-</span><span class="mf">39.83</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.27</span><span class="p">,</span> <span class="mf">36.32</span><span class="p">,</span> <span class="mf">3.23</span><span class="p">,</span> <span class="o">-</span><span class="mf">67.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">48.23</span><span class="p">,</span> <span class="mf">72.22</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.79</span><span class="p">,</span> <span class="mf">5.93</span><span class="p">,</span> <span class="o">-</span><span class="mf">40.51</span><span class="p">,</span> <span class="o">-</span><span class="mf">78.46</span><span class="p">,</span>
              <span class="mf">116.27</span><span class="p">,</span> <span class="o">-</span><span class="mf">35.47</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.24</span><span class="p">,</span> <span class="o">-</span><span class="mf">33.64</span><span class="p">,</span> <span class="mf">42.59</span><span class="p">,</span> <span class="mf">44.41</span><span class="p">,</span> <span class="o">-</span><span class="mf">27.71</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.02</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">29.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">44.32</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.97</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">51.27</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">10.24</span><span class="p">,</span> <span class="mf">2.51</span><span class="p">,</span> <span class="o">-</span><span class="mf">25.51</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">60.14</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">1.02</span><span class="p">,</span> <span class="mf">189.29</span><span class="p">,</span> <span class="o">-</span><span class="mf">51.46</span><span class="p">,</span> <span class="mf">25.99</span><span class="p">,</span> <span class="mf">17.11</span><span class="p">,</span> <span class="mf">35.87</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">83.44</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">57.28</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">57.85</span><span class="p">,</span> <span class="mf">187.73</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">42.41</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">51.21</span><span class="p">,</span> <span class="mf">211.60</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">]])</span>
        <span class="n">table_vi_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[[</span><span class="mf">3.70</span><span class="p">,</span> <span class="mf">7.34</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.40</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">18.95</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.34</span><span class="p">,</span> <span class="mf">7.58</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span>
              <span class="mf">0.00</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">56.30</span><span class="p">,</span> <span class="mf">23.01</span><span class="p">,</span> <span class="mf">116.22</span><span class="p">,</span> <span class="o">-</span><span class="mf">153.51</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span>
              <span class="mf">0.00</span><span class="p">,</span>
              <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">2.47</span><span class="p">,</span> <span class="o">-</span><span class="mf">23.49</span><span class="p">,</span> <span class="mf">12.67</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.52</span><span class="p">,</span> <span class="mf">79.23</span><span class="p">,</span> <span class="o">-</span><span class="mf">80.04</span><span class="p">,</span> <span class="mf">129.39</span><span class="p">,</span> <span class="o">-</span><span class="mf">110.57</span><span class="p">,</span> <span class="mf">5.46</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.73</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.96</span><span class="p">,</span> <span class="o">-</span><span class="mf">41.58</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.23</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">,</span>
              <span class="mf">4.78</span><span class="p">,</span> <span class="mf">11.20</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">30.45</span><span class="p">,</span> <span class="mf">72.74</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.76</span><span class="p">,</span> <span class="o">-</span><span class="mf">68.87</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.73</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">52.60</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">40.89</span><span class="p">,</span> <span class="mf">28.94</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.94</span><span class="p">,</span>
              <span class="mf">97.14</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">28.07</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.42</span><span class="p">,</span> <span class="mf">52.79</span><span class="p">,</span> <span class="mf">16.83</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">1.86</span><span class="p">,</span> <span class="mf">1.68</span><span class="p">,</span> <span class="mf">3.69</span><span class="p">,</span> <span class="mf">45.78</span><span class="p">,</span> <span class="mf">1.83</span><span class="p">,</span> <span class="o">-</span><span class="mf">26.44</span><span class="p">,</span> <span class="o">-</span><span class="mf">56.85</span><span class="p">,</span> <span class="o">-</span><span class="mf">133.33</span><span class="p">,</span> <span class="mf">11.36</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.40</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.81</span><span class="p">,</span> <span class="mf">29.32</span><span class="p">,</span> <span class="mf">61.90</span><span class="p">,</span> <span class="mf">46.61</span><span class="p">,</span> <span class="o">-</span><span class="mf">90.89</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">14.99</span><span class="p">,</span>
              <span class="mf">13.60</span><span class="p">,</span> <span class="mf">29.52</span><span class="p">,</span> <span class="mf">28.84</span><span class="p">,</span> <span class="o">-</span><span class="mf">49.73</span><span class="p">,</span> <span class="o">-</span><span class="mf">52.93</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.21</span><span class="p">,</span> <span class="o">-</span><span class="mf">32.86</span><span class="p">,</span> <span class="o">-</span><span class="mf">24.66</span><span class="p">,</span> <span class="mf">30.99</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.45</span><span class="p">,</span> <span class="mf">8.72</span><span class="p">,</span> <span class="o">-</span><span class="mf">112.81</span><span class="p">,</span> <span class="mf">3.99</span><span class="p">,</span> <span class="mf">9.23</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">6.12</span><span class="p">,</span> <span class="mf">89.70</span><span class="p">,</span>
              <span class="mf">27.76</span><span class="p">,</span> <span class="o">-</span><span class="mf">37.32</span><span class="p">,</span> <span class="mf">43.89</span><span class="p">,</span> <span class="mf">114.16</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">2.47</span><span class="p">,</span> <span class="mf">3.78</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.71</span><span class="p">,</span> <span class="o">-</span><span class="mf">58.04</span><span class="p">,</span> <span class="mf">13.59</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.19</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.42</span><span class="p">,</span> <span class="mf">50.04</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.62</span><span class="p">,</span> <span class="mf">7.93</span><span class="p">,</span> <span class="mf">4.70</span><span class="p">,</span> <span class="mf">13.68</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.86</span><span class="p">,</span> <span class="o">-</span><span class="mf">18.29</span><span class="p">,</span> <span class="mf">17.67</span><span class="p">,</span>
              <span class="mf">7.15</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">24.54</span><span class="p">,</span> <span class="mf">2.09</span><span class="p">,</span> <span class="mf">3.56</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.92</span><span class="p">,</span> <span class="mf">5.43</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.88</span><span class="p">,</span> <span class="mf">34.90</span><span class="p">,</span> <span class="mf">1.03</span><span class="p">,</span> <span class="mf">4.62</span><span class="p">,</span> <span class="mf">9.05</span><span class="p">,</span> <span class="mf">3.72</span><span class="p">,</span> <span class="mf">54.06</span><span class="p">,</span> <span class="o">-</span><span class="mf">18.37</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.37</span><span class="p">,</span> <span class="mf">16.18</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">30.99</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">38.71</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.53</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.51</span><span class="p">,</span> <span class="o">-</span><span class="mf">27.20</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">3.43</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.11</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.73</span><span class="p">,</span> <span class="o">-</span><span class="mf">134.84</span><span class="p">,</span> <span class="mf">30.92</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.66</span><span class="p">,</span> <span class="o">-</span><span class="mf">148.64</span><span class="p">,</span> <span class="mf">517.96</span><span class="p">,</span> <span class="o">-</span><span class="mf">27.22</span><span class="p">,</span> <span class="mf">13.60</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.47</span><span class="p">,</span> <span class="o">-</span><span class="mf">21.77</span><span class="p">,</span> <span class="o">-</span><span class="mf">75.31</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">68.09</span><span class="p">,</span>
              <span class="mf">100.51</span><span class="p">,</span> <span class="mf">22.38</span><span class="p">,</span> <span class="o">-</span><span class="mf">57.11</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.12</span><span class="p">,</span> <span class="o">-</span><span class="mf">37.31</span><span class="p">,</span> <span class="mf">34.58</span><span class="p">,</span> <span class="mf">65.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">27.75</span><span class="p">,</span> <span class="mf">78.78</span><span class="p">,</span> <span class="mf">11.79</span><span class="p">,</span> <span class="o">-</span><span class="mf">51.20</span><span class="p">,</span> <span class="mf">5.80</span><span class="p">,</span> <span class="mf">1.63</span><span class="p">,</span> <span class="mf">155.31</span><span class="p">,</span>
              <span class="mf">43.95</span><span class="p">,</span>
              <span class="mf">11.03</span><span class="p">,</span> <span class="mf">16.62</span><span class="p">,</span> <span class="o">-</span><span class="mf">50.66</span><span class="p">,</span> <span class="o">-</span><span class="mf">55.94</span><span class="p">,</span> <span class="mf">54.04</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.60</span><span class="p">,</span> <span class="o">-</span><span class="mf">133.30</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">3.09</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.09</span><span class="p">,</span> <span class="mf">7.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">144.66</span><span class="p">,</span> <span class="mf">19.66</span><span class="p">,</span> <span class="mf">48.07</span><span class="p">,</span> <span class="o">-</span><span class="mf">310.26</span><span class="p">,</span> <span class="mf">444.11</span><span class="p">,</span> <span class="o">-</span><span class="mf">35.73</span><span class="p">,</span> <span class="mf">15.86</span><span class="p">,</span> <span class="o">-</span><span class="mf">32.32</span><span class="p">,</span> <span class="o">-</span><span class="mf">34.43</span><span class="p">,</span> <span class="o">-</span><span class="mf">82.60</span><span class="p">,</span> <span class="o">-</span><span class="mf">46.64</span><span class="p">,</span>
              <span class="mf">145.35</span><span class="p">,</span>
              <span class="mf">19.47</span><span class="p">,</span> <span class="o">-</span><span class="mf">93.90</span><span class="p">,</span> <span class="o">-</span><span class="mf">23.78</span><span class="p">,</span> <span class="o">-</span><span class="mf">39.03</span><span class="p">,</span> <span class="mf">75.72</span><span class="p">,</span> <span class="mf">87.70</span><span class="p">,</span> <span class="o">-</span><span class="mf">91.66</span><span class="p">,</span> <span class="mf">6.24</span><span class="p">,</span> <span class="o">-</span><span class="mf">24.29</span><span class="p">,</span> <span class="o">-</span><span class="mf">101.39</span><span class="p">,</span> <span class="o">-</span><span class="mf">38.76</span><span class="p">,</span> <span class="mf">42.76</span><span class="p">,</span> <span class="mf">144.63</span><span class="p">,</span> <span class="o">-</span><span class="mf">41.88</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">57.54</span><span class="p">,</span>
              <span class="mf">25.73</span><span class="p">,</span> <span class="o">-</span><span class="mf">67.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">78.03</span><span class="p">,</span> <span class="mf">26.98</span><span class="p">,</span> <span class="o">-</span><span class="mf">27.94</span><span class="p">,</span> <span class="o">-</span><span class="mf">135.23</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">0.79</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.46</span><span class="p">,</span> <span class="mf">10.52</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">145.06</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">16.11</span><span class="p">,</span> <span class="mf">9.31</span><span class="p">,</span> <span class="mf">21.79</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">55.93</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">35.58</span><span class="p">,</span>
              <span class="mf">46.63</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">42.10</span><span class="p">,</span> <span class="mf">17.53</span><span class="p">,</span> <span class="mf">6.62</span><span class="p">,</span> <span class="mf">24.43</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">11.27</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">27.01</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">58.70</span><span class="p">,</span> <span class="mf">118.17</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">40.40</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span>
              <span class="mf">0.00</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">10.95</span><span class="p">,</span> <span class="mf">253.16</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">]])</span>
        <span class="n">table_vi_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[[</span><span class="mf">1.22</span><span class="p">,</span> <span class="mf">3.17</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.48</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">26.42</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.00</span><span class="p">,</span> <span class="mf">3.40</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">40.64</span><span class="p">,</span>
              <span class="mf">21.42</span><span class="p">,</span> <span class="mf">110.97</span><span class="p">,</span> <span class="o">-</span><span class="mf">134.11</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span>
              <span class="mf">0.00</span><span class="p">,</span>
              <span class="mf">0.00</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">3.65</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.44</span><span class="p">,</span> <span class="mf">11.92</span><span class="p">,</span> <span class="mf">16.82</span><span class="p">,</span> <span class="mf">29.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">24.89</span><span class="p">,</span> <span class="o">-</span><span class="mf">65.02</span><span class="p">,</span> <span class="o">-</span><span class="mf">61.09</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.28</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.79</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.73</span><span class="p">,</span> <span class="o">-</span><span class="mf">35.24</span><span class="p">,</span> <span class="o">-</span><span class="mf">23.90</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.10</span><span class="p">,</span>
              <span class="mf">26.77</span><span class="p">,</span>
              <span class="mf">16.09</span><span class="p">,</span> <span class="o">-</span><span class="mf">37.30</span><span class="p">,</span> <span class="mf">52.12</span><span class="p">,</span> <span class="o">-</span><span class="mf">32.66</span><span class="p">,</span> <span class="o">-</span><span class="mf">36.49</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.04</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">40.74</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.65</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.73</span><span class="p">,</span>
              <span class="mf">7.83</span><span class="p">,</span>
              <span class="mf">79.16</span><span class="p">,</span> <span class="o">-</span><span class="mf">33.59</span><span class="p">,</span> <span class="mf">34.85</span><span class="p">,</span> <span class="mf">29.77</span><span class="p">,</span> <span class="mf">38.85</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">2.37</span><span class="p">,</span> <span class="mf">1.37</span><span class="p">,</span> <span class="mf">5.55</span><span class="p">,</span> <span class="mf">31.26</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.71</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.74</span><span class="p">,</span> <span class="o">-</span><span class="mf">98.78</span><span class="p">,</span> <span class="o">-</span><span class="mf">90.94</span><span class="p">,</span> <span class="mf">9.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.02</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.05</span><span class="p">,</span> <span class="mf">30.51</span><span class="p">,</span> <span class="mf">42.28</span><span class="p">,</span> <span class="mf">43.55</span><span class="p">,</span> <span class="o">-</span><span class="mf">77.65</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">10.81</span><span class="p">,</span>
              <span class="mf">9.24</span><span class="p">,</span> <span class="mf">24.29</span><span class="p">,</span> <span class="mf">25.96</span><span class="p">,</span> <span class="o">-</span><span class="mf">37.40</span><span class="p">,</span> <span class="o">-</span><span class="mf">45.04</span><span class="p">,</span> <span class="o">-</span><span class="mf">15.31</span><span class="p">,</span> <span class="o">-</span><span class="mf">35.61</span><span class="p">,</span> <span class="o">-</span><span class="mf">27.28</span><span class="p">,</span> <span class="mf">32.81</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.58</span><span class="p">,</span> <span class="mf">3.39</span><span class="p">,</span> <span class="o">-</span><span class="mf">82.89</span><span class="p">,</span> <span class="mf">0.48</span><span class="p">,</span> <span class="o">-</span><span class="mf">15.65</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">9.92</span><span class="p">,</span>
              <span class="mf">82.58</span><span class="p">,</span> <span class="mf">27.01</span><span class="p">,</span> <span class="o">-</span><span class="mf">37.25</span><span class="p">,</span> <span class="mf">28.51</span><span class="p">,</span> <span class="mf">93.89</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">2.62</span><span class="p">,</span> <span class="mf">2.62</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.35</span><span class="p">,</span> <span class="o">-</span><span class="mf">26.27</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.08</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.55</span><span class="p">,</span> <span class="o">-</span><span class="mf">21.59</span><span class="p">,</span> <span class="mf">38.34</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.66</span><span class="p">,</span> <span class="mf">6.10</span><span class="p">,</span> <span class="mf">5.80</span><span class="p">,</span> <span class="mf">5.86</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.11</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.30</span><span class="p">,</span> <span class="mf">11.22</span><span class="p">,</span>
              <span class="mf">2.55</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">23.27</span><span class="p">,</span> <span class="mf">2.35</span><span class="p">,</span> <span class="mf">4.99</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.28</span><span class="p">,</span> <span class="mf">2.02</span><span class="p">,</span> <span class="mf">15.41</span><span class="p">,</span> <span class="mf">16.35</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mf">7.86</span><span class="p">,</span> <span class="mf">15.43</span><span class="p">,</span> <span class="mf">14.65</span><span class="p">,</span> <span class="mf">44.36</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.26</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.14</span><span class="p">,</span> <span class="mf">15.08</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">16.82</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">35.62</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.91</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.88</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">4.47</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.10</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.34</span><span class="p">,</span> <span class="o">-</span><span class="mf">60.59</span><span class="p">,</span> <span class="mf">21.60</span><span class="p">,</span> <span class="o">-</span><span class="mf">50.63</span><span class="p">,</span> <span class="mf">73.99</span><span class="p">,</span> <span class="mf">266.55</span><span class="p">,</span> <span class="o">-</span><span class="mf">23.97</span><span class="p">,</span> <span class="mf">7.71</span><span class="p">,</span> <span class="mf">11.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">25.82</span><span class="p">,</span> <span class="o">-</span><span class="mf">58.50</span><span class="p">,</span> <span class="o">-</span><span class="mf">60.97</span><span class="p">,</span>
              <span class="mf">54.51</span><span class="p">,</span>
              <span class="mf">18.98</span><span class="p">,</span> <span class="o">-</span><span class="mf">57.94</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.73</span><span class="p">,</span> <span class="o">-</span><span class="mf">27.44</span><span class="p">,</span> <span class="mf">8.84</span><span class="p">,</span> <span class="mf">36.34</span><span class="p">,</span> <span class="mf">45.05</span><span class="p">,</span> <span class="mf">66.24</span><span class="p">,</span> <span class="mf">22.95</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.47</span><span class="p">,</span> <span class="mf">24.57</span><span class="p">,</span> <span class="mf">12.79</span><span class="p">,</span> <span class="mf">134.04</span><span class="p">,</span> <span class="o">-</span><span class="mf">60.13</span><span class="p">,</span>
              <span class="mf">20.79</span><span class="p">,</span> <span class="mf">9.30</span><span class="p">,</span>
              <span class="mf">19.56</span><span class="p">,</span> <span class="o">-</span><span class="mf">40.64</span><span class="p">,</span> <span class="mf">41.64</span><span class="p">,</span> <span class="mf">16.14</span><span class="p">,</span> <span class="o">-</span><span class="mf">82.56</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">4.41</span><span class="p">,</span> <span class="mf">0.79</span><span class="p">,</span> <span class="mf">4.23</span><span class="p">,</span> <span class="o">-</span><span class="mf">78.79</span><span class="p">,</span> <span class="mf">29.71</span><span class="p">,</span> <span class="o">-</span><span class="mf">18.07</span><span class="p">,</span> <span class="o">-</span><span class="mf">88.84</span><span class="p">,</span> <span class="mf">177.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">30.07</span><span class="p">,</span> <span class="mf">8.90</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.57</span><span class="p">,</span> <span class="o">-</span><span class="mf">35.86</span><span class="p">,</span> <span class="o">-</span><span class="mf">47.12</span><span class="p">,</span> <span class="o">-</span><span class="mf">41.78</span><span class="p">,</span>
              <span class="mf">92.39</span><span class="p">,</span>
              <span class="mf">9.40</span><span class="p">,</span> <span class="o">-</span><span class="mf">84.83</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.98</span><span class="p">,</span> <span class="o">-</span><span class="mf">29.21</span><span class="p">,</span> <span class="mf">41.15</span><span class="p">,</span> <span class="mf">53.58</span><span class="p">,</span> <span class="o">-</span><span class="mf">46.19</span><span class="p">,</span> <span class="mf">1.65</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.08</span><span class="p">,</span> <span class="o">-</span><span class="mf">62.92</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.51</span><span class="p">,</span> <span class="mf">52.01</span><span class="p">,</span> <span class="mf">103.78</span><span class="p">,</span> <span class="o">-</span><span class="mf">56.46</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">30.57</span><span class="p">,</span>
              <span class="mf">14.24</span><span class="p">,</span> <span class="mf">0.54</span><span class="p">,</span> <span class="o">-</span><span class="mf">55.15</span><span class="p">,</span> <span class="mf">15.97</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.06</span><span class="p">,</span> <span class="o">-</span><span class="mf">73.93</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">1.94</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.77</span><span class="p">,</span> <span class="mf">1.59</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">48.83</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.78</span><span class="p">,</span> <span class="mf">4.99</span><span class="p">,</span> <span class="mf">7.99</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">25.90</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">28.87</span><span class="p">,</span>
              <span class="mf">18.83</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">35.89</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.04</span><span class="p">,</span> <span class="mf">1.35</span><span class="p">,</span> <span class="mf">8.25</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">26.79</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.62</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">25.88</span><span class="p">,</span> <span class="mf">37.24</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">7.52</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span>
              <span class="mf">3.23</span><span class="p">,</span>
              <span class="mf">140.03</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">]])</span>
        <span class="n">table_vi_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[[</span><span class="o">-</span><span class="mf">1.04</span><span class="p">,</span> <span class="mf">1.68</span><span class="p">,</span> <span class="mf">8.40</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">54.75</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.24</span><span class="p">,</span> <span class="mf">1.85</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">34.67</span><span class="p">,</span>
              <span class="mf">15.08</span><span class="p">,</span> <span class="mf">90.30</span><span class="p">,</span> <span class="o">-</span><span class="mf">94.68</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span>
              <span class="mf">0.00</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">4.01</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.40</span><span class="p">,</span> <span class="mf">8.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">15.22</span><span class="p">,</span> <span class="mf">32.16</span><span class="p">,</span> <span class="o">-</span><span class="mf">22.01</span><span class="p">,</span> <span class="mf">67.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">63.85</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.07</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.67</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.12</span><span class="p">,</span> <span class="o">-</span><span class="mf">21.02</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.50</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.67</span><span class="p">,</span>
              <span class="mf">3.70</span><span class="p">,</span>
              <span class="mf">11.84</span><span class="p">,</span> <span class="o">-</span><span class="mf">34.77</span><span class="p">,</span> <span class="mf">43.27</span><span class="p">,</span> <span class="o">-</span><span class="mf">27.72</span><span class="p">,</span> <span class="o">-</span><span class="mf">25.73</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.51</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">84.30</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">28.94</span><span class="p">,</span> <span class="mf">8.84</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">5.87</span><span class="p">,</span>
              <span class="mf">94.57</span><span class="p">,</span> <span class="o">-</span><span class="mf">18.78</span><span class="p">,</span> <span class="mf">25.00</span><span class="p">,</span> <span class="mf">22.52</span><span class="p">,</span> <span class="mf">15.45</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">2.59</span><span class="p">,</span> <span class="mf">0.82</span><span class="p">,</span> <span class="mf">5.49</span><span class="p">,</span> <span class="mf">15.47</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.11</span><span class="p">,</span> <span class="mf">11.27</span><span class="p">,</span> <span class="o">-</span><span class="mf">98.32</span><span class="p">,</span> <span class="o">-</span><span class="mf">73.38</span><span class="p">,</span> <span class="mf">7.45</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.65</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.09</span><span class="p">,</span> <span class="mf">26.33</span><span class="p">,</span> <span class="mf">23.21</span><span class="p">,</span> <span class="mf">33.87</span><span class="p">,</span> <span class="o">-</span><span class="mf">56.95</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">7.34</span><span class="p">,</span>
              <span class="mf">9.51</span><span class="p">,</span> <span class="mf">12.71</span><span class="p">,</span> <span class="mf">19.30</span><span class="p">,</span> <span class="o">-</span><span class="mf">22.37</span><span class="p">,</span> <span class="o">-</span><span class="mf">28.63</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.09</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.47</span><span class="p">,</span> <span class="o">-</span><span class="mf">24.30</span><span class="p">,</span> <span class="mf">21.20</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.30</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.59</span><span class="p">,</span> <span class="o">-</span><span class="mf">46.18</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.50</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.79</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">12.63</span><span class="p">,</span>
              <span class="mf">56.22</span><span class="p">,</span> <span class="mf">24.01</span><span class="p">,</span> <span class="o">-</span><span class="mf">31.07</span><span class="p">,</span> <span class="mf">15.73</span><span class="p">,</span> <span class="mf">59.52</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">2.49</span><span class="p">,</span> <span class="mf">3.27</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.56</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.91</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.47</span><span class="p">,</span> <span class="o">-</span><span class="mf">37.55</span><span class="p">,</span> <span class="mf">15.96</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.22</span><span class="p">,</span> <span class="mf">5.41</span><span class="p">,</span> <span class="mf">1.40</span><span class="p">,</span> <span class="mf">3.39</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.76</span><span class="p">,</span> <span class="mf">16.79</span><span class="p">,</span>
              <span class="mf">2.45</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">22.56</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.88</span><span class="p">,</span> <span class="mf">4.08</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.00</span><span class="p">,</span> <span class="mf">6.53</span><span class="p">,</span> <span class="mf">19.66</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.33</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.10</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.69</span><span class="p">,</span> <span class="mf">15.67</span><span class="p">,</span> <span class="mf">14.39</span><span class="p">,</span> <span class="mf">47.14</span><span class="p">,</span> <span class="o">-</span><span class="mf">25.94</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.10</span><span class="p">,</span> <span class="mf">12.37</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">20.01</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">33.64</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.05</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.36</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.12</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">4.71</span><span class="p">,</span> <span class="mf">2.65</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.26</span><span class="p">,</span> <span class="o">-</span><span class="mf">16.55</span><span class="p">,</span> <span class="mf">4.78</span><span class="p">,</span> <span class="o">-</span><span class="mf">40.41</span><span class="p">,</span> <span class="mf">78.35</span><span class="p">,</span> <span class="mf">127.54</span><span class="p">,</span> <span class="o">-</span><span class="mf">21.48</span><span class="p">,</span> <span class="mf">5.29</span><span class="p">,</span> <span class="mf">8.36</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.13</span><span class="p">,</span> <span class="o">-</span><span class="mf">46.79</span><span class="p">,</span> <span class="o">-</span><span class="mf">48.93</span><span class="p">,</span> <span class="mf">36.10</span><span class="p">,</span>
              <span class="mf">16.31</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">54.45</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.44</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.55</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.65</span><span class="p">,</span> <span class="mf">21.71</span><span class="p">,</span> <span class="mf">52.86</span><span class="p">,</span> <span class="mf">18.33</span><span class="p">,</span> <span class="mf">19.39</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.37</span><span class="p">,</span> <span class="mf">29.17</span><span class="p">,</span> <span class="mf">10.40</span><span class="p">,</span> <span class="mf">97.73</span><span class="p">,</span> <span class="o">-</span><span class="mf">62.34</span><span class="p">,</span> <span class="mf">23.46</span><span class="p">,</span> <span class="mf">7.23</span><span class="p">,</span>
              <span class="mf">38.75</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">31.31</span><span class="p">,</span> <span class="mf">33.85</span><span class="p">,</span> <span class="mf">18.51</span><span class="p">,</span> <span class="o">-</span><span class="mf">52.72</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">5.31</span><span class="p">,</span> <span class="mf">4.65</span><span class="p">,</span> <span class="mf">0.86</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.41</span><span class="p">,</span> <span class="mf">24.80</span><span class="p">,</span> <span class="o">-</span><span class="mf">60.99</span><span class="p">,</span> <span class="mf">104.97</span><span class="p">,</span> <span class="o">-</span><span class="mf">46.86</span><span class="p">,</span> <span class="o">-</span><span class="mf">21.52</span><span class="p">,</span> <span class="mf">3.11</span><span class="p">,</span> <span class="mf">3.94</span><span class="p">,</span> <span class="o">-</span><span class="mf">32.52</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.60</span><span class="p">,</span> <span class="o">-</span><span class="mf">29.83</span><span class="p">,</span>
              <span class="mf">50.35</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">71.08</span><span class="p">,</span> <span class="mf">8.36</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.51</span><span class="p">,</span> <span class="mf">10.03</span><span class="p">,</span> <span class="mf">23.89</span><span class="p">,</span> <span class="mf">14.42</span><span class="p">,</span> <span class="mf">18.42</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.09</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.42</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.62</span><span class="p">,</span> <span class="mf">55.69</span><span class="p">,</span> <span class="mf">59.63</span><span class="p">,</span> <span class="o">-</span><span class="mf">56.14</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.60</span><span class="p">,</span>
              <span class="mf">7.76</span><span class="p">,</span> <span class="mf">33.84</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">36.27</span><span class="p">,</span> <span class="mf">9.21</span><span class="p">,</span> <span class="mf">8.29</span><span class="p">,</span> <span class="o">-</span><span class="mf">22.75</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">5.70</span><span class="p">,</span> <span class="mf">13.61</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.43</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">18.04</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.63</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.95</span><span class="p">,</span> <span class="mf">15.90</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.52</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">22.72</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">30.83</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">10.62</span><span class="p">,</span> <span class="o">-</span><span class="mf">27.21</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.68</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.39</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">8.13</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">23.46</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.09</span><span class="p">,</span> <span class="o">-</span><span class="mf">30.64</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.71</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span>
              <span class="mf">0.00</span><span class="p">,</span> <span class="mf">24.65</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">23.59</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">]])</span>
        <span class="n">table_vi_4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[[</span><span class="o">-</span><span class="mf">1.64</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.22</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">55.56</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.26</span><span class="p">,</span> <span class="mf">2.52</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">24.61</span><span class="p">,</span>
              <span class="mf">2.26</span><span class="p">,</span> <span class="mf">30.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.68</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span>
              <span class="mf">0.00</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">5.07</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.84</span><span class="p">,</span> <span class="mf">2.57</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.41</span><span class="p">,</span> <span class="mf">24.45</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.72</span><span class="p">,</span> <span class="mf">121.57</span><span class="p">,</span> <span class="o">-</span><span class="mf">115.10</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.37</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.83</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.49</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.52</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.20</span><span class="p">,</span>
              <span class="mf">6.09</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">34.43</span><span class="p">,</span> <span class="mf">14.69</span><span class="p">,</span> <span class="o">-</span><span class="mf">29.04</span><span class="p">,</span> <span class="mf">7.18</span><span class="p">,</span> <span class="mf">7.44</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">52.85</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.76</span><span class="p">,</span> <span class="o">-</span><span class="mf">27.12</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.97</span><span class="p">,</span>
              <span class="mf">97.36</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">5.12</span><span class="p">,</span> <span class="mf">32.30</span><span class="p">,</span> <span class="mf">9.93</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.83</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">2.41</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.71</span><span class="p">,</span> <span class="mf">4.45</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.09</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.45</span><span class="p">,</span> <span class="mf">9.32</span><span class="p">,</span> <span class="o">-</span><span class="mf">71.18</span><span class="p">,</span> <span class="o">-</span><span class="mf">44.51</span><span class="p">,</span> <span class="mf">4.64</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.47</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.32</span><span class="p">,</span> <span class="mf">9.00</span><span class="p">,</span> <span class="mf">2.08</span><span class="p">,</span> <span class="mf">11.58</span><span class="p">,</span> <span class="o">-</span><span class="mf">28.32</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">3.78</span><span class="p">,</span>
              <span class="mf">6.60</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.76</span><span class="p">,</span> <span class="mf">8.14</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.14</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.72</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.17</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.48</span><span class="p">,</span> <span class="o">-</span><span class="mf">16.28</span><span class="p">,</span> <span class="mf">14.87</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.62</span><span class="p">,</span> <span class="mf">5.94</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.69</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.06</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.05</span><span class="p">,</span> <span class="o">-</span><span class="mf">16.56</span><span class="p">,</span>
              <span class="mf">29.94</span><span class="p">,</span>
              <span class="mf">19.28</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.86</span><span class="p">,</span> <span class="mf">8.12</span><span class="p">,</span> <span class="mf">26.20</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">2.46</span><span class="p">,</span> <span class="mf">4.05</span><span class="p">,</span> <span class="mf">1.99</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.26</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.12</span><span class="p">,</span> <span class="mf">1.67</span><span class="p">,</span> <span class="o">-</span><span class="mf">90.44</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.80</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.91</span><span class="p">,</span> <span class="mf">2.04</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.26</span><span class="p">,</span> <span class="mf">3.32</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.37</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.70</span><span class="p">,</span> <span class="mf">10.92</span><span class="p">,</span>
              <span class="mf">1.41</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">17.84</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.14</span><span class="p">,</span> <span class="mf">9.82</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.00</span><span class="p">,</span> <span class="mf">4.43</span><span class="p">,</span> <span class="mf">9.20</span><span class="p">,</span> <span class="o">-</span><span class="mf">16.29</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.91</span><span class="p">,</span> <span class="o">-</span><span class="mf">15.15</span><span class="p">,</span> <span class="mf">11.31</span><span class="p">,</span> <span class="mf">9.25</span><span class="p">,</span> <span class="mf">38.42</span><span class="p">,</span> <span class="o">-</span><span class="mf">40.22</span><span class="p">,</span> <span class="mf">21.81</span><span class="p">,</span> <span class="mf">7.49</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">12.12</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">27.67</span><span class="p">,</span> <span class="o">-</span><span class="mf">16.58</span><span class="p">,</span> <span class="mf">8.77</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.70</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">4.07</span><span class="p">,</span> <span class="mf">8.19</span><span class="p">,</span> <span class="mf">2.55</span><span class="p">,</span> <span class="mf">4.20</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.89</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.66</span><span class="p">,</span> <span class="o">-</span><span class="mf">28.79</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.91</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.96</span><span class="p">,</span> <span class="mf">1.12</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.98</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.24</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.47</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.29</span><span class="p">,</span> <span class="mf">16.60</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">1.65</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">29.55</span><span class="p">,</span> <span class="mf">10.36</span><span class="p">,</span> <span class="mf">5.10</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.37</span><span class="p">,</span> <span class="mf">0.43</span><span class="p">,</span> <span class="mf">7.91</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.67</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.19</span><span class="p">,</span> <span class="o">-</span><span class="mf">35.69</span><span class="p">,</span> <span class="mf">16.32</span><span class="p">,</span> <span class="mf">1.63</span><span class="p">,</span> <span class="mf">28.92</span><span class="p">,</span> <span class="o">-</span><span class="mf">56.62</span><span class="p">,</span> <span class="mf">46.23</span><span class="p">,</span> <span class="mf">7.59</span><span class="p">,</span>
              <span class="mf">6.42</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">19.83</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.19</span><span class="p">,</span> <span class="mf">12.36</span><span class="p">,</span> <span class="mf">1.61</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">5.42</span><span class="p">,</span> <span class="mf">7.07</span><span class="p">,</span> <span class="mf">0.41</span><span class="p">,</span> <span class="o">-</span><span class="mf">16.48</span><span class="p">,</span> <span class="mf">6.16</span><span class="p">,</span> <span class="o">-</span><span class="mf">35.36</span><span class="p">,</span> <span class="mf">20.68</span><span class="p">,</span> <span class="o">-</span><span class="mf">70.58</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.03</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">,</span> <span class="mf">6.59</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.76</span><span class="p">,</span> <span class="mf">11.29</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.58</span><span class="p">,</span> <span class="mf">30.37</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">4.28</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">49.04</span><span class="p">,</span> <span class="mf">23.52</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.68</span><span class="p">,</span> <span class="mf">10.26</span><span class="p">,</span> <span class="mf">17.34</span><span class="p">,</span> <span class="mf">57.36</span><span class="p">,</span> <span class="o">-</span><span class="mf">30.38</span><span class="p">,</span> <span class="mf">18.35</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.90</span><span class="p">,</span> <span class="mf">30.34</span><span class="p">,</span> <span class="mf">19.82</span><span class="p">,</span> <span class="o">-</span><span class="mf">34.81</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.04</span><span class="p">,</span>
              <span class="mf">9.20</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">9.61</span><span class="p">,</span> <span class="o">-</span><span class="mf">30.84</span><span class="p">,</span> <span class="mf">2.62</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.88</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.07</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">5.12</span><span class="p">,</span> <span class="mf">19.60</span><span class="p">,</span> <span class="mf">8.46</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">29.34</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">8.45</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.16</span><span class="p">,</span> <span class="mf">23.63</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.09</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.00</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">55.14</span><span class="p">,</span>
              <span class="mf">28.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">35.69</span><span class="p">,</span> <span class="mf">3.12</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">48.93</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">56.75</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.66</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.59</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">22.75</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span>
              <span class="mf">33.55</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">64.11</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">]])</span>
        <span class="n">table_vi_5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[[</span><span class="o">-</span><span class="mf">3.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.99</span><span class="p">,</span> <span class="mf">6.77</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">27.09</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.58</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.66</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span>
              <span class="mf">0.00</span><span class="p">,</span> <span class="mf">3.96</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">3.56</span><span class="p">,</span> <span class="o">-</span><span class="mf">28.10</span><span class="p">,</span> <span class="mf">28.47</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span>
              <span class="mf">0.00</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">5.07</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.83</span><span class="p">,</span> <span class="mf">6.36</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.46</span><span class="p">,</span> <span class="mf">8.00</span><span class="p">,</span> <span class="mf">20.42</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.17</span><span class="p">,</span> <span class="o">-</span><span class="mf">82.36</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.94</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.83</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">9.98</span><span class="p">,</span> <span class="mf">18.91</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.31</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.64</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">7.50</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">23.61</span><span class="p">,</span> <span class="mf">1.57</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.05</span><span class="p">,</span> <span class="mf">6.69</span><span class="p">,</span> <span class="mf">3.23</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.92</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">2.05</span><span class="p">,</span> <span class="o">-</span><span class="mf">62.76</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.84</span><span class="p">,</span> <span class="mf">97.85</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">2.13</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">1.19</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.44</span><span class="p">,</span> <span class="mf">11.61</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">1.38</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.71</span><span class="p">,</span> <span class="mf">4.60</span><span class="p">,</span> <span class="mf">5.42</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.25</span><span class="p">,</span> <span class="mf">4.04</span><span class="p">,</span> <span class="o">-</span><span class="mf">79.12</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.86</span><span class="p">,</span> <span class="mf">0.77</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.68</span><span class="p">,</span> <span class="o">-</span><span class="mf">16.01</span><span class="p">,</span> <span class="mf">9.60</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.24</span><span class="p">,</span> <span class="mf">2.47</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.53</span><span class="p">,</span> <span class="mf">4.34</span><span class="p">,</span>
              <span class="mf">3.52</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">2.95</span><span class="p">,</span> <span class="mf">6.19</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.91</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.63</span><span class="p">,</span> <span class="o">-</span><span class="mf">39.90</span><span class="p">,</span> <span class="o">-</span><span class="mf">18.90</span><span class="p">,</span> <span class="o">-</span><span class="mf">24.09</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.02</span><span class="p">,</span> <span class="o">-</span><span class="mf">15.83</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.10</span><span class="p">,</span> <span class="o">-</span><span class="mf">25.06</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.22</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.59</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.15</span><span class="p">,</span>
              <span class="mf">43.33</span><span class="p">,</span> <span class="mf">8.79</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">14.11</span><span class="p">,</span> <span class="mf">14.15</span><span class="p">,</span> <span class="mf">10.29</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">2.84</span><span class="p">,</span> <span class="mf">5.74</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.37</span><span class="p">,</span> <span class="o">-</span><span class="mf">23.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.05</span><span class="p">,</span> <span class="o">-</span><span class="mf">92.67</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.39</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.71</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.59</span><span class="p">,</span> <span class="mf">1.83</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.72</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.45</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.42</span><span class="p">,</span>
              <span class="mf">2.51</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">12.23</span><span class="p">,</span> <span class="mf">3.88</span><span class="p">,</span> <span class="mf">14.59</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.38</span><span class="p">,</span> <span class="mf">0.65</span><span class="p">,</span> <span class="mf">14.80</span><span class="p">,</span> <span class="mf">2.66</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.64</span><span class="p">,</span> <span class="o">-</span><span class="mf">16.51</span><span class="p">,</span> <span class="mf">4.07</span><span class="p">,</span> <span class="mf">4.35</span><span class="p">,</span> <span class="mf">28.55</span><span class="p">,</span> <span class="o">-</span><span class="mf">37.38</span><span class="p">,</span> <span class="mf">23.58</span><span class="p">,</span> <span class="mf">5.74</span><span class="p">,</span>
              <span class="mf">10.87</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">20.43</span><span class="p">,</span> <span class="o">-</span><span class="mf">24.01</span><span class="p">,</span> <span class="mf">3.45</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.60</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">2.78</span><span class="p">,</span> <span class="mf">8.91</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">9.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.79</span><span class="p">,</span> <span class="o">-</span><span class="mf">23.47</span><span class="p">,</span> <span class="mf">13.61</span><span class="p">,</span> <span class="o">-</span><span class="mf">116.57</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.01</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.76</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.78</span><span class="p">,</span> <span class="mf">3.36</span><span class="p">,</span> <span class="mf">9.74</span><span class="p">,</span> <span class="mf">4.99</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">7.77</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">12.54</span><span class="p">,</span> <span class="mf">19.95</span><span class="p">,</span> <span class="mf">16.09</span><span class="p">,</span> <span class="o">-</span><span class="mf">26.65</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.58</span><span class="p">,</span> <span class="mf">35.21</span><span class="p">,</span> <span class="mf">16.38</span><span class="p">,</span> <span class="mf">5.10</span><span class="p">,</span> <span class="o">-</span><span class="mf">54.63</span><span class="p">,</span> <span class="mf">16.82</span><span class="p">,</span> <span class="mf">13.98</span><span class="p">,</span> <span class="mf">31.90</span><span class="p">,</span> <span class="o">-</span><span class="mf">47.57</span><span class="p">,</span> <span class="mf">54.21</span><span class="p">,</span> <span class="mf">6.65</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">15.19</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">18.55</span><span class="p">,</span> <span class="o">-</span><span class="mf">25.52</span><span class="p">,</span> <span class="mf">9.84</span><span class="p">,</span> <span class="mf">10.36</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">2.90</span><span class="p">,</span> <span class="mf">8.99</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.86</span><span class="p">,</span> <span class="mf">9.47</span><span class="p">,</span> <span class="mf">23.37</span><span class="p">,</span> <span class="o">-</span><span class="mf">60.23</span><span class="p">,</span> <span class="mf">219.91</span><span class="p">,</span> <span class="o">-</span><span class="mf">264.53</span><span class="p">,</span> <span class="mf">3.44</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.59</span><span class="p">,</span> <span class="mf">23.14</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.94</span><span class="p">,</span> <span class="mf">14.36</span><span class="p">,</span> <span class="mf">11.03</span><span class="p">,</span> <span class="mf">14.15</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">12.63</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">20.67</span><span class="p">,</span> <span class="mf">25.73</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.74</span><span class="p">,</span> <span class="o">-</span><span class="mf">26.72</span><span class="p">,</span> <span class="mf">7.60</span><span class="p">,</span> <span class="mf">74.22</span><span class="p">,</span> <span class="mf">80.70</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.84</span><span class="p">,</span> <span class="mf">23.63</span><span class="p">,</span> <span class="mf">6.56</span><span class="p">,</span> <span class="mf">33.27</span><span class="p">,</span> <span class="mf">45.37</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.72</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.63</span><span class="p">,</span> <span class="mf">10.65</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">46.29</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">24.10</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.60</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.12</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.70</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">2.00</span><span class="p">,</span> <span class="mf">22.10</span><span class="p">,</span> <span class="mf">8.12</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">74.06</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">9.85</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.35</span><span class="p">,</span> <span class="mf">30.71</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.17</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.49</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">34.22</span><span class="p">,</span>
              <span class="mf">32.38</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.14</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.19</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">44.56</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">50.69</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">20.46</span><span class="p">,</span> <span class="mf">32.20</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">35.61</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span>
              <span class="mf">0.00</span><span class="p">,</span> <span class="mf">6.02</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">40.05</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">]])</span>
        <span class="n">table_vi_6</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[[</span><span class="mf">0.57</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.13</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.24</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">68.97</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">1.92</span><span class="p">,</span> <span class="mf">2.55</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span>
              <span class="mf">7.66</span><span class="p">,</span> <span class="mf">7.72</span><span class="p">,</span> <span class="mf">1.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">33.12</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span>
              <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">1.48</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.25</span><span class="p">,</span> <span class="mf">3.72</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.25</span><span class="p">,</span> <span class="mf">11.92</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.15</span><span class="p">,</span> <span class="mf">12.63</span><span class="p">,</span> <span class="o">-</span><span class="mf">67.21</span><span class="p">,</span> <span class="mf">1.97</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.33</span><span class="p">,</span> <span class="mf">2.84</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.78</span><span class="p">,</span> <span class="mf">15.12</span><span class="p">,</span> <span class="mf">0.80</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.26</span><span class="p">,</span>
              <span class="mf">0.62</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.72</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.22</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.19</span><span class="p">,</span> <span class="mf">14.22</span><span class="p">,</span> <span class="mf">0.31</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">51.56</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">21.93</span><span class="p">,</span> <span class="o">-</span><span class="mf">53.50</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.44</span><span class="p">,</span>
              <span class="mf">79.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.08</span><span class="p">,</span> <span class="mf">7.52</span><span class="p">,</span> <span class="mf">3.99</span><span class="p">,</span> <span class="mf">12.71</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">1.16</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.81</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.78</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.80</span><span class="p">,</span> <span class="mf">11.21</span><span class="p">,</span> <span class="o">-</span><span class="mf">22.85</span><span class="p">,</span> <span class="mf">31.88</span><span class="p">,</span> <span class="o">-</span><span class="mf">44.76</span><span class="p">,</span> <span class="mf">1.92</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.43</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.80</span><span class="p">,</span> <span class="mf">3.29</span><span class="p">,</span> <span class="mf">2.02</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.05</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.27</span><span class="p">,</span>
              <span class="mf">2.58</span><span class="p">,</span> <span class="mf">11.77</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.35</span><span class="p">,</span> <span class="mf">0.37</span><span class="p">,</span> <span class="mf">2.96</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.74</span><span class="p">,</span> <span class="mf">23.56</span><span class="p">,</span> <span class="mf">4.43</span><span class="p">,</span> <span class="mf">2.85</span><span class="p">,</span> <span class="o">-</span><span class="mf">25.37</span><span class="p">,</span> <span class="mf">7.39</span><span class="p">,</span> <span class="o">-</span><span class="mf">24.99</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.14</span><span class="p">,</span> <span class="mf">3.32</span><span class="p">,</span> <span class="mf">17.20</span><span class="p">,</span> <span class="mf">0.70</span><span class="p">,</span>
              <span class="mf">0.40</span><span class="p">,</span> <span class="mf">6.44</span><span class="p">,</span> <span class="mf">9.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.95</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.21</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">4.05</span><span class="p">,</span> <span class="mf">3.84</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.83</span><span class="p">,</span> <span class="mf">43.37</span><span class="p">,</span> <span class="mf">41.01</span><span class="p">,</span> <span class="o">-</span><span class="mf">30.81</span><span class="p">,</span> <span class="mf">242.06</span><span class="p">,</span> <span class="o">-</span><span class="mf">99.58</span><span class="p">,</span> <span class="mf">0.41</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.21</span><span class="p">,</span> <span class="mf">16.32</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.57</span><span class="p">,</span> <span class="mf">31.06</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.26</span><span class="p">,</span> <span class="mf">7.92</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">13.42</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.41</span><span class="p">,</span> <span class="mf">11.95</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.48</span><span class="p">,</span> <span class="mf">9.16</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.54</span><span class="p">,</span> <span class="mf">14.44</span><span class="p">,</span> <span class="mf">27.26</span><span class="p">,</span> <span class="mf">7.28</span><span class="p">,</span> <span class="mf">38.64</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.14</span><span class="p">,</span> <span class="mf">37.73</span><span class="p">,</span> <span class="o">-</span><span class="mf">24.67</span><span class="p">,</span> <span class="mf">35.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">31.01</span><span class="p">,</span>
              <span class="mf">17.49</span><span class="p">,</span> <span class="mf">11.73</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.40</span><span class="p">,</span> <span class="mf">16.30</span><span class="p">,</span> <span class="o">-</span><span class="mf">32.98</span><span class="p">,</span> <span class="mf">9.01</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">8.48</span><span class="p">,</span> <span class="mf">11.45</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.76</span><span class="p">,</span> <span class="mf">69.04</span><span class="p">,</span> <span class="mf">40.45</span><span class="p">,</span> <span class="o">-</span><span class="mf">25.27</span><span class="p">,</span> <span class="mf">152.09</span><span class="p">,</span> <span class="o">-</span><span class="mf">224.10</span><span class="p">,</span> <span class="mf">23.11</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.60</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.12</span><span class="p">,</span> <span class="mf">10.57</span><span class="p">,</span> <span class="mf">34.53</span><span class="p">,</span> <span class="mf">53.96</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">21.05</span><span class="p">,</span> <span class="o">-</span><span class="mf">25.25</span><span class="p">,</span> <span class="mf">56.88</span><span class="p">,</span> <span class="mf">9.86</span><span class="p">,</span> <span class="mf">13.93</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.88</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.28</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.67</span><span class="p">,</span> <span class="mf">67.90</span><span class="p">,</span> <span class="o">-</span><span class="mf">22.91</span><span class="p">,</span> <span class="mf">15.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">25.53</span><span class="p">,</span> <span class="mf">2.31</span><span class="p">,</span> <span class="o">-</span><span class="mf">30.80</span><span class="p">,</span>
              <span class="mf">93.37</span><span class="p">,</span> <span class="o">-</span><span class="mf">67.11</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.57</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.13</span><span class="p">,</span> <span class="mf">23.62</span><span class="p">,</span> <span class="o">-</span><span class="mf">24.65</span><span class="p">,</span> <span class="o">-</span><span class="mf">36.57</span><span class="p">,</span> <span class="mf">29.39</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">9.64</span><span class="p">,</span> <span class="mf">8.21</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.31</span><span class="p">,</span> <span class="mf">48.36</span><span class="p">,</span> <span class="mf">46.86</span><span class="p">,</span> <span class="mf">18.50</span><span class="p">,</span> <span class="mf">115.90</span><span class="p">,</span> <span class="o">-</span><span class="mf">68.30</span><span class="p">,</span> <span class="mf">16.02</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.98</span><span class="p">,</span> <span class="o">-</span><span class="mf">18.37</span><span class="p">,</span> <span class="mf">7.82</span><span class="p">,</span> <span class="mf">10.95</span><span class="p">,</span> <span class="mf">20.53</span><span class="p">,</span> <span class="mf">7.66</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">22.41</span><span class="p">,</span> <span class="mf">22.00</span><span class="p">,</span> <span class="mf">19.70</span><span class="p">,</span> <span class="mf">5.61</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.68</span><span class="p">,</span> <span class="o">-</span><span class="mf">79.52</span><span class="p">,</span> <span class="mf">41.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">68.32</span><span class="p">,</span> <span class="mf">103.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">26.80</span><span class="p">,</span> <span class="mf">26.87</span><span class="p">,</span> <span class="mf">21.39</span><span class="p">,</span> <span class="mf">55.56</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">66.72</span><span class="p">,</span> <span class="mf">3.56</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.06</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.87</span><span class="p">,</span> <span class="o">-</span><span class="mf">26.73</span><span class="p">,</span> <span class="o">-</span><span class="mf">45.42</span><span class="p">,</span> <span class="mf">17.86</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">6.38</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.40</span><span class="p">,</span> <span class="mf">10.60</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">45.50</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.13</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.19</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.07</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">10.60</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.96</span><span class="p">,</span>
              <span class="mf">14.92</span><span class="p">,</span> <span class="o">-</span><span class="mf">21.98</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.69</span><span class="p">,</span> <span class="mf">10.68</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">43.88</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">18.93</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">23.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">37.64</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">28.65</span><span class="p">,</span>
              <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.78</span><span class="p">,</span> <span class="o">-</span><span class="mf">23.67</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">]])</span>
        <span class="n">table_vi_7</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[[</span><span class="mf">6.13</span><span class="p">,</span> <span class="mf">8.21</span><span class="p">,</span> <span class="o">-</span><span class="mf">27.22</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">301.38</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.31</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span>
              <span class="mf">0.00</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">59.56</span><span class="p">,</span> <span class="mf">12.66</span><span class="p">,</span> <span class="mf">183.17</span><span class="p">,</span> <span class="o">-</span><span class="mf">144.23</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span>
              <span class="mf">0.00</span><span class="p">,</span>
              <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">3.28</span><span class="p">,</span> <span class="o">-</span><span class="mf">15.04</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.27</span><span class="p">,</span> <span class="o">-</span><span class="mf">56.74</span><span class="p">,</span> <span class="mf">14.15</span><span class="p">,</span> <span class="mf">64.74</span><span class="p">,</span> <span class="mf">29.51</span><span class="p">,</span> <span class="mf">201.87</span><span class="p">,</span> <span class="mf">8.79</span><span class="p">,</span> <span class="mf">1.91</span><span class="p">,</span> <span class="mf">17.85</span><span class="p">,</span> <span class="o">-</span><span class="mf">45.07</span><span class="p">,</span> <span class="mf">12.86</span><span class="p">,</span> <span class="o">-</span><span class="mf">38.36</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">30.24</span><span class="p">,</span> <span class="mf">6.90</span><span class="p">,</span>
              <span class="mf">6.71</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.31</span><span class="p">,</span> <span class="o">-</span><span class="mf">29.84</span><span class="p">,</span> <span class="mf">57.93</span><span class="p">,</span> <span class="mf">2.79</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">27.43</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">37.94</span><span class="p">,</span> <span class="mf">102.07</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.03</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">134.85</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">69.43</span><span class="p">,</span> <span class="o">-</span><span class="mf">21.05</span><span class="p">,</span> <span class="mf">158.03</span><span class="p">,</span> <span class="mf">61.37</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">1.66</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.38</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.87</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.87</span><span class="p">,</span> <span class="mf">63.07</span><span class="p">,</span> <span class="o">-</span><span class="mf">37.06</span><span class="p">,</span> <span class="mf">268.47</span><span class="p">,</span> <span class="o">-</span><span class="mf">150.70</span><span class="p">,</span> <span class="mf">7.06</span><span class="p">,</span> <span class="mf">2.04</span><span class="p">,</span> <span class="mf">16.31</span><span class="p">,</span> <span class="mf">10.33</span><span class="p">,</span> <span class="o">-</span><span class="mf">16.91</span><span class="p">,</span> <span class="mf">2.67</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">18.53</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">5.87</span><span class="p">,</span> <span class="mf">16.54</span><span class="p">,</span> <span class="o">-</span><span class="mf">37.03</span><span class="p">,</span> <span class="mf">1.55</span><span class="p">,</span> <span class="mf">37.41</span><span class="p">,</span> <span class="mf">11.86</span><span class="p">,</span> <span class="mf">56.87</span><span class="p">,</span> <span class="mf">35.98</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.77</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.69</span><span class="p">,</span> <span class="mf">17.37</span><span class="p">,</span> <span class="o">-</span><span class="mf">60.67</span><span class="p">,</span> <span class="mf">81.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">26.52</span><span class="p">,</span> <span class="mf">32.66</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">37.87</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">151.19</span><span class="p">,</span> <span class="mf">29.27</span><span class="p">,</span> <span class="o">-</span><span class="mf">15.31</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.66</span><span class="p">,</span> <span class="o">-</span><span class="mf">73.92</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">9.46</span><span class="p">,</span> <span class="mf">36.90</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.76</span><span class="p">,</span> <span class="mf">165.10</span><span class="p">,</span> <span class="mf">91.22</span><span class="p">,</span> <span class="o">-</span><span class="mf">141.02</span><span class="p">,</span> <span class="mf">436.49</span><span class="p">,</span> <span class="o">-</span><span class="mf">887.25</span><span class="p">,</span> <span class="mf">2.43</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.21</span><span class="p">,</span> <span class="o">-</span><span class="mf">23.56</span><span class="p">,</span> <span class="mf">12.97</span><span class="p">,</span> <span class="mf">66.40</span><span class="p">,</span> <span class="mf">28.36</span><span class="p">,</span>
              <span class="mf">15.12</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">12.50</span><span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">29.44</span><span class="p">,</span> <span class="o">-</span><span class="mf">31.55</span><span class="p">,</span> <span class="o">-</span><span class="mf">22.43</span><span class="p">,</span> <span class="mf">11.33</span><span class="p">,</span> <span class="o">-</span><span class="mf">89.17</span><span class="p">,</span> <span class="o">-</span><span class="mf">54.51</span><span class="p">,</span> <span class="mf">28.36</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.99</span><span class="p">,</span> <span class="mf">60.97</span><span class="p">,</span> <span class="o">-</span><span class="mf">141.60</span><span class="p">,</span> <span class="mf">105.37</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">131.42</span><span class="p">,</span>
              <span class="mf">33.14</span><span class="p">,</span> <span class="mf">137.04</span><span class="p">,</span> <span class="o">-</span><span class="mf">42.15</span><span class="p">,</span> <span class="mf">47.86</span><span class="p">,</span> <span class="mf">46.07</span><span class="p">,</span> <span class="mf">40.43</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">13.73</span><span class="p">,</span> <span class="mf">38.22</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.06</span><span class="p">,</span> <span class="mf">229.84</span><span class="p">,</span> <span class="mf">54.84</span><span class="p">,</span> <span class="o">-</span><span class="mf">142.23</span><span class="p">,</span> <span class="mf">335.42</span><span class="p">,</span> <span class="o">-</span><span class="mf">759.51</span><span class="p">,</span> <span class="mf">36.60</span><span class="p">,</span> <span class="o">-</span><span class="mf">29.55</span><span class="p">,</span> <span class="o">-</span><span class="mf">97.40</span><span class="p">,</span> <span class="mf">31.14</span><span class="p">,</span> <span class="mf">111.36</span><span class="p">,</span>
              <span class="mf">129.73</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">77.39</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.68</span><span class="p">,</span> <span class="mf">88.47</span><span class="p">,</span> <span class="mf">49.66</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.22</span><span class="p">,</span> <span class="o">-</span><span class="mf">85.53</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.83</span><span class="p">,</span> <span class="o">-</span><span class="mf">95.05</span><span class="p">,</span> <span class="mf">184.80</span><span class="p">,</span> <span class="o">-</span><span class="mf">145.77</span><span class="p">,</span> <span class="mf">91.04</span><span class="p">,</span> <span class="o">-</span><span class="mf">112.43</span><span class="p">,</span> <span class="o">-</span><span class="mf">33.31</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">218.76</span><span class="p">,</span>
              <span class="mf">322.06</span><span class="p">,</span> <span class="o">-</span><span class="mf">371.95</span><span class="p">,</span> <span class="mf">14.40</span><span class="p">,</span> <span class="mf">394.27</span><span class="p">,</span> <span class="mf">50.64</span><span class="p">,</span> <span class="mf">35.66</span><span class="p">,</span> <span class="mf">48.81</span><span class="p">,</span> <span class="mf">56.84</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">17.83</span><span class="p">,</span> <span class="mf">25.34</span><span class="p">,</span> <span class="mf">2.92</span><span class="p">,</span> <span class="mf">206.89</span><span class="p">,</span> <span class="mf">157.94</span><span class="p">,</span> <span class="o">-</span><span class="mf">83.90</span><span class="p">,</span> <span class="mf">825.13</span><span class="p">,</span> <span class="o">-</span><span class="mf">510.85</span><span class="p">,</span> <span class="mf">1.49</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.60</span><span class="p">,</span> <span class="o">-</span><span class="mf">114.67</span><span class="p">,</span> <span class="mf">18.73</span><span class="p">,</span> <span class="mf">28.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.39</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">25.45</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">29.86</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.30</span><span class="p">,</span> <span class="mf">65.14</span><span class="p">,</span> <span class="mf">5.36</span><span class="p">,</span> <span class="o">-</span><span class="mf">53.26</span><span class="p">,</span> <span class="o">-</span><span class="mf">28.29</span><span class="p">,</span> <span class="o">-</span><span class="mf">228.34</span><span class="p">,</span> <span class="mf">48.70</span><span class="p">,</span> <span class="o">-</span><span class="mf">222.84</span><span class="p">,</span> <span class="mf">226.45</span><span class="p">,</span> <span class="o">-</span><span class="mf">59.14</span><span class="p">,</span> <span class="mf">5.14</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.09</span><span class="p">,</span> <span class="mf">28.70</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">28.07</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">20.46</span><span class="p">,</span> <span class="mf">213.23</span><span class="p">,</span> <span class="mf">80.24</span><span class="p">,</span> <span class="o">-</span><span class="mf">22.57</span><span class="p">,</span> <span class="mf">39.88</span><span class="p">,</span> <span class="mf">84.53</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">5.16</span><span class="p">,</span> <span class="mf">17.61</span><span class="p">,</span> <span class="mf">47.67</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">132.35</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">29.70</span><span class="p">,</span> <span class="mf">3.56</span><span class="p">,</span> <span class="o">-</span><span class="mf">96.11</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.06</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span>
              <span class="mf">11.73</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">20.05</span><span class="p">,</span> <span class="o">-</span><span class="mf">31.08</span><span class="p">,</span> <span class="mf">4.64</span><span class="p">,</span> <span class="mf">5.13</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.92</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">122.21</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">21.94</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">45.86</span><span class="p">,</span> <span class="o">-</span><span class="mf">81.44</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">77.55</span><span class="p">,</span>
              <span class="mf">0.00</span><span class="p">,</span>
              <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">50.13</span><span class="p">,</span> <span class="o">-</span><span class="mf">78.17</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">]])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">table_vi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">table_vi_1</span><span class="p">,</span> <span class="n">table_vi_2</span><span class="p">,</span> <span class="n">table_vi_3</span><span class="p">,</span> <span class="n">table_vi_4</span><span class="p">,</span> <span class="n">table_vi_5</span><span class="p">,</span> <span class="n">table_vi_6</span><span class="p">,</span> <span class="n">table_vi_7</span><span class="p">])</span>

<div class="viewcode-block" id="Jet.calc">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.Jet.calc">[docs]</a>
    <span class="k">def</span> <span class="nf">calc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dmdt_1</span><span class="p">,</span> <span class="n">dmdt_2</span><span class="p">,</span> <span class="n">v_1</span><span class="p">,</span> <span class="n">v_2</span><span class="p">,</span> <span class="n">T_1</span><span class="p">,</span> <span class="n">T_2</span><span class="p">,</span> <span class="n">Ta</span><span class="p">,</span> <span class="n">Pa</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Jet source noise model for circular and coaxial jets based on the methods presented by Russel (J. W. Russel.</span>
<span class="sd">        &quot;An empirical Method for Predicting the mixing Noise Levels of Subsonic Circular and Coaxial Jets&quot;.</span>
<span class="sd">        NASA-CR-3786).</span>

<span class="sd">        :param float dmdt_1: Mass flow rate of inner stream or circular jet (kg/s)</span>
<span class="sd">        :param float dmdt_2: Mass flow rate of outer stream (kg/s)</span>
<span class="sd">        :param float v_1: Nozzle exit flow velocity of inner stream or circular jet (m/s)</span>
<span class="sd">        :param float v_2: Nozzle exit flow velocity of outer stream (m/s)</span>
<span class="sd">        :param float T_1: Nozzle exit flow total temperature of inner stream or circular jet (K)</span>
<span class="sd">        :param float T_2: Nozzle exit flow total temperature of outer stream (K)</span>
<span class="sd">        :param float Ta: Ambient static temperature (K)</span>
<span class="sd">        :param float Pa: Ambient pressure (Pa)</span>

<span class="sd">        :return ndarray: 2D array of Rms or effective acoustic pressure for jet component</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fband</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fband</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span>
        <span class="n">nfreq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span>
        <span class="n">nthet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nthet</span>

        <span class="n">gamma_1</span> <span class="o">=</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">gamma_gas</span>
        <span class="n">gamma_2</span> <span class="o">=</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">gamma_air</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_jet</span> <span class="o">==</span> <span class="s1">&#39;circular&#39;</span><span class="p">:</span>
            <span class="n">dmdt_2</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">v_2</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">T_2</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">dmdt_e</span> <span class="o">=</span> <span class="n">dmdt_1</span> <span class="o">+</span> <span class="n">dmdt_2</span>  <span class="c1"># equivalent mass flow</span>
        <span class="n">v_e</span> <span class="o">=</span> <span class="p">(</span><span class="n">dmdt_1</span> <span class="o">*</span> <span class="n">v_1</span> <span class="o">+</span> <span class="n">dmdt_2</span> <span class="o">*</span> <span class="n">v_2</span><span class="p">)</span> <span class="o">/</span> <span class="n">dmdt_e</span>  <span class="c1"># equivalent velocity</span>
        <span class="n">T_e</span> <span class="o">=</span> <span class="p">(</span><span class="n">dmdt_1</span> <span class="o">*</span> <span class="p">(</span><span class="n">gamma_1</span> <span class="o">/</span> <span class="p">(</span><span class="n">gamma_1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">T_1</span> <span class="o">+</span> <span class="n">dmdt_2</span> <span class="o">*</span> <span class="p">(</span><span class="n">gamma_2</span> <span class="o">/</span> <span class="p">(</span><span class="n">gamma_2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">T_2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
                <span class="n">dmdt_1</span> <span class="o">*</span> <span class="p">(</span><span class="n">gamma_1</span> <span class="o">/</span> <span class="p">(</span><span class="n">gamma_1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="n">dmdt_2</span> <span class="o">*</span> <span class="p">(</span><span class="n">gamma_2</span> <span class="o">/</span> <span class="p">(</span><span class="n">gamma_2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span>  <span class="c1"># equivalent temperature</span>
        <span class="n">gamma_e_gamma_e_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">dmdt_1</span> <span class="o">*</span> <span class="p">(</span><span class="n">gamma_1</span> <span class="o">/</span> <span class="p">(</span><span class="n">gamma_1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="n">dmdt_2</span> <span class="o">*</span> <span class="p">(</span><span class="n">gamma_2</span> <span class="o">/</span> <span class="p">(</span><span class="n">gamma_2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">/</span> <span class="p">(</span>
                <span class="n">dmdt_1</span> <span class="o">+</span> <span class="n">dmdt_2</span><span class="p">)</span>
        <span class="c1"># equivalent ratio of spec. heat</span>
        <span class="n">gamma_e</span> <span class="o">=</span> <span class="n">gamma_e_gamma_e_1</span> <span class="o">/</span> <span class="p">(</span><span class="n">gamma_e_gamma_e_1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">rho_amb</span> <span class="o">=</span> <span class="n">Pa</span> <span class="o">/</span> <span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">Risa</span> <span class="o">*</span> <span class="n">Ta</span><span class="p">)</span>
        <span class="n">c_amb</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">gamma_2</span> <span class="o">*</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">Risa</span> <span class="o">*</span> <span class="n">Ta</span><span class="p">)</span>
        <span class="n">t_amb</span> <span class="o">=</span> <span class="n">Ta</span>
        <span class="n">rho_ISA</span> <span class="o">=</span> <span class="mf">101325.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">Risa</span> <span class="o">*</span> <span class="mf">288.15</span><span class="p">)</span>
        <span class="n">c_ISA</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">gamma_2</span> <span class="o">*</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">Risa</span> <span class="o">*</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">Tisa</span><span class="p">)</span>

        <span class="n">rho_e</span> <span class="o">=</span> <span class="n">rho_amb</span> <span class="o">*</span> <span class="p">(</span><span class="n">T_e</span> <span class="o">/</span> <span class="n">t_amb</span> <span class="o">-</span> <span class="p">((</span><span class="n">gamma_e</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">v_e</span> <span class="o">/</span> <span class="n">c_amb</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">A_e</span> <span class="o">=</span> <span class="n">dmdt_e</span> <span class="o">/</span> <span class="p">(</span><span class="n">rho_e</span> <span class="o">*</span> <span class="n">v_e</span><span class="p">)</span>  <span class="c1"># equivalent jet area</span>
        <span class="n">D_e</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">A_e</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>  <span class="c1"># equivalent diameter</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_jet</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;coaxial&#39;</span><span class="p">:</span>
            <span class="c1"># turbofan case</span>
            <span class="n">x_1</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">((</span><span class="n">v_e</span> <span class="o">/</span> <span class="n">c_amb</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">x_2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">((</span><span class="n">T_e</span> <span class="o">/</span> <span class="n">t_amb</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">x_3</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">((</span><span class="n">v_2</span> <span class="o">/</span> <span class="n">v_1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">x_4</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">((</span><span class="n">T_2</span> <span class="o">/</span> <span class="n">T_1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">x_5</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">A_2</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">A_1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1</span><span class="p">)</span>
            <span class="c1"># v_2/v_1 operating range in method development is (0.02 - 2.5)</span>
            <span class="c1"># T_2/T_1 operating range in method development is (0.2 - 4.0)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">A_2</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">A_1</span> <span class="o">&lt;</span> <span class="mf">0.50</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">A_2</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">A_1</span> <span class="o">&gt;</span> <span class="mf">10.0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;A_2/A_1 is not within the valid range (0.5 - 10.0)&#39;</span><span class="p">,</span> <span class="s1">&#39;call from calcCaj&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_jet</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;circular&#39;</span><span class="p">:</span>
            <span class="c1"># jet case</span>
            <span class="n">v_e</span> <span class="o">=</span> <span class="n">v_1</span>
            <span class="n">T_e</span> <span class="o">=</span> <span class="n">T_1</span>
            <span class="n">x_1</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">((</span><span class="n">v_e</span> <span class="o">/</span> <span class="n">c_amb</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">x_2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">((</span><span class="n">T_e</span> <span class="o">/</span> <span class="n">t_amb</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">x_3</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">x_4</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">x_5</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;type_jet not known!&#39;</span><span class="p">)</span>

        <span class="c1"># v_e / c_amb operating range in method development is (0.3 - 2.0)</span>
        <span class="c1"># T_e/t_amb operating range in method development is (0.7 - 4.5)</span>

        <span class="c1"># STEP 3 - Compute Derivative Multipliers</span>
        <span class="c1"># Circular and coannular jet</span>
        <span class="n">D1</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">D2</span> <span class="o">=</span> <span class="n">x_1</span>
        <span class="n">D3</span> <span class="o">=</span> <span class="n">x_2</span>
        <span class="n">D4</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_1</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">D5</span> <span class="o">=</span> <span class="n">x_1</span> <span class="o">*</span> <span class="n">x_2</span>
        <span class="n">D6</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_2</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">D7</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_1</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x_2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">D8</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_1</span> <span class="o">*</span> <span class="n">x_2</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="c1"># Coannular jet only:</span>
        <span class="n">D9</span> <span class="o">=</span> <span class="n">x_3</span>
        <span class="n">D10</span> <span class="o">=</span> <span class="n">x_4</span>
        <span class="n">D11</span> <span class="o">=</span> <span class="n">x_1</span> <span class="o">*</span> <span class="n">x_3</span>
        <span class="n">D12</span> <span class="o">=</span> <span class="n">x_1</span> <span class="o">*</span> <span class="n">x_4</span>
        <span class="n">D13</span> <span class="o">=</span> <span class="n">x_1</span> <span class="o">*</span> <span class="n">x_5</span>
        <span class="n">D14</span> <span class="o">=</span> <span class="n">x_2</span> <span class="o">*</span> <span class="n">x_3</span>
        <span class="n">D15</span> <span class="o">=</span> <span class="n">x_2</span> <span class="o">*</span> <span class="n">x_4</span>
        <span class="n">D16</span> <span class="o">=</span> <span class="n">x_2</span> <span class="o">*</span> <span class="n">x_5</span>
        <span class="n">D17</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_3</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">D18</span> <span class="o">=</span> <span class="n">x_3</span> <span class="o">*</span> <span class="n">x_4</span>
        <span class="n">D19</span> <span class="o">=</span> <span class="n">x_3</span> <span class="o">*</span> <span class="n">x_5</span>
        <span class="n">D20</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_4</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">D21</span> <span class="o">=</span> <span class="n">x_4</span> <span class="o">*</span> <span class="n">x_5</span>
        <span class="n">D22</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_1</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x_3</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">D23</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_1</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x_5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">D24</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_1</span> <span class="o">*</span> <span class="n">x_3</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">D25</span> <span class="o">=</span> <span class="n">x_1</span> <span class="o">*</span> <span class="n">x_3</span> <span class="o">*</span> <span class="n">x_4</span>
        <span class="n">D26</span> <span class="o">=</span> <span class="n">x_1</span> <span class="o">*</span> <span class="n">x_3</span> <span class="o">*</span> <span class="n">x_5</span>
        <span class="n">D27</span> <span class="o">=</span> <span class="n">x_1</span> <span class="o">*</span> <span class="n">x_4</span> <span class="o">*</span> <span class="n">x_5</span>
        <span class="n">D28</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_1</span> <span class="o">*</span> <span class="n">x_5</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">D29</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_3</span> <span class="o">**</span> <span class="mi">3</span><span class="p">)</span> <span class="o">/</span> <span class="mi">6</span>
        <span class="n">D30</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_3</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x_4</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">D31</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_3</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x_5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">D32</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_3</span> <span class="o">*</span> <span class="n">x_4</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">D33</span> <span class="o">=</span> <span class="n">x_3</span> <span class="o">*</span> <span class="n">x_4</span> <span class="o">*</span> <span class="n">x_5</span>
        <span class="n">D34</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_3</span> <span class="o">*</span> <span class="n">x_5</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">D35</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_4</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x_5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">D36</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_4</span> <span class="o">*</span> <span class="n">x_5</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="n">DerivMultipliers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="n">D1</span><span class="p">,</span> <span class="n">D2</span><span class="p">,</span> <span class="n">D3</span><span class="p">,</span> <span class="n">D4</span><span class="p">,</span> <span class="n">D5</span><span class="p">,</span> <span class="n">D6</span><span class="p">,</span> <span class="n">D7</span><span class="p">,</span> <span class="n">D8</span><span class="p">,</span> <span class="n">D9</span><span class="p">,</span> <span class="n">D10</span><span class="p">,</span> <span class="n">D11</span><span class="p">,</span> <span class="n">D12</span><span class="p">,</span> <span class="n">D13</span><span class="p">,</span> <span class="n">D14</span><span class="p">,</span> <span class="n">D15</span><span class="p">,</span> <span class="n">D16</span><span class="p">,</span> <span class="n">D17</span><span class="p">,</span> <span class="n">D18</span><span class="p">,</span> <span class="n">D19</span><span class="p">,</span>
             <span class="n">D20</span><span class="p">,</span> <span class="n">D21</span><span class="p">,</span> <span class="n">D22</span><span class="p">,</span> <span class="n">D23</span><span class="p">,</span> <span class="n">D24</span><span class="p">,</span> <span class="n">D25</span><span class="p">,</span> <span class="n">D26</span><span class="p">,</span> <span class="n">D27</span><span class="p">,</span> <span class="n">D28</span><span class="p">,</span> <span class="n">D29</span><span class="p">,</span> <span class="n">D30</span><span class="p">,</span> <span class="n">D31</span><span class="p">,</span> <span class="n">D32</span><span class="p">,</span> <span class="n">D33</span><span class="p">,</span> <span class="n">D34</span><span class="p">,</span> <span class="n">D35</span><span class="p">,</span> <span class="n">D36</span><span class="p">])</span>

        <span class="n">OAPWL_norm</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">RSL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n_thetas</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_thetas</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_jet</span> <span class="o">==</span> <span class="s1">&#39;coaxial&#39;</span><span class="p">:</span>
            <span class="n">OAPWL_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_iv</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">DerivMultipliers</span><span class="p">)</span>
            <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_iv</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_thetas</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">DerivMultipliers</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_v</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_thetas</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">DerivMultipliers</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_thetas</span><span class="p">):</span>
                <span class="n">RSL</span><span class="p">[:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_vi</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_thetas</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">DerivMultipliers</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_jet</span> <span class="o">==</span> <span class="s1">&#39;circular&#39;</span><span class="p">:</span>
            <span class="n">OAPWL_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_iv</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span> <span class="o">*</span> <span class="n">DerivMultipliers</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">])</span>
            <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_iv</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_thetas</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">DerivMultipliers</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_v</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_thetas</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">DerivMultipliers</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_thetas</span><span class="p">):</span>
                <span class="n">RSL</span><span class="p">[:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_vi</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_thetas</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">DerivMultipliers</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;type_jet not known!&#39;</span><span class="p">)</span>

        <span class="n">A_ref</span> <span class="o">=</span> <span class="n">dmdt_e</span> <span class="o">/</span> <span class="p">(</span><span class="n">rho_amb</span> <span class="o">*</span> <span class="n">c_amb</span><span class="p">)</span>

        <span class="n">OASPL</span> <span class="o">=</span> <span class="n">OAPWL_norm</span> <span class="o">+</span> <span class="n">D</span> <span class="o">+</span> <span class="mf">20.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">((</span><span class="n">rho_amb</span> <span class="o">*</span> <span class="n">c_amb</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">rho_ISA</span> <span class="o">*</span> <span class="n">c_ISA</span> <span class="o">**</span> <span class="mf">2.0</span><span class="p">))</span> <span class="o">+</span> \
                <span class="mf">10.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">A_ref</span> <span class="o">/</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">r_const</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="mf">197.0</span>

        <span class="c1"># STEP 9 - Compute the predicted OASPL</span>

        <span class="n">OASPL_p</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">PchipInterpolator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta_c</span><span class="p">,</span> <span class="n">OASPL</span><span class="p">)(</span><span class="n">theta</span><span class="p">)</span>

        <span class="n">eta_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">((</span><span class="n">fband</span> <span class="o">*</span> <span class="n">D_e</span><span class="p">)</span> <span class="o">/</span> <span class="n">v_e</span><span class="p">)</span>

        <span class="n">RSL_p</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp2d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta_c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eta_c</span><span class="p">,</span> <span class="n">RSL</span><span class="p">)(</span><span class="n">theta</span><span class="p">,</span> <span class="n">eta_p</span><span class="p">)</span>

        <span class="c1">#  STEP 12 - Compute the norm frequency params</span>
        <span class="n">F_p</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">CubicSpline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eta_c</span><span class="p">,</span> <span class="n">F</span><span class="p">)(</span><span class="n">eta_p</span><span class="p">)</span>

        <span class="c1"># STEP 13 - Compute the norm frequency params</span>
        <span class="n">SPL_temp</span> <span class="o">=</span> <span class="n">RSL_p</span> <span class="o">+</span> <span class="n">OASPL_p</span>
        <span class="n">SPL</span> <span class="o">=</span> <span class="n">SPL_temp</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">F_p</span><span class="p">,</span> <span class="p">(</span><span class="n">nfreq</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">nthet</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">SPL</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="Combustor">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.Combustor">[docs]</a>
<span class="k">class</span> <span class="nc">Combustor</span><span class="p">(</span><span class="n">NoiseSource</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Instantiate combustor source noise prediction.</span>

<span class="sd">    :param str type_comb: Combustor type, SAC or DAC</span>
<span class="sd">    :param float Aec: Combustor exit area (ft^2)</span>
<span class="sd">    :param float De: Exhaust nozzle exit plane effective diameter (ft)</span>
<span class="sd">    :param float Dh: Exhaust nozzle exit plane hydraulic diameter (ft)</span>
<span class="sd">    :param float Lc: Combustor nominal length (ft)</span>
<span class="sd">    :param float h: Annulus height at combustor exit (ft)</span>
<span class="sd">    :param int Nfmax: Total number of DAC fuel nozzles</span>
<span class="sd">    :param ndarray theta: 1D array containing the directivity angles (deg)</span>
<span class="sd">    :param ndarray fband: 1D array containing the 1/3 octave band frequencies (Hz)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_comb</span><span class="p">,</span> <span class="n">Aec</span><span class="p">,</span> <span class="n">De</span><span class="p">,</span> <span class="n">Dh</span><span class="p">,</span> <span class="n">Lc</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">Nfmax</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">fband</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cmbtype</span> <span class="o">=</span> <span class="n">type_comb</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Aec</span> <span class="o">=</span> <span class="n">Aec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">De</span> <span class="o">=</span> <span class="n">De</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Dh</span> <span class="o">=</span> <span class="n">Dh</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Lc</span> <span class="o">=</span> <span class="n">Lc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="n">h</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Nfmax</span> <span class="o">=</span> <span class="n">Nfmax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fband</span> <span class="o">=</span> <span class="n">fband</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nthet</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fband</span><span class="p">)</span>

<div class="viewcode-block" id="Combustor.calc">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.Combustor.calc">[docs]</a>
    <span class="k">def</span> <span class="nf">calc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Nf</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">pa</span><span class="p">,</span> <span class="n">p3</span><span class="p">,</span> <span class="n">p4</span><span class="p">,</span> <span class="n">p7</span><span class="p">,</span> <span class="n">ta</span><span class="p">,</span> <span class="n">t3</span><span class="p">,</span> <span class="n">t4</span><span class="p">,</span> <span class="n">t5</span><span class="p">,</span> <span class="n">w3</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Combustor source noise model based on the method for low-emissions combustors developed by Gliebe et al.</span>
<span class="sd">        (P. Gliebe, R. Mani, H. Shin, B. Mitchell, G. Ashford, S. Salamah and S. Connel. &quot;Aeroacoustic Prediction</span>
<span class="sd">        Codes&quot;. NASA-CR-210244). Includes model for SAC (Single-Annular Combustor) and DAC (Dual-Annular Combustor).</span>

<span class="sd">        :param int Nf: Number of ignited fuel nozzles</span>
<span class="sd">        :param int/float pattern: Fuel nozzle firing pattern</span>
<span class="sd">        :param float pa: Atmospheric pressure (Pa)</span>
<span class="sd">        :param float p3: Combustor inlet pressure (Pa)</span>
<span class="sd">        :param float p4: Combustor exit pressure (Pa)</span>
<span class="sd">        :param float p7: Turbine last stage exit pressure (Pa)</span>
<span class="sd">        :param float ta: Atmospheric temperature (K)</span>
<span class="sd">        :param float t3: Combustor inlet temperature (K)</span>
<span class="sd">        :param float t4: Combustor exit temperature (K)</span>
<span class="sd">        :param float t5: Turbine last stage exit temperature (K)</span>
<span class="sd">        :param float w3: Combustor inlet flow (kg/s)</span>

<span class="sd">        :return ndarray: 2D array of Rms or effective acoustic pressure for combustor component</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">pa_psia</span> <span class="o">=</span> <span class="n">pa</span> <span class="o">*</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">pa2psia</span>
        <span class="n">p3_psia</span> <span class="o">=</span> <span class="n">p3</span> <span class="o">*</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">pa2psia</span>
        <span class="n">p4_psia</span> <span class="o">=</span> <span class="n">p4</span> <span class="o">*</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">pa2psia</span>
        <span class="n">p7_psia</span> <span class="o">=</span> <span class="n">p7</span> <span class="o">*</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">pa2psia</span>
        <span class="n">t3_fahr</span> <span class="o">=</span> <span class="mf">1.8</span> <span class="o">*</span> <span class="p">(</span><span class="n">t3</span> <span class="o">-</span> <span class="mi">273</span><span class="p">)</span> <span class="o">+</span> <span class="mf">32.0</span>
        <span class="n">t4_fahr</span> <span class="o">=</span> <span class="mf">1.8</span> <span class="o">*</span> <span class="p">(</span><span class="n">t4</span> <span class="o">-</span> <span class="mi">273</span><span class="p">)</span> <span class="o">+</span> <span class="mf">32.0</span>
        <span class="n">t5_fahr</span> <span class="o">=</span> <span class="mf">1.8</span> <span class="o">*</span> <span class="p">(</span><span class="n">t5</span> <span class="o">-</span> <span class="mi">273</span><span class="p">)</span> <span class="o">+</span> <span class="mf">32.0</span>
        <span class="n">w3_lbms</span> <span class="o">=</span> <span class="n">w3</span> <span class="o">*</span> <span class="mf">2.20462</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R0</span> <span class="o">=</span> <span class="mi">150</span>  <span class="c1"># ft</span>

        <span class="n">AA</span> <span class="o">=</span> <span class="n">PropagationEffects</span><span class="o">.</span><span class="n">atmospheric_attenuation</span><span class="p">(</span><span class="n">ta</span><span class="p">,</span> <span class="n">pa</span><span class="p">,</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">RH</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">R0</span> <span class="o">*</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">ft2m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">fband</span><span class="p">,</span> <span class="n">third_octave_band</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># dB for 150 ft - 1m</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cmbtype</span> <span class="o">==</span> <span class="s1">&#39;SAC&#39;</span><span class="p">:</span>
            <span class="n">SPL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSAC</span><span class="p">(</span><span class="n">Nf</span><span class="p">,</span> <span class="n">pa_psia</span><span class="p">,</span> <span class="n">p3_psia</span><span class="p">,</span> <span class="n">p4_psia</span><span class="p">,</span> <span class="n">p7_psia</span><span class="p">,</span>
                              <span class="n">t3_fahr</span><span class="p">,</span> <span class="n">t4_fahr</span><span class="p">,</span> <span class="n">t5_fahr</span><span class="p">,</span> <span class="n">w3_lbms</span><span class="p">,</span> <span class="n">AA</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">cmbtype</span> <span class="o">==</span> <span class="s1">&#39;DAC&#39;</span><span class="p">:</span>
            <span class="n">SPL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDAC</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">pa_psia</span><span class="p">,</span> <span class="n">p3_psia</span><span class="p">,</span> <span class="n">p4_psia</span><span class="p">,</span> <span class="n">p7_psia</span><span class="p">,</span> <span class="n">t3_fahr</span><span class="p">,</span> <span class="n">t4_fahr</span><span class="p">,</span> <span class="n">t5_fahr</span><span class="p">,</span> <span class="n">w3_lbms</span><span class="p">,</span> <span class="n">AA</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s1">&#39;combtype not recognised in calcComb&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">SPL</span><span class="p">)</span></div>


<div class="viewcode-block" id="Combustor.getSAC">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.Combustor.getSAC">[docs]</a>
    <span class="k">def</span> <span class="nf">getSAC</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Nf</span><span class="p">,</span> <span class="n">Pa</span><span class="p">,</span> <span class="n">P3</span><span class="p">,</span> <span class="n">P4</span><span class="p">,</span> <span class="n">P7</span><span class="p">,</span> <span class="n">T3</span><span class="p">,</span> <span class="n">T4</span><span class="p">,</span> <span class="n">T5</span><span class="p">,</span> <span class="n">W3</span><span class="p">,</span> <span class="n">AA</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Calculate the noise level from a Single Annular Combustor. &quot;&quot;&quot;</span>
        <span class="n">fband</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fband</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span>
        <span class="n">nfreq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span>
        <span class="n">nthet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nthet</span>

        <span class="c1"># Step 1</span>
        <span class="n">fp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">63.0</span><span class="p">,</span> <span class="mf">160.0</span><span class="p">,</span> <span class="mf">630.0</span><span class="p">])</span>
        <span class="n">ap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">150.0</span><span class="p">,</span> <span class="mf">130.0</span><span class="p">,</span> <span class="mf">130.0</span><span class="p">])</span>

        <span class="c1"># Step 2 - normalized frequency and directivity angle</span>
        <span class="n">fN</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">fband</span> <span class="o">/</span> <span class="n">fp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fband</span> <span class="o">/</span> <span class="n">fp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">fband</span> <span class="o">/</span> <span class="n">fp</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
        <span class="n">aN</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">theta</span> <span class="o">/</span> <span class="n">ap</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">theta</span> <span class="o">/</span> <span class="n">ap</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">theta</span> <span class="o">/</span> <span class="n">ap</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>

        <span class="c1"># Step 3</span>
        <span class="n">OASPLN</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">67.8</span> <span class="o">*</span> <span class="p">(</span><span class="n">aN</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mf">141.7</span> <span class="o">*</span> <span class="n">aN</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="mf">66.84</span><span class="p">,</span>
                           <span class="o">-</span><span class="mf">26.019</span> <span class="o">*</span> <span class="p">(</span><span class="n">aN</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">-</span> <span class="mf">5.2974</span> <span class="o">*</span> <span class="n">aN</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mf">93.43</span> <span class="o">*</span> <span class="n">aN</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="mf">61.75</span><span class="p">,</span>
                           <span class="o">-</span><span class="mf">156.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">aN</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:])</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mf">322.34</span> <span class="o">*</span> <span class="n">aN</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="mf">164.89</span><span class="p">])</span>

        <span class="c1"># Step 5</span>
        <span class="n">CP</span> <span class="o">=</span> <span class="p">(</span><span class="n">W3</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T3</span><span class="p">)</span> <span class="o">/</span> <span class="n">P3</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">T4</span> <span class="o">-</span> <span class="n">T3</span><span class="p">)</span> <span class="o">/</span> <span class="n">T4</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">P3</span> <span class="o">/</span> <span class="n">Pa</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Dh</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">De</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">Hcp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">76.45</span> <span class="o">+</span> <span class="mf">14.256</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">CP</span><span class="p">),</span> <span class="mf">108.5</span> <span class="o">+</span> <span class="mf">3.31</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">CP</span><span class="p">),</span> <span class="mf">106.38</span> <span class="o">+</span> <span class="mf">6.938</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">CP</span><span class="p">)])</span>

        <span class="n">OASPL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="n">nthet</span><span class="p">))</span>

        <span class="n">iptr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">theta</span> <span class="o">&gt;=</span> <span class="n">ap</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">OASPL</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">iptr1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">20.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R0</span><span class="p">)</span> <span class="o">+</span> <span class="n">Hcp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">((</span><span class="mf">30.0</span> <span class="o">/</span> <span class="n">Nf</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.225</span><span class="p">))</span>

        <span class="n">iptr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">theta</span> <span class="o">&gt;=</span> <span class="n">ap</span><span class="p">[</span><span class="mi">1</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">OASPL</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">iptr2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">20.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R0</span><span class="p">)</span> <span class="o">+</span> <span class="n">Hcp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">((</span><span class="mf">30.0</span> <span class="o">/</span> <span class="n">Nf</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.05</span><span class="p">)</span>

        <span class="n">iptr3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">theta</span> <span class="o">&gt;=</span> <span class="n">ap</span><span class="p">[</span><span class="mi">2</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">OASPL</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="n">iptr3</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">20.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R0</span><span class="p">)</span> <span class="o">+</span> <span class="n">Hcp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">((</span><span class="mf">30.0</span> <span class="o">/</span> <span class="n">Nf</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.02</span><span class="p">)</span>

        <span class="c1"># Step 4</span>
        <span class="c1"># Loss parameter</span>
        <span class="n">Fc</span> <span class="o">=</span> <span class="p">(</span><span class="n">W3</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T4</span> <span class="o">-</span> <span class="n">T3</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">P3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Aec</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Nf</span><span class="p">))</span>
        <span class="n">Ft</span> <span class="o">=</span> <span class="p">(</span><span class="n">P4</span> <span class="o">/</span> <span class="n">P7</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T5</span> <span class="o">/</span> <span class="n">T4</span><span class="p">)</span>
        <span class="n">Tl</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Ft</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lc</span> <span class="o">*</span> <span class="n">Ft</span> <span class="o">/</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">))</span>

        <span class="n">SPL_Fc</span> <span class="o">=</span> <span class="mf">20.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Fc</span><span class="p">)</span>
        <span class="n">SPL_Tl</span> <span class="o">=</span> <span class="mf">20.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Tl</span><span class="p">)</span>

        <span class="n">OASPL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">OASPLN</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span> <span class="n">OASPL</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">iptr1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.4</span> <span class="o">*</span> <span class="p">(</span><span class="n">SPL_Fc</span> <span class="o">-</span> <span class="n">SPL_Tl</span><span class="p">),</span>
                          <span class="n">OASPLN</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span> <span class="n">OASPL</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">iptr2</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="p">(</span><span class="n">SPL_Fc</span> <span class="o">-</span> <span class="n">SPL_Tl</span><span class="p">),</span>
                          <span class="n">OASPLN</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span> <span class="n">OASPL</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="n">iptr3</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="p">(</span><span class="n">SPL_Fc</span> <span class="o">-</span> <span class="n">SPL_Tl</span><span class="p">)])</span>

        <span class="c1"># Step 6</span>
        <span class="n">SPLN</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">152.70</span> <span class="o">+</span> <span class="mf">295.46</span> <span class="o">*</span> <span class="n">fN</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="mf">145.61</span> <span class="o">*</span> <span class="n">fN</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
                         <span class="o">-</span><span class="mf">170.07</span> <span class="o">+</span> <span class="mf">331.33</span> <span class="o">*</span> <span class="n">fN</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="mf">163.34</span> <span class="o">*</span> <span class="n">fN</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
                         <span class="o">-</span><span class="mf">147.50</span> <span class="o">+</span> <span class="mf">286.40</span> <span class="o">*</span> <span class="n">fN</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="mf">142.31</span> <span class="o">*</span> <span class="n">fN</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">])</span>

        <span class="n">SD</span> <span class="o">=</span> <span class="mf">20.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">ft2m</span><span class="p">))</span>  <span class="c1"># to back-propagate at the source (1 m)</span>
        <span class="n">SPL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">OASPL</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">SPLN</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">AA</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">SD</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nthet</span><span class="p">)]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nfreq</span><span class="p">)])</span>

        <span class="n">prms</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">SPL</span><span class="p">)</span>

        <span class="n">prms_total</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">prms</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">prms</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">prms</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

        <span class="n">prms_total</span><span class="p">[</span><span class="n">prms_total</span> <span class="o">&lt;</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">p0</span><span class="p">]</span> <span class="o">=</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">p0</span>

        <span class="k">return</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">prms2SPL</span><span class="p">(</span><span class="n">prms_total</span><span class="p">)</span></div>


<div class="viewcode-block" id="Combustor.getDAC">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.Combustor.getDAC">[docs]</a>
    <span class="k">def</span> <span class="nf">getDAC</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">Pa</span><span class="p">,</span> <span class="n">P3</span><span class="p">,</span> <span class="n">P4</span><span class="p">,</span> <span class="n">P7</span><span class="p">,</span> <span class="n">T3</span><span class="p">,</span> <span class="n">T4</span><span class="p">,</span> <span class="n">T5</span><span class="p">,</span> <span class="n">W3</span><span class="p">,</span> <span class="n">AA</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Calculate the noise level from a Dual Annular Combustor. &quot;&quot;&quot;</span>
        <span class="n">fband</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fband</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span>
        <span class="n">nfreq</span> <span class="o">=</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">nfreq</span>
        <span class="n">nthet</span> <span class="o">=</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">nthet</span>

        <span class="c1"># Step 1</span>
        <span class="n">ap</span> <span class="o">=</span> <span class="mf">130.0</span>
        <span class="n">fp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">160.0</span><span class="p">,</span> <span class="mf">500.0</span><span class="p">])</span>
        <span class="n">Mf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.020</span><span class="p">,</span> <span class="mf">0.180</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">pattern</span> <span class="o">==</span> <span class="mi">40</span><span class="p">:</span>
            <span class="n">Ninner</span> <span class="o">=</span> <span class="mi">20</span>
            <span class="n">Xk</span> <span class="o">=</span> <span class="mf">0.250</span>
            <span class="n">Knf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">pattern</span> <span class="o">==</span> <span class="mi">30</span><span class="p">:</span>
            <span class="n">Ninner</span> <span class="o">=</span> <span class="mi">10</span>
            <span class="n">Xk</span> <span class="o">=</span> <span class="mf">0.250</span>
            <span class="n">Knf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.98</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">pattern</span> <span class="o">==</span> <span class="mf">22.5</span><span class="p">:</span>
            <span class="n">Ninner</span> <span class="o">=</span> <span class="mi">10</span>
            <span class="n">Xk</span> <span class="o">=</span> <span class="mf">0.200</span>
            <span class="n">Knf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.98</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">pattern</span> <span class="o">==</span> <span class="mi">20</span><span class="p">:</span>
            <span class="n">Ninner</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">Xk</span> <span class="o">=</span> <span class="mf">0.000</span>
            <span class="n">Knf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">])</span>

        <span class="c1"># Step 2 - normalized frequency and directivity angle</span>
        <span class="n">fN</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">fband</span> <span class="o">/</span> <span class="n">fp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fband</span> <span class="o">/</span> <span class="n">fp</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="n">aN</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">theta</span> <span class="o">/</span> <span class="n">ap</span><span class="p">)</span>

        <span class="c1"># Step 3</span>
        <span class="n">OASPLN</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">116.95</span> <span class="o">*</span> <span class="n">aN</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mf">235.23</span> <span class="o">*</span> <span class="n">aN</span> <span class="o">-</span> <span class="mf">120.65</span><span class="p">,</span>
                           <span class="o">-</span><span class="mf">137.59</span> <span class="o">*</span> <span class="n">aN</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mf">283.40</span> <span class="o">*</span> <span class="n">aN</span> <span class="o">-</span> <span class="mf">147.73</span><span class="p">])</span>

        <span class="c1"># Step 5</span>
        <span class="n">CP</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">W3</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T3</span><span class="p">)</span> <span class="o">/</span> <span class="n">P3</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">T4</span> <span class="o">-</span> <span class="n">T3</span><span class="p">)</span> <span class="o">/</span> <span class="n">T4</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">P3</span> <span class="o">/</span> <span class="n">Pa</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Dh</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">De</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">),</span>
                       <span class="p">(</span><span class="n">W3</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T3</span><span class="p">)</span> <span class="o">/</span> <span class="n">P3</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">T4</span> <span class="o">-</span> <span class="n">T3</span><span class="p">)</span> <span class="o">/</span> <span class="n">T4</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">P3</span> <span class="o">/</span> <span class="n">Pa</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Dh</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">De</span><span class="p">)</span> <span class="o">**</span> <span class="mf">1.2</span><span class="p">)])</span>
        <span class="n">Hcp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">110.44</span> <span class="o">+</span> <span class="mf">2.6931</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">CP</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="mf">110.62</span> <span class="o">+</span> <span class="mf">2.9917</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">CP</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>

        <span class="n">OASPL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">nthet</span><span class="p">))</span>

        <span class="n">iptr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">theta</span> <span class="o">&gt;=</span> <span class="n">ap</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">OASPL</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">iptr</span><span class="p">]</span> <span class="o">=</span> <span class="n">Knf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">20.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R0</span><span class="p">)</span> <span class="o">+</span> <span class="n">Hcp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(((</span><span class="mf">20.0</span> <span class="o">+</span> <span class="n">Ninner</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nfmax</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">Xk</span><span class="p">))</span> <span class="o">*</span>
                                   <span class="p">((</span><span class="mf">30.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">20.0</span> <span class="o">+</span> <span class="n">Ninner</span><span class="p">))</span> <span class="o">**</span> <span class="n">Mf</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>  <span class="c1"># eq 227</span>
        <span class="n">OASPL</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">iptr</span><span class="p">]</span> <span class="o">=</span> <span class="n">Knf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">20.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R0</span><span class="p">)</span> <span class="o">+</span> <span class="n">Hcp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(((</span><span class="mf">20.0</span> <span class="o">+</span> <span class="n">Ninner</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nfmax</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">Xk</span><span class="p">))</span> <span class="o">*</span>
                                   <span class="p">((</span><span class="mf">30.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">20.0</span> <span class="o">+</span> <span class="n">Ninner</span><span class="p">))</span> <span class="o">**</span> <span class="n">Mf</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>  <span class="c1"># eq 227</span>

        <span class="c1"># Step 4</span>
        <span class="c1"># Loss parameter</span>
        <span class="n">Fc</span> <span class="o">=</span> <span class="p">(</span><span class="n">W3</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T4</span> <span class="o">-</span> <span class="n">T3</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">P3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Aec</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">20.0</span> <span class="o">+</span> <span class="n">Ninner</span><span class="p">)))</span>
        <span class="n">Ft</span> <span class="o">=</span> <span class="p">(</span><span class="n">P4</span> <span class="o">/</span> <span class="n">P7</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T5</span> <span class="o">/</span> <span class="n">T4</span><span class="p">)</span>
        <span class="n">Tl</span> <span class="o">=</span> <span class="p">((</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">Ft</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lc</span> <span class="o">*</span> <span class="n">Ft</span> <span class="o">/</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">))</span>

        <span class="n">SPL_Fc</span> <span class="o">=</span> <span class="mf">20.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Fc</span><span class="p">)</span>
        <span class="n">SPL_Tl</span> <span class="o">=</span> <span class="mf">20.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Tl</span><span class="p">)</span>

        <span class="n">OASPL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">OASPLN</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span> <span class="n">OASPL</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">iptr</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.45</span> <span class="o">*</span> <span class="p">(</span><span class="n">SPL_Fc</span> <span class="o">-</span> <span class="n">SPL_Tl</span><span class="p">),</span>
                          <span class="n">OASPLN</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span> <span class="n">OASPL</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">iptr</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.10</span> <span class="o">*</span> <span class="p">(</span><span class="n">SPL_Fc</span> <span class="o">-</span> <span class="n">SPL_Tl</span><span class="p">)])</span>

        <span class="c1"># STEP 6</span>
        <span class="n">SPLN</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">143.07</span> <span class="o">+</span> <span class="mf">280.04</span> <span class="o">*</span> <span class="n">fN</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="mf">143.00</span> <span class="o">*</span> <span class="n">fN</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
                         <span class="o">-</span><span class="mf">137.21</span> <span class="o">+</span> <span class="mf">268.99</span> <span class="o">*</span> <span class="n">fN</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="mf">135.81</span> <span class="o">*</span> <span class="n">fN</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">])</span>

        <span class="n">SD</span> <span class="o">=</span> <span class="mf">20.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">ft2m</span><span class="p">))</span>  <span class="c1"># to back-propagate at the source (1 m)</span>
        <span class="n">SPL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">OASPL</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">SPLN</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">AA</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">SD</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nthet</span><span class="p">)]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nfreq</span><span class="p">)])</span>

        <span class="n">prms</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">SPL</span><span class="p">)</span>
        <span class="n">prms_total</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">prms</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">prms</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

        <span class="n">prms_total</span><span class="p">[</span><span class="n">prms_total</span> <span class="o">&lt;</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">p0</span><span class="p">]</span> <span class="o">=</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">p0</span>

        <span class="k">return</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">prms2SPL</span><span class="p">(</span><span class="n">prms_total</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="Turbine">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.Turbine">[docs]</a>
<span class="k">class</span> <span class="nc">Turbine</span><span class="p">(</span><span class="n">NoiseSource</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Instantiate turbine source noise prediction.</span>

<span class="sd">    :param int N_rotors: Number of rotors</span>
<span class="sd">    :param int n_stages: Number of stages</span>
<span class="sd">    :param float SRS: Stator-rotor spacing</span>
<span class="sd">    :param ndarray theta: 1D array containing the directivity angles (deg)</span>
<span class="sd">    :param ndarray fband: 1D array containing the 1/3 octave band frequencies (Hz)</span>
<span class="sd">    :param ndarray f: 1D array containing frequencies (Hz)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N_rotors</span><span class="p">,</span> <span class="n">n_stages</span><span class="p">,</span> <span class="n">SRS</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">fband</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N_rotors</span> <span class="o">=</span> <span class="n">N_rotors</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_stages</span> <span class="o">=</span> <span class="n">n_stages</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SRS</span> <span class="o">=</span> <span class="n">SRS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fband</span> <span class="o">=</span> <span class="n">fband</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nthet</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fband</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="n">f</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">broadband_corr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">37.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">29.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">21.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">29.0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">,</span> <span class="mf">60.0</span><span class="p">,</span> <span class="mf">80.0</span><span class="p">,</span> <span class="mf">90.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mf">110.0</span><span class="p">,</span> <span class="mf">120.0</span><span class="p">,</span> <span class="mf">140.0</span><span class="p">,</span> <span class="mf">160.0</span><span class="p">,</span> <span class="mf">180.0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tone_corr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">47.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">37.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">27.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">18.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">26.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">37.0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K</span> <span class="o">=</span> <span class="o">-</span><span class="mf">10.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Vref</span> <span class="o">=</span> <span class="mf">0.305</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cref</span> <span class="o">=</span> <span class="mf">340.3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mref</span> <span class="o">=</span> <span class="mf">0.4536</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">turb_atm_abs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span>
                                      <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.20</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">])</span>

<div class="viewcode-block" id="Turbine.calc">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.Turbine.calc">[docs]</a>
    <span class="k">def</span> <span class="nf">calc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Vtr</span><span class="p">,</span> <span class="n">Texit</span><span class="p">,</span> <span class="n">xnl</span><span class="p">,</span> <span class="n">mcore</span><span class="p">,</span> <span class="n">Cax</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Turbine source noise model based on the method developed by Dunn and Peart (D. G. Dunn and N. A. Peart.</span>
<span class="sd">        &quot;Aircraft Noise Source and Contour Estimation&quot;. NASA-CR-114649).</span>

<span class="sd">        :param float Vtr: Relative tip speed of turbine last rotor</span>
<span class="sd">        :param float Texit: Exhaust temperature (K)</span>
<span class="sd">        :param float xnl: Rotational speed (rps)</span>
<span class="sd">        :param float mcore: Mass flow (kg/s)</span>
<span class="sd">        :param float Cax: Axial velocity (m/s)</span>

<span class="sd">        :return ndarray: 2D array of Rms or effective acoustic pressure for turbine component</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fband</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fband</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span>
        <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span>
        <span class="n">nfreq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span>
        <span class="n">nthet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nthet</span>

        <span class="n">t_static</span> <span class="o">=</span> <span class="n">Texit</span> <span class="o">-</span> <span class="n">Cax</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">cp_gas</span><span class="p">)</span>
        <span class="n">c_exit</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">gamma_gas</span> <span class="o">*</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">get_R</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">t_static</span><span class="p">)</span>

        <span class="n">BPF</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_rotors</span> <span class="o">*</span> <span class="n">xnl</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">/</span> <span class="mi">60</span><span class="p">),</span> <span class="n">nthet</span><span class="p">)</span>
        <span class="c1"># xnl is in rps but in NASA report, rpm is required</span>

        <span class="c1"># Broadband noise</span>

        <span class="n">F1</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">CubicSpline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">broadband_corr</span><span class="p">)(</span><span class="n">theta</span><span class="p">)</span>

        <span class="n">fac1</span> <span class="o">=</span> <span class="p">((</span><span class="n">Vtr</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cref</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Vref</span> <span class="o">*</span> <span class="n">c_exit</span><span class="p">))</span> <span class="o">**</span> <span class="mi">3</span>
        <span class="n">fac2</span> <span class="o">=</span> <span class="n">mcore</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mref</span>
        <span class="n">fac3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nthet</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">SPL_peak_b</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fac1</span> <span class="o">*</span> <span class="n">fac2</span> <span class="o">*</span> <span class="n">fac3</span><span class="p">)</span> <span class="o">+</span> <span class="n">F1</span> <span class="o">-</span> <span class="mf">10.0</span>

        <span class="n">SPL_46m_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nthet</span><span class="p">,</span> <span class="n">nfreq</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">fb</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fband</span><span class="p">):</span>
            <span class="n">SPL_46m_b</span><span class="p">[</span><span class="n">fb</span> <span class="o">/</span> <span class="n">BPF</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">SPL_peak_b</span><span class="p">[</span><span class="n">fb</span> <span class="o">/</span> <span class="n">BPF</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">10.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fb</span> <span class="o">/</span> <span class="n">BPF</span><span class="p">[</span><span class="n">fb</span> <span class="o">/</span> <span class="n">BPF</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">])</span>
            <span class="n">SPL_46m_b</span><span class="p">[</span><span class="n">fb</span> <span class="o">/</span> <span class="n">BPF</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">SPL_peak_b</span><span class="p">[</span><span class="n">fb</span> <span class="o">/</span> <span class="n">BPF</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">20.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fb</span> <span class="o">/</span> <span class="n">BPF</span><span class="p">[</span><span class="n">fb</span> <span class="o">/</span> <span class="n">BPF</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">])</span>

        <span class="c1"># Tone noise</span>

        <span class="n">F3</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">CubicSpline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tone_corr</span><span class="p">)(</span><span class="n">theta</span><span class="p">)</span>

        <span class="n">fac1</span> <span class="o">=</span> <span class="p">(</span><span class="n">Vtr</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Vref</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.6</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cref</span> <span class="o">/</span> <span class="n">c_exit</span><span class="p">)</span> <span class="o">**</span> <span class="mi">3</span>
        <span class="n">fac2</span> <span class="o">=</span> <span class="p">(</span><span class="n">mcore</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mref</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">SRS</span><span class="p">)</span>
        <span class="n">fac3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nthet</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">SPL_peak_t</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fac1</span> <span class="o">*</span> <span class="n">fac2</span> <span class="o">*</span> <span class="n">fac3</span><span class="p">)</span> <span class="o">+</span> <span class="n">F3</span> <span class="o">+</span> <span class="mf">56.0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">K</span>
        <span class="n">BPF_max</span> <span class="o">=</span> <span class="n">fband</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">BPF</span>

        <span class="n">SPL_46m_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">SPL_46m_b</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nthet</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">BPF_max</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span>
                <span class="n">iptr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">f</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">BPF</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">SPL_46m_t</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">iptr</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">SPL_46m_t</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">iptr</span><span class="p">]</span> <span class="o">=</span> <span class="n">SPL_peak_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">j</span> <span class="o">*</span> <span class="mf">10.0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">prms_temp</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">SPL_46m_t</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">iptr</span><span class="p">])</span>
                    <span class="n">prms_46m_t</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">SPL_peak_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">j</span> <span class="o">*</span> <span class="mf">10.0</span><span class="p">)</span>
                    <span class="n">prms_46m_t</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">prms_temp</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">prms_46m_t</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="n">SPL_46m_t</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">iptr</span><span class="p">]</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">prms2SPL</span><span class="p">(</span><span class="n">prms_46m_t</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">SPL_46m_t</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">iptr</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span> <span class="n">SPL_46m_t</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">iptr</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="n">prms_b</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">SPL_46m_b</span><span class="p">)</span>
        <span class="n">prms_t</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">SPL_46m_t</span><span class="p">)</span>
        <span class="n">prms_tot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">prms_b</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">prms_t</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
        <span class="n">SPL_tot</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">prms2SPL</span><span class="p">(</span><span class="n">prms_tot</span><span class="p">)</span>
        <span class="n">SPL_tot_46m</span> <span class="o">=</span> <span class="n">SPL_tot</span> <span class="o">+</span> <span class="mf">10.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_stages</span><span class="p">)</span>

        <span class="n">SPL_1m</span> <span class="o">=</span> <span class="n">SPL_tot_46m</span> <span class="o">+</span> <span class="mf">33.2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">turb_atm_abs</span><span class="p">,</span> <span class="p">(</span><span class="n">nfreq</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nthet</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">SPL_1m</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="FanCompressor">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.FanCompressor">[docs]</a>
<span class="k">class</span> <span class="nc">FanCompressor</span><span class="p">(</span><span class="n">NoiseSource</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Instantiate fan or compressor source noise prediction.</span>

<span class="sd">    :param str component: Compressor component, fan, LPC, IPC</span>
<span class="sd">    :param float MtipD: Rotor tip relative inlet Mach number at design point</span>
<span class="sd">    :param int N_rotors: Number of rotors</span>
<span class="sd">    :param int N_stators: Number of stators</span>
<span class="sd">    :param float rss: Rotor-stator spacing</span>
<span class="sd">    :param ndarray theta: 1D array containing the directivity angles (deg)</span>
<span class="sd">    :param ndarray fband: 1D array containing the 1/3 octave band frequencies (Hz)</span>
<span class="sd">    :param ndarray f: 1D array containing frequencies (Hz)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component</span><span class="p">,</span> <span class="n">MtipD</span><span class="p">,</span> <span class="n">N_rotors</span><span class="p">,</span> <span class="n">N_stators</span><span class="p">,</span> <span class="n">rss</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">fband</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">distortion</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comp</span> <span class="o">=</span> <span class="n">component</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MtrD</span> <span class="o">=</span> <span class="n">MtipD</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N_rotors</span> <span class="o">=</span> <span class="n">N_rotors</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N_stators</span> <span class="o">=</span> <span class="n">N_stators</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rss</span> <span class="o">=</span> <span class="n">rss</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fband</span> <span class="o">=</span> <span class="n">fband</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nthet</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fband</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="n">f</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f2_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="o">-</span><span class="mf">9.50</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.50</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.50</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.50</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">5.50</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.50</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.50</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.50</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.50</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">11.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.50</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.50</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTref</span> <span class="o">=</span> <span class="mf">0.5550</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mref</span> <span class="o">=</span> <span class="mf">0.4536</span>
        <span class="k">if</span> <span class="n">distortion</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">distortion</span> <span class="o">=</span> <span class="n">distortion</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">distortion</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">F3a_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="o">-</span><span class="mf">3.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.50</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.60</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.20</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.35</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.50</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.80</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.65</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">10.50</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.50</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.50</span><span class="p">,</span> <span class="o">-</span><span class="mf">16.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">21.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">23.50</span><span class="p">,</span> <span class="o">-</span><span class="mf">25.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">28.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">30.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">32.50</span><span class="p">,</span> <span class="o">-</span><span class="mf">34.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">37.00</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">39.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">41.50</span><span class="p">,</span> <span class="o">-</span><span class="mf">43.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">46.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">48.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">50.50</span><span class="p">,</span> <span class="o">-</span><span class="mf">52.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">55.00</span><span class="p">])</span>
        <span class="c1"># figure 13(a) FOR INLET (extrapolated from 100 degrees to 180)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">F3b_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="o">-</span><span class="mf">39.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">37.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">35.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">33.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">31.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">29.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">27.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">25.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">23.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">21.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">15.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.0</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">9.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.0</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">11.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">15.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">18.0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="mf">10.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">,</span> <span class="mf">60.0</span><span class="p">,</span> <span class="mf">70.0</span><span class="p">,</span> <span class="mf">80.0</span><span class="p">,</span> <span class="mf">90.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mf">110.0</span><span class="p">,</span> <span class="mf">120.0</span><span class="p">,</span> <span class="mf">130.0</span><span class="p">,</span> <span class="mf">140.0</span><span class="p">,</span> <span class="mf">150.0</span><span class="p">,</span> <span class="mf">160.0</span><span class="p">])</span>
        <span class="c1"># GE &quot;Flight Cleanup&quot; -- TCS Suppression - Table 4.3. Idea is to make sure that the installation effects in</span>
        <span class="c1"># take-off and approach are removed.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">approach_BPF</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">5.6</span><span class="p">,</span> <span class="mf">5.8</span><span class="p">,</span> <span class="mf">4.7</span><span class="p">,</span> <span class="mf">4.6</span><span class="p">,</span> <span class="mf">4.9</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">2.4</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.8</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">approach_2BPF</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">5.4</span><span class="p">,</span> <span class="mf">4.3</span><span class="p">,</span> <span class="mf">3.4</span><span class="p">,</span> <span class="mf">4.1</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">takeoff_BPF</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">4.8</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.3</span><span class="p">,</span> <span class="mf">5.3</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">,</span> <span class="mf">4.4</span><span class="p">,</span> <span class="mf">3.9</span><span class="p">,</span> <span class="mf">2.6</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">,</span> <span class="mf">2.6</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">takeoff_2BPF</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">5.8</span><span class="p">,</span> <span class="mf">3.8</span><span class="p">,</span> <span class="mf">5.3</span><span class="p">,</span> <span class="mf">6.4</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f3a_data_broad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.0</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">15.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">22.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">25.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">28.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">31.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">34.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">37.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">40.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">43.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">46.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">49.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">52.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">55.0</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">58.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">61.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">64.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">67.0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f3b_data_broad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="o">-</span><span class="mf">41.600</span><span class="p">,</span> <span class="o">-</span><span class="mf">39.450</span><span class="p">,</span> <span class="o">-</span><span class="mf">37.300</span><span class="p">,</span> <span class="o">-</span><span class="mf">35.150</span><span class="p">,</span> <span class="o">-</span><span class="mf">33.000</span><span class="p">,</span> <span class="o">-</span><span class="mf">30.850</span><span class="p">,</span> <span class="o">-</span><span class="mf">28.700</span><span class="p">,</span> <span class="o">-</span><span class="mf">26.550</span><span class="p">,</span> <span class="o">-</span><span class="mf">24.400</span><span class="p">,</span> <span class="o">-</span><span class="mf">22.250</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.100</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.950</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">15.8000</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.650</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.500</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.750</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.000</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.500</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.000</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.850</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.700</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.950</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.200</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.750</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.300</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">0.1500</span><span class="p">,</span> <span class="mf">0.000</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.000</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.000</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.000</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.000</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.000</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.000</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.500</span><span class="p">,</span> <span class="o">-</span><span class="mf">15.000</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.500</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.000</span><span class="p">])</span>

<div class="viewcode-block" id="FanCompressor.calc">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.FanCompressor.calc">[docs]</a>
    <span class="k">def</span> <span class="nf">calc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operatingPoint</span><span class="p">,</span> <span class="n">Mtip</span><span class="p">,</span> <span class="n">Mu</span><span class="p">,</span> <span class="n">dT</span><span class="p">,</span> <span class="n">xnl</span><span class="p">,</span> <span class="n">g1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fan and compressor source noise model based on the methods developed by Heidman (M. F. Heidmann. &quot;Interim</span>
<span class="sd">        Prediction Method for Fan and Compressor Source Noise&quot;. NASA-TM-X71763) and updated by Kontos et al.</span>
<span class="sd">        (K. B. Kontos, B. A. Janardan and P. R. Gliebe. &quot;Improved NASA-ANOPP Noise Prediction Computer Code for Advanced</span>
<span class="sd">        Subsonic Propulsion Systems&quot;. NASA-CR-195480).</span>

<span class="sd">        :param str operatingPoint: Approach, Cutback, Sideline</span>
<span class="sd">        :param float Mtip: Rotor tip relative inlet Mach number at operating point</span>
<span class="sd">        :param float Mu: Blade Mach number</span>
<span class="sd">        :param float dT: Temperature rise across fan or compressor stage</span>
<span class="sd">        :param float xnl: Fan rotational speed (rps)</span>
<span class="sd">        :param float g1: Mass flow rate passing through fan or compressor (kg/s)</span>

<span class="sd">        :return ndarray: 2D array of Rms or effective acoustic pressure for tone, broadband and combination tone noise</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span>
        <span class="n">fb</span> <span class="o">=</span> <span class="n">xnl</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_rotors</span>
        <span class="n">acc</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">fb</span><span class="p">))</span>

        <span class="n">delta_cutoff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Mu</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_stators</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_rotors</span><span class="p">))</span>  <span class="c1"># cut-off factor</span>

        <span class="c1"># get broadband noise</span>
        <span class="p">[</span><span class="n">prms_broadband_inlet</span><span class="p">,</span> <span class="n">prms_broadband_discharge</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fanCompr_broadband</span><span class="p">(</span><span class="n">operatingPoint</span><span class="p">,</span> <span class="n">Mtip</span><span class="p">,</span> <span class="n">fb</span><span class="p">,</span> <span class="n">dT</span><span class="p">,</span> <span class="n">g1</span><span class="p">)</span>

        <span class="c1"># get tone noise</span>
        <span class="p">[</span><span class="n">prms_tone_inlet</span><span class="p">,</span> <span class="n">prms_tone_discharge</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fanCompr_tone</span><span class="p">(</span><span class="n">operatingPoint</span><span class="p">,</span> <span class="n">acc</span><span class="p">,</span> <span class="n">Mtip</span><span class="p">,</span> <span class="n">dT</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">delta_cutoff</span><span class="p">,</span> <span class="n">fb</span><span class="p">)</span>

        <span class="c1"># get combination noise</span>
        <span class="k">if</span> <span class="n">Mtip</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">prms_inlet_combination</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fanCompr_comb_tone</span><span class="p">(</span><span class="n">Mtip</span><span class="p">,</span> <span class="n">dT</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">fb</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">prms_inlet_combination</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">prms_tone_inlet</span><span class="p">))</span>

        <span class="n">prms_inlet</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">prms_broadband_inlet</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">prms_tone_inlet</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">prms_inlet_combination</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="c1"># create outlet combination (tone + broadband)</span>
        <span class="n">prms_discharge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">prms_tone_discharge</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">prms_broadband_discharge</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">prms_tone_inlet</span><span class="p">,</span> <span class="n">prms_tone_discharge</span><span class="p">,</span> <span class="n">prms_broadband_inlet</span><span class="p">,</span> <span class="n">prms_broadband_discharge</span><span class="p">,</span>
                <span class="n">prms_inlet_combination</span><span class="p">,</span> <span class="n">prms_inlet</span><span class="p">,</span> <span class="n">prms_discharge</span><span class="p">]</span></div>


<div class="viewcode-block" id="FanCompressor.fanCompr_comb_tone">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.FanCompressor.fanCompr_comb_tone">[docs]</a>
    <span class="k">def</span> <span class="nf">fanCompr_comb_tone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Mtr</span><span class="p">,</span> <span class="n">dT</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">fb</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Fan and compressor combination tone noise estimation. &quot;&quot;&quot;</span>
        <span class="n">fband</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fband</span>
        <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span>
        <span class="n">nfreq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span>
        <span class="n">nthet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nthet</span>

        <span class="n">F1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="c1"># Creating F1 according to fig 15(a)</span>
        <span class="n">F1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.14</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">30.0</span><span class="p">,</span> <span class="mf">72.5</span><span class="p">,</span> <span class="mf">4.4</span><span class="p">]))(</span><span class="n">Mtr</span><span class="p">)</span>
        <span class="n">F1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">30.0</span><span class="p">,</span> <span class="mf">68.6</span><span class="p">,</span> <span class="mf">10.5</span><span class="p">]))(</span><span class="n">Mtr</span><span class="p">)</span>
        <span class="n">F1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.61</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">36.0</span><span class="p">,</span> <span class="mf">60.6</span><span class="p">,</span> <span class="mf">56.5</span><span class="p">]))(</span><span class="n">Mtr</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">comp</span> <span class="o">==</span> <span class="s1">&#39;Fan&#39;</span> <span class="ow">and</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">no_fan_stages</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">fan_IGV</span><span class="p">:</span>
            <span class="n">C</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.0</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">comp</span> <span class="o">==</span> <span class="s1">&#39;Fuselage_fan&#39;</span> <span class="ow">and</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">no_ff_stages</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">ff_IGV</span><span class="p">:</span>
            <span class="n">C</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">C</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="c1"># eq 8</span>
        <span class="n">Lc_combination</span> <span class="o">=</span> <span class="mf">20.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dT</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTref</span><span class="p">)</span> <span class="o">+</span> <span class="mf">10.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">g1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mref</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">f2_data</span> <span class="o">+</span> <span class="n">C</span>

        <span class="c1"># set peak</span>
        <span class="n">peak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Lc_combination</span> <span class="o">+</span> <span class="n">F1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>

        <span class="n">peakf</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span> <span class="o">-</span> <span class="mf">0.500</span> <span class="o">*</span> <span class="n">fb</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span> <span class="o">-</span> <span class="mf">0.250</span> <span class="o">*</span> <span class="n">fb</span><span class="p">)),</span>
                 <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span> <span class="o">-</span> <span class="mf">0.125</span> <span class="o">*</span> <span class="n">fb</span><span class="p">))]</span>

        <span class="c1"># Figure 14</span>
        <span class="n">F3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="n">nfreq</span><span class="p">))</span>
        <span class="n">F3</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">peakf</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">30.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">fband</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">peakf</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">/</span> <span class="n">fb</span><span class="p">)</span>
        <span class="n">F3</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">peakf</span><span class="p">[</span><span class="mi">0</span><span class="p">]:]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">30.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">fband</span><span class="p">[</span><span class="n">peakf</span><span class="p">[</span><span class="mi">0</span><span class="p">]:]</span> <span class="o">/</span> <span class="n">fb</span><span class="p">)</span>
        <span class="n">F3</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">peakf</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">50.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">fband</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">peakf</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">/</span> <span class="n">fb</span><span class="p">)</span>
        <span class="n">F3</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">peakf</span><span class="p">[</span><span class="mi">1</span><span class="p">]:]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">50.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">fband</span><span class="p">[</span><span class="n">peakf</span><span class="p">[</span><span class="mi">1</span><span class="p">]:]</span> <span class="o">/</span> <span class="n">fb</span><span class="p">)</span>
        <span class="n">F3</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">peakf</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">50.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">8.0</span> <span class="o">*</span> <span class="n">fband</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">peakf</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">/</span> <span class="n">fb</span><span class="p">)</span>
        <span class="n">F3</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="n">peakf</span><span class="p">[</span><span class="mi">2</span><span class="p">]:]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">30.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">8.0</span> <span class="o">*</span> <span class="n">fband</span><span class="p">[</span><span class="n">peakf</span><span class="p">[</span><span class="mi">2</span><span class="p">]:]</span> <span class="o">/</span> <span class="n">fb</span><span class="p">)</span>

        <span class="n">SPL_combination</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">peak</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">F3</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nthet</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nfreq</span><span class="p">)])</span>

        <span class="n">prms_combination</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">SPL_combination</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">prms_combination</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">prms_combination</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">prms_combination</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span></div>


<div class="viewcode-block" id="FanCompressor.fanCompr_tone">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.FanCompressor.fanCompr_tone">[docs]</a>
    <span class="k">def</span> <span class="nf">fanCompr_tone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operatingPoint</span><span class="p">,</span> <span class="n">acc</span><span class="p">,</span> <span class="n">Mtr</span><span class="p">,</span> <span class="n">dT</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">delta_cutoff</span><span class="p">,</span> <span class="n">fb</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Fan and compressor discrete tone noise estimation. &quot;&quot;&quot;</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span>
        <span class="n">nfreq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span>
        <span class="n">nthet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nthet</span>
        <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span>

        <span class="n">F1a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_Fig10a</span><span class="p">(</span><span class="n">Mtr</span><span class="p">)</span>  <span class="c1"># Creating F1a according to figure 10(a) FOR INLET</span>
        <span class="n">F1b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_Fig10b</span><span class="p">(</span><span class="n">Mtr</span><span class="p">)</span>  <span class="c1"># Creating F1b according to figure 10(b) FOR DISCHARGE</span>

        <span class="c1"># Creating F2a according to figure 12 FOR INLET</span>
        <span class="n">F2a</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="c1"># Creating F2b according to figure 12 FOR DISCHARGE</span>
        <span class="n">F2b</span> <span class="o">=</span> <span class="o">-</span><span class="mf">10.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rss</span> <span class="o">/</span> <span class="mf">300.0</span><span class="p">)</span>

        <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">acc</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">nk</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>

        <span class="c1"># re-interpolate GE-data onto theta angles (GE &quot;Flight Cleanup&quot; -- TCS Suppression - Table 4.3.)</span>
        <span class="k">if</span> <span class="n">operatingPoint</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Take-off&#39;</span> <span class="ow">or</span> <span class="n">operatingPoint</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Cutback&#39;</span> <span class="ow">or</span> \
                <span class="n">operatingPoint</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Sideline&#39;</span><span class="p">:</span>
            <span class="n">BPF1</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">takeoff_BPF</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">)(</span><span class="n">theta</span><span class="p">)</span>
            <span class="n">BPF2</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">takeoff_2BPF</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">)(</span><span class="n">theta</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">operatingPoint</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Approach&#39;</span><span class="p">:</span>
            <span class="n">BPF1</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">approach_BPF</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">)(</span><span class="n">theta</span><span class="p">)</span>
            <span class="n">BPF2</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">approach_2BPF</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">)(</span><span class="n">theta</span><span class="p">)</span>

        <span class="c1"># set inlet data</span>
        <span class="n">Lc_inlet</span> <span class="o">=</span> <span class="mf">20.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dT</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTref</span><span class="p">)</span> <span class="o">+</span> <span class="mf">10.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">g1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mref</span><span class="p">)</span> <span class="o">+</span> <span class="n">F1a</span> <span class="o">+</span> <span class="n">F2a</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">F3a_data</span>  <span class="c1"># eq6</span>

        <span class="n">F4a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nk</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">comp</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Fan&#39;</span><span class="p">:</span>
            <span class="n">F4a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_Fig8</span><span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">fan_IGV</span><span class="p">,</span> <span class="n">Mtr</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">delta_cutoff</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">comp</span> <span class="o">==</span> <span class="s1">&#39;fuselage_fan&#39;</span><span class="p">:</span>
            <span class="n">F4a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_Fig8</span><span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">ff_IGV</span><span class="p">,</span> <span class="n">Mtr</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">delta_cutoff</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">distortion</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">comp</span> <span class="o">==</span> <span class="s1">&#39;fuselage_fan&#39;</span><span class="p">:</span>
                <span class="n">F5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_Fig9</span><span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">no_ff_stages</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">F5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_Fig9</span><span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">no_fan_stages</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
            <span class="n">F4F5</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="mf">0.10</span> <span class="o">*</span> <span class="n">F4a</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">F5</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">F4F5</span> <span class="o">=</span> <span class="n">F4a</span>

        <span class="n">SPL_inlet</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">))</span>
        <span class="n">prms_inlet</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nthet</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">acc</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">fb</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">fb</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">fband</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">pos</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>

                <span class="k">if</span> <span class="n">pos</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="k">continue</span>

                <span class="k">if</span> <span class="n">SPL_inlet</span><span class="p">[</span><span class="n">pos</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># first tone</span>
                        <span class="n">SPL_inlet</span><span class="p">[</span><span class="n">pos</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Lc_inlet</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">F4F5</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">BPF1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># second tone</span>
                        <span class="n">SPL_inlet</span><span class="p">[</span><span class="n">pos</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Lc_inlet</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">F4F5</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">BPF2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">SPL_inlet</span><span class="p">[</span><span class="n">pos</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Lc_inlet</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">F4F5</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># coinciding tones</span>
                    <span class="n">prms_temp</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">SPL_inlet</span><span class="p">[</span><span class="n">pos</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># first tone</span>
                        <span class="n">prms_inlet</span><span class="p">[</span><span class="n">pos</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">((</span><span class="n">Lc_inlet</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">F4F5</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">BPF1</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                    <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># second tone</span>
                        <span class="n">prms_inlet</span><span class="p">[</span><span class="n">pos</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">((</span><span class="n">Lc_inlet</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">F4F5</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">BPF2</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">prms_inlet</span><span class="p">[</span><span class="n">pos</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">((</span><span class="n">Lc_inlet</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">F4F5</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>

                    <span class="n">prms_tot</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">prms_temp</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">prms_inlet</span><span class="p">[</span><span class="n">pos</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="n">SPL_inlet</span><span class="p">[</span><span class="n">pos</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">20.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">prms_tot</span> <span class="o">/</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">p0</span><span class="p">)</span>

        <span class="n">prms_inlet</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">SPL_inlet</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">comp</span> <span class="o">==</span> <span class="s1">&#39;Fan&#39;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">comp</span> <span class="o">==</span> <span class="s1">&#39;Fuselage_fan&#39;</span><span class="p">:</span>
            <span class="c1"># set discharge data</span>
            <span class="n">F4b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nk</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">comp</span> <span class="o">==</span> <span class="s1">&#39;Fan&#39;</span><span class="p">:</span>
                <span class="n">F4b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_Fig8</span><span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">fan_IGV</span><span class="p">,</span> <span class="n">Mtr</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">delta_cutoff</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">comp</span> <span class="o">==</span> <span class="s1">&#39;Fuselage_fan&#39;</span><span class="p">:</span>
                <span class="n">F4b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_Fig8</span><span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">ff_IGV</span><span class="p">,</span> <span class="n">Mtr</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">delta_cutoff</span><span class="p">)</span>

            <span class="n">Lc_discharge</span> <span class="o">=</span> <span class="mf">20.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dT</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTref</span><span class="p">)</span> <span class="o">+</span> <span class="mf">10.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">g1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mref</span><span class="p">)</span> <span class="o">+</span> <span class="n">F1b</span> <span class="o">+</span> <span class="n">F2b</span> <span class="o">+</span> \
                           <span class="bp">self</span><span class="o">.</span><span class="n">F3b_data</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_C</span><span class="p">(</span><span class="n">nthet</span><span class="p">)</span>  <span class="c1"># eq 6</span>

            <span class="n">SPL_discharge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">))</span>
            <span class="n">prms_discharge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">))</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nthet</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">acc</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">fb</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">fb</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">fband</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">pos</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
                    
                    <span class="k">if</span> <span class="n">pos</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="k">continue</span>

                    <span class="k">if</span> <span class="n">SPL_discharge</span><span class="p">[</span><span class="n">pos</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">SPL_discharge</span><span class="p">[</span><span class="n">pos</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Lc_discharge</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">F4b</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>

                    <span class="k">elif</span> <span class="n">SPL_discharge</span><span class="p">[</span><span class="n">pos</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">prms_temp</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">SPL_discharge</span><span class="p">[</span><span class="n">pos</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
                        <span class="n">prms_discharge</span><span class="p">[</span><span class="n">pos</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">((</span><span class="n">Lc_discharge</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">F4b</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
                        <span class="n">prms_tot</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">prms_temp</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">prms_discharge</span><span class="p">[</span><span class="n">pos</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
                        <span class="n">SPL_discharge</span><span class="p">[</span><span class="n">pos</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">20.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">prms_tot</span> <span class="o">/</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">p0</span><span class="p">)</span>

            <span class="n">prms_discharge</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">SPL_discharge</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">prms_discharge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">))</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">prms_inlet</span><span class="p">,</span> <span class="n">prms_discharge</span><span class="p">]</span></div>


<div class="viewcode-block" id="FanCompressor.fanCompr_broadband">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.FanCompressor.fanCompr_broadband">[docs]</a>
    <span class="k">def</span> <span class="nf">fanCompr_broadband</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operatingPoint</span><span class="p">,</span> <span class="n">Mtr</span><span class="p">,</span> <span class="n">fb</span><span class="p">,</span> <span class="n">dT</span><span class="p">,</span> <span class="n">g1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Fan and compressor broadband noise estimation. &quot;&quot;&quot;</span>
        <span class="n">fband</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fband</span>
        <span class="n">nfreq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span>
        <span class="n">nthet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nthet</span>

        <span class="n">F1a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_Fig4a</span><span class="p">(</span><span class="n">Mtr</span><span class="p">)</span>
        <span class="n">F1b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_Fig4b</span><span class="p">(</span><span class="n">Mtr</span><span class="p">)</span>

        <span class="c1"># Creating F2a according to Fig 6(a) FOR INLET</span>
        <span class="n">F2a</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="c1"># Creating F2b according to Fig 6(b) FOR DISCHARGE</span>
        <span class="n">F2b</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rss</span> <span class="o">/</span> <span class="mf">300.0</span><span class="p">)</span>

        <span class="n">Lc_inlet</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">([</span><span class="mf">20.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dT</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTref</span><span class="p">)</span> <span class="o">+</span> <span class="mf">10.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">g1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mref</span><span class="p">)</span> <span class="o">+</span> <span class="n">F1a</span> <span class="o">+</span> <span class="n">F2a</span> <span class="o">+</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">f3a_data_broad</span><span class="p">],</span> <span class="n">nfreq</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># eq 4</span>
        <span class="n">SPL_inlet</span> <span class="o">=</span> <span class="n">Lc_inlet</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_Fig3a</span><span class="p">(</span><span class="n">fband</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="n">fb</span><span class="p">)</span>  <span class="c1"># eq 5</span>
        <span class="n">prms_inlet</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">SPL_inlet</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">comp</span> <span class="o">==</span> <span class="s1">&#39;Fan&#39;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">comp</span> <span class="o">==</span> <span class="s1">&#39;Fuselage_fan&#39;</span><span class="p">:</span>

            <span class="n">Lc_discharge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">),</span> <span class="mf">20.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dT</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTref</span><span class="p">)</span> <span class="o">+</span> <span class="mf">10.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">g1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mref</span><span class="p">)</span> <span class="o">+</span>
                                   <span class="n">F1b</span> <span class="o">+</span> <span class="n">F2b</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">f3b_data_broad</span><span class="p">)</span>  <span class="c1"># eq 4</span>

            <span class="n">SPL_discharge</span> <span class="o">=</span> <span class="n">Lc_discharge</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_Fig3a</span><span class="p">(</span><span class="n">fband</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="n">fb</span><span class="p">)</span>  <span class="c1"># eq 5</span>

            <span class="n">prms_discharge</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">SPL_discharge</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">prms_discharge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">nthet</span><span class="p">))</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">prms_inlet</span><span class="p">,</span> <span class="n">prms_discharge</span><span class="p">]</span></div>


<div class="viewcode-block" id="FanCompressor.get_C">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.FanCompressor.get_C">[docs]</a>
    <span class="k">def</span> <span class="nf">get_C</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nthet</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; C coefficient from eq. 12 in Heidmann&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">fan_IGV</span> <span class="ow">or</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">no_fan_stages</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">or</span> \
                <span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">ff_IGV</span> <span class="ow">or</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">no_ff_stages</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">nthet</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nthet</span><span class="p">)</span></div>


<div class="viewcode-block" id="FanCompressor.get_Fig3a">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.FanCompressor.get_Fig3a">[docs]</a>
    <span class="k">def</span> <span class="nf">get_Fig3a</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f_over_fb</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Creating F4 according to eq. 2 in Heidmann&quot;&quot;&quot;</span>
        <span class="n">sigmae</span> <span class="o">=</span> <span class="mf">2.2</span>
        <span class="k">return</span> <span class="mf">10.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">f_over_fb</span> <span class="o">/</span> <span class="mf">2.5</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sigmae</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)))</span></div>


<div class="viewcode-block" id="FanCompressor.get_Fig4a">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.FanCompressor.get_Fig4a">[docs]</a>
    <span class="k">def</span> <span class="nf">get_Fig4a</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">M_tr</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get peak broadband sound pressure levels from Fig 4(a) for inlet duct according to Heidmann. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">MtrD</span> <span class="o">&lt;=</span> <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">M_tr</span> <span class="o">&lt;=</span> <span class="mf">0.9</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">58.5</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">MtrD</span> <span class="o">&lt;=</span> <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">M_tr</span> <span class="o">&gt;</span> <span class="mf">0.9</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">58.5</span> <span class="o">-</span> <span class="mf">20.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">M_tr</span> <span class="o">/</span> <span class="mf">0.9</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">MtrD</span> <span class="o">&gt;</span> <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">M_tr</span> <span class="o">&lt;=</span> <span class="mf">0.9</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">58.5</span> <span class="o">+</span> <span class="mf">20.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MtrD</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">MtrD</span> <span class="o">&gt;</span> <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">M_tr</span> <span class="o">&gt;</span> <span class="mf">0.9</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">58.5</span> <span class="o">+</span> <span class="mf">20.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MtrD</span><span class="p">)</span> <span class="o">-</span> <span class="mf">50.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">M_tr</span> <span class="o">/</span> <span class="mf">0.9</span><span class="p">)</span>  <span class="c1"># ANOPP update (1996 - Kontos)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;unexpected combination of tip Mach numbers in get_Fig4a in choice_physics&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mf">0.0</span></div>


<div class="viewcode-block" id="FanCompressor.get_Fig4b">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.FanCompressor.get_Fig4b">[docs]</a>
    <span class="k">def</span> <span class="nf">get_Fig4b</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">M_tr</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get peak broadband sound pressure levels from Fig 4(b) for discharge duct according to Heidmann and</span>
<span class="sd">        eq. 3a-3b in Kontos. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">MtrD</span> <span class="o">&lt;=</span> <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">M_tr</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">60.0</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">MtrD</span> <span class="o">&gt;</span> <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">M_tr</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">63.0</span> <span class="o">+</span> <span class="mf">20.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MtrD</span><span class="p">)</span>  <span class="c1"># ANOPP update (1996 - Kontos)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">MtrD</span> <span class="o">&gt;</span> <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">M_tr</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">63.0</span> <span class="o">+</span> <span class="mf">20.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MtrD</span><span class="p">)</span> <span class="o">-</span> <span class="mf">30.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">M_tr</span><span class="p">)</span>  <span class="c1"># ANOPP update (1996 - Kontos)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;unexpected combination of tip Mach numbers in get_Fig4b in choice_physics&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mf">0.0</span></div>


<div class="viewcode-block" id="FanCompressor.get_Fig8">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.FanCompressor.get_Fig8">[docs]</a>
    <span class="k">def</span> <span class="nf">get_Fig8</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">igv</span><span class="p">,</span> <span class="n">Mtr</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">delta</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get rotor-stator interaction discrete tone harmonic levels from Fig 8 in Heidmann and eq. 7a-8c in</span>
<span class="sd">        Kontos. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">igv</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Mtr</span> <span class="o">&lt;</span> <span class="mf">1.15</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">delta</span> <span class="o">&gt;</span> <span class="mf">1.05</span><span class="p">:</span>
                    <span class="n">Fig8</span> <span class="o">=</span> <span class="mf">6.0</span> <span class="o">-</span> <span class="mf">6.0</span> <span class="o">*</span> <span class="n">k</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">Fig8</span> <span class="o">=</span> <span class="mf">6.0</span> <span class="o">-</span> <span class="mf">6.0</span> <span class="o">*</span> <span class="n">k</span>
                    <span class="n">Fig8</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">8.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">delta</span> <span class="o">&gt;</span> <span class="mf">1.05</span><span class="p">:</span>
                    <span class="n">Fig8</span> <span class="o">=</span> <span class="mf">9.0</span> <span class="o">-</span> <span class="mf">9.0</span> <span class="o">*</span> <span class="n">k</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">Fig8</span> <span class="o">=</span> <span class="mf">9.0</span> <span class="o">-</span> <span class="mf">9.0</span> <span class="o">*</span> <span class="n">k</span>
                    <span class="n">Fig8</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">8.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">delta</span> <span class="o">&gt;</span> <span class="mf">1.05</span><span class="p">:</span>
                <span class="n">Fig8</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.0</span> <span class="o">-</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">k</span>
                <span class="n">Fig8</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Fig8</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.0</span> <span class="o">-</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">k</span>
                <span class="n">Fig8</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">8.0</span>
        <span class="k">return</span> <span class="n">Fig8</span></div>


<div class="viewcode-block" id="FanCompressor.get_Fig9">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.FanCompressor.get_Fig9">[docs]</a>
    <span class="k">def</span> <span class="nf">get_Fig9</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">no_fan_stages</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get inlet flow distortion discrete tone harmonic levels for inlet duct from Fig 9 in Heidmann. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">no_fan_stages</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">10.0</span> <span class="o">-</span> <span class="mf">10.0</span> <span class="o">*</span> <span class="n">k</span>
        <span class="k">elif</span> <span class="n">no_fan_stages</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">nk</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nk</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Unexpected number of stages in get_Fig9 in choice_physics&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mf">0.0</span></div>


<div class="viewcode-block" id="FanCompressor.get_Fig10a">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.FanCompressor.get_Fig10a">[docs]</a>
    <span class="k">def</span> <span class="nf">get_Fig10a</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">M_tr</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get characteristic peak sound pressure level of fundamental discrete tone for inlet duct according to</span>
<span class="sd">        Fig. 10(a) in Heidmann and eq. 5 in Kontos. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">M_tr</span> <span class="o">&lt;=</span> <span class="mf">0.72</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">MtrD</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="p">:</span>
                <span class="k">return</span> <span class="mf">60.5</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">MtrD</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
                <span class="k">return</span> <span class="mf">60.5</span> <span class="o">+</span> <span class="mf">20.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MtrD</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Kontos update</span>
            <span class="n">F1a1</span> <span class="o">=</span> <span class="mf">60.5</span> <span class="o">+</span> <span class="mf">20.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MtrD</span><span class="p">)</span> <span class="o">+</span> <span class="mf">50.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">M_tr</span> <span class="o">/</span> <span class="mf">0.72</span><span class="p">)</span>
            <span class="n">F1a2</span> <span class="o">=</span> <span class="mf">64.5</span> <span class="o">+</span> <span class="mf">80.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MtrD</span> <span class="o">/</span> <span class="n">M_tr</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">F1a1</span><span class="p">,</span> <span class="n">F1a2</span><span class="p">)</span></div>


<div class="viewcode-block" id="FanCompressor.get_Fig10b">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.FanCompressor.get_Fig10b">[docs]</a>
    <span class="k">def</span> <span class="nf">get_Fig10b</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">M_tr</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get characteristic peak sound pressure level of fundamental discrete tone for discharge duct according to</span>
<span class="sd">        Fig. 10(b) in Heidmann. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">M_tr</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">MtrD</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="p">:</span>
                <span class="k">return</span> <span class="mf">63.0</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">MtrD</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
                <span class="k">return</span> <span class="mf">63.0</span> <span class="o">+</span> <span class="mf">20.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MtrD</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">63.0</span> <span class="o">+</span> <span class="mf">20.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MtrD</span><span class="p">)</span> <span class="o">-</span> <span class="mf">20.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">M_tr</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="PropagationEffects">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.PropagationEffects">[docs]</a>
<span class="k">class</span> <span class="nc">PropagationEffects</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Instantiate noise estimation at microphone/observer.</span>

<span class="sd">    :param float ymic: Microphone height (m)</span>
<span class="sd">    :param bool use_ground_refl: True to account for ground reflection or False else</span>
<span class="sd">    :param bool spherical_spr: True to account for spherical spreading or False else</span>
<span class="sd">    :param bool atm_atten: True to account for atmospheric attenuation or False else</span>
<span class="sd">    :param ndarray fband: 1D array containing the 1/3 octave band frequencies (Hz)</span>
<span class="sd">    :param ndarray xsii: 1D array containing observation angles (rad)</span>
<span class="sd">    :param ndarray Mai: 1D array containing Mach number</span>
<span class="sd">    :param ndarray xsi_alphai: 1D array containing directivity angle accounting for angle of attack (deg)</span>
<span class="sd">    :param float dTisa: Deviation from ISA temperature (K)</span>
<span class="sd">    :param float elevation: Ground elevation at microphone location (m)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ymic</span><span class="p">,</span> <span class="n">use_ground_refl</span><span class="p">,</span> <span class="n">spherical_spr</span><span class="p">,</span> <span class="n">atm_atten</span><span class="p">,</span> <span class="n">fband</span><span class="p">,</span> <span class="n">xsii</span><span class="p">,</span> <span class="n">Mai</span><span class="p">,</span> <span class="n">xsi_alphai</span><span class="p">,</span> <span class="n">dTisa</span><span class="p">,</span> <span class="n">elevation</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ymic</span> <span class="o">=</span> <span class="n">ymic</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_ground_refl</span> <span class="o">=</span> <span class="n">use_ground_refl</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spherical_spr</span> <span class="o">=</span> <span class="n">spherical_spr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atm_atten</span> <span class="o">=</span> <span class="n">atm_atten</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Mach</span> <span class="o">=</span> <span class="n">Mai</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fband</span> <span class="o">=</span> <span class="n">fband</span>
        <span class="k">if</span> <span class="n">fband</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDopplerShift</span><span class="p">(</span><span class="n">fband</span><span class="p">,</span> <span class="n">xsii</span><span class="p">,</span> <span class="n">Mai</span><span class="p">)</span>
            <span class="c1"># calculate shifted band limits, needed for auralization</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fupper_ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDopplerShift</span><span class="p">(</span><span class="n">fband</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">6</span><span class="p">)),</span> <span class="n">xsii</span><span class="p">,</span> <span class="n">Mai</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flower_ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDopplerShift</span><span class="p">(</span><span class="n">fband</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">6</span><span class="p">)),</span> <span class="n">xsii</span><span class="p">,</span> <span class="n">Mai</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fds</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xsii_alpha</span> <span class="o">=</span> <span class="n">xsi_alphai</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N_b</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_n_freqs</span> <span class="o">=</span> <span class="mi">150</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTisa</span> <span class="o">=</span> <span class="n">dTisa</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elevation</span> <span class="o">=</span> <span class="n">elevation</span>

<div class="viewcode-block" id="PropagationEffects.flightEffects">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.PropagationEffects.flightEffects">[docs]</a>
    <span class="k">def</span> <span class="nf">flightEffects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nti</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="n">tai</span><span class="p">,</span> <span class="n">SPLi</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the sound pressure level and the acoustic pressure matrices accounting for propagation effects.</span>

<span class="sd">        :param int nti: Number of trajectory points</span>
<span class="sd">        :param ndarray theta: 1D array containing the directivity angles (deg)</span>
<span class="sd">        :param ndarray x: 1D array containing aircraft horizontal distance relative to the microphone (m)</span>
<span class="sd">        :param ndarray y: 1D array containing aircraft altitude relative to the microphone (m)</span>
<span class="sd">        :param ndarray r1: 1D array containing aircraft distance relative to the microphone (m)</span>
<span class="sd">        :param ndarray tai: 1D array containing atmospheric temperature (K)</span>
<span class="sd">        :param ndarray SPLi: 3D array containing Sound pressure level at the source (dB)</span>
<span class="sd">        :param string comp: Noise component</span>

<span class="sd">        :return: An SPL and a prms array</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Convective amplification - source motion effect</span>
        <span class="n">DF</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Mach</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">thet</span><span class="p">))))</span> <span class="k">for</span> <span class="n">thet</span> <span class="ow">in</span> <span class="n">theta</span><span class="p">])</span>
        <span class="n">SPLi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">SPLi</span><span class="p">[</span><span class="n">i_f</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">-</span> <span class="mi">40</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">DF</span><span class="p">)</span> <span class="k">for</span> <span class="n">i_f</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)])</span>

        <span class="c1"># Only one directivity reaches the microphone. Here we choose the element in the directivity vector closest</span>
        <span class="c1"># to the computed angle.</span>
        <span class="n">closest_value_ptr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">theta</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">xsii_a</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span> <span class="k">for</span> <span class="n">xsii_a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xsii_alpha</span><span class="p">])</span>

        <span class="c1"># extract the directivity elements from the SPL matrix</span>
        <span class="n">SPLp_ds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">SPLi</span><span class="p">[:,</span> <span class="n">closest_value_ptr</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nti</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span>
        <span class="n">DF_mic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">DF</span><span class="p">[</span><span class="n">closest_value_ptr</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nti</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span>

        <span class="k">if</span> <span class="s1">&#39;tone&#39;</span> <span class="ow">in</span> <span class="n">comp</span> <span class="ow">or</span> <span class="s1">&#39;combination&#39;</span> <span class="ow">in</span> <span class="n">comp</span><span class="p">:</span>
            <span class="n">SPLp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tones_to_3rd_octave_bands</span><span class="p">(</span><span class="n">SPLp_ds</span><span class="p">,</span> <span class="n">DF_mic</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">SPLp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_to_3rd_octave_bands</span><span class="p">(</span><span class="n">SPLp_ds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fupper_ds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">flower_ds</span><span class="p">)</span>
        <span class="n">prmsp</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">SPLp</span><span class="p">)</span>

        <span class="n">pa</span> <span class="o">=</span> <span class="n">AtmosphericEffects</span><span class="o">.</span><span class="n">get_p_ambient</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ymic</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">elevation</span><span class="p">)</span>

        <span class="n">rho_ac</span> <span class="o">=</span> <span class="n">pa</span> <span class="o">/</span> <span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">Risa</span> <span class="o">*</span> <span class="n">tai</span><span class="p">)</span>
        <span class="n">c_ac</span> <span class="o">=</span> <span class="n">AtmosphericEffects</span><span class="o">.</span><span class="n">get_sound_speed</span><span class="p">(</span><span class="n">tai</span><span class="p">)</span>
        <span class="n">pa_mic</span> <span class="o">=</span> <span class="n">AtmosphericEffects</span><span class="o">.</span><span class="n">get_p_ambient</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ymic</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">elevation</span><span class="p">)</span>
        <span class="n">t_mic</span> <span class="o">=</span> <span class="n">AtmosphericEffects</span><span class="o">.</span><span class="n">get_t_ambient</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ymic</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">elevation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTisa</span><span class="p">)</span>
        <span class="n">rho_mic</span> <span class="o">=</span> <span class="n">pa_mic</span> <span class="o">/</span> <span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">Risa</span> <span class="o">*</span> <span class="n">t_mic</span><span class="p">)</span>
        <span class="n">c_mic</span> <span class="o">=</span> <span class="n">AtmosphericEffects</span><span class="o">.</span><span class="n">get_sound_speed</span><span class="p">(</span><span class="n">t_mic</span><span class="p">)</span>
        <span class="n">impedance_factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">rho_mic</span> <span class="o">*</span> <span class="n">c_mic</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">rho_ac</span> <span class="o">*</span> <span class="n">c_ac</span><span class="p">))</span>
        <span class="c1"># spherical spreading/ characteristic impedance</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">spherical_spr</span><span class="p">:</span>
            <span class="n">SPLp</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">prms2SPL</span><span class="p">(</span><span class="n">prmsp</span> <span class="o">/</span> <span class="n">r1</span> <span class="o">*</span> <span class="n">impedance_factor</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">SPLp</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">prms2SPL</span><span class="p">(</span><span class="n">prmsp</span> <span class="o">*</span> <span class="n">impedance_factor</span><span class="p">)</span>

        <span class="n">prmsp</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">SPLp</span><span class="p">)</span>

        <span class="c1"># Ground Reflection and atmospheric absorption</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_ground_refl</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">atm_atten</span><span class="p">:</span>
            <span class="n">sub_band</span><span class="p">,</span> <span class="n">prms_band</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subband_division</span><span class="p">(</span><span class="n">prmsp</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">atm_atten</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;atm_absorption&#39;</span><span class="p">):</span>
                    <span class="c1"># Coefficients remain the same for all components. Save to reuse in the next component</span>
                    <span class="n">atm_absorption</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">atmospheric_attenuation</span><span class="p">(</span><span class="n">ta_i</span><span class="p">,</span> <span class="n">pa</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">RH</span><span class="p">,</span> <span class="n">r1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">sub_band</span><span class="p">,</span>
                                                      <span class="n">third_octave_band</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ta_i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tai</span><span class="p">)])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">atm_absorption</span> <span class="o">=</span> <span class="n">atm_absorption</span><span class="o">.</span><span class="n">T</span>

                <span class="n">prms_band</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">choice_aux</span><span class="o">.</span><span class="n">prms2SPL</span><span class="p">(</span><span class="n">prms_band</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">atm_absorption</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_ground_refl</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;ground_refl&#39;</span><span class="p">):</span>
                    <span class="n">G1mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">ground_reflection</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">r1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">t_mic</span><span class="p">,</span> <span class="n">sub_band</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nti</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ground_refl</span> <span class="o">=</span> <span class="n">G1mat</span>

                <span class="n">prms_band</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ground_refl</span> <span class="o">*</span> <span class="n">prms_band</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

            <span class="n">prmsp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subband_combination</span><span class="p">(</span><span class="n">prms_band</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="s2">&quot;__len__&quot;</span><span class="p">):</span>
            <span class="n">TL_lateral</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lateral_attenuation</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="s1">&#39;wing&#39;</span><span class="p">)</span>
            <span class="n">SPLp</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">prms2SPL</span><span class="p">(</span><span class="n">prmsp</span><span class="p">)</span> <span class="o">+</span> <span class="n">TL_lateral</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">SPLp</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">prms2SPL</span><span class="p">(</span><span class="n">prmsp</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fobs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">fband</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nti</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># observer frequencies are now in 1/3 octave bands</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fupper_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">fband</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">6</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nti</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flower_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">fband</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">6</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nti</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">SPLp</span><span class="p">,</span> <span class="n">prmsp</span><span class="p">]</span></div>


<div class="viewcode-block" id="PropagationEffects.ground_reflection">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.PropagationEffects.ground_reflection">[docs]</a>
    <span class="k">def</span> <span class="nf">ground_reflection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_plane</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="n">ta</span><span class="p">,</span> <span class="n">fband</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the ground effects factor for a sound wave that does not travel directly from the source to the</span>
<span class="sd">        observer.</span>

<span class="sd">        :param float y_plane: Aircraft altitude relative to the microphone (m)</span>
<span class="sd">        :param float r1: Aircraft distance relative to the microphone (m)</span>
<span class="sd">        :param float ta: Atmospheric static temperature (K)</span>
<span class="sd">        :param ndarray fband: 1D array containing the 1/3 octave band frequencies (Hz)</span>

<span class="sd">        :return array: 1D array containing ground effects factor</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ainc</span> <span class="o">=</span> <span class="mf">0.01</span>  <span class="c1"># incoherence coefficient</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="mi">225000</span>  <span class="c1"># specific flow resistance of the ground</span>
        <span class="n">nf</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fband</span><span class="p">)</span>

        <span class="n">y1</span> <span class="o">=</span> <span class="n">y_plane</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ymic</span>  <span class="c1"># aircraft altitude from the ground</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">Risa</span> <span class="o">*</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">gamma_air</span> <span class="o">*</span> <span class="n">ta</span><span class="p">)</span>

        <span class="n">r_xz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">r1</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">y_plane</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># ground distance to microphone</span>
        <span class="n">thet</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">atan</span><span class="p">((</span><span class="n">y1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ymic</span><span class="p">)</span> <span class="o">/</span> <span class="n">r_xz</span><span class="p">)</span>  <span class="c1"># incidence angle</span>
        <span class="n">dr</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ymic</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">thet</span><span class="p">)</span>  <span class="c1"># path length difference</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">+</span> <span class="n">dr</span>  <span class="c1"># source image to receiver distance</span>

        <span class="n">k</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">fband</span> <span class="o">/</span> <span class="n">c</span>  <span class="c1"># wave number k</span>
        <span class="n">eta</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">rhoisa</span> <span class="o">/</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">*</span> <span class="n">fband</span>  <span class="c1"># dimensionless frequency</span>

        <span class="c1"># complex specific ground admittance</span>
        <span class="n">ny</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="mf">6.86</span> <span class="o">*</span> <span class="n">e</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.75</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="mf">4.36</span> <span class="o">*</span> <span class="n">e</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.73</span><span class="p">))</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">eta</span><span class="p">])</span>

        <span class="c1"># specific ground admittance</span>
        <span class="n">tau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">cmath</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">k_i</span> <span class="o">*</span> <span class="n">r2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="n">j</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">thet</span><span class="p">)</span> <span class="o">+</span> <span class="n">ny</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">k_i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">k</span><span class="p">)])</span>

        <span class="n">Fcap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">nf</span><span class="p">,</span> <span class="nb">complex</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">taui</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tau</span><span class="p">):</span>
            <span class="c1"># Use Faddeeva function https://en.wikipedia.org/wiki/Faddeeva_function</span>
            <span class="n">Fcap</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">taui</span> <span class="o">*</span> <span class="n">special</span><span class="o">.</span><span class="n">wofz</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">taui</span><span class="p">)</span>

        <span class="n">gam</span> <span class="o">=</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">thet</span><span class="p">)</span> <span class="o">-</span> <span class="n">ny</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">thet</span><span class="p">)</span> <span class="o">+</span> <span class="n">ny</span><span class="p">)</span>  <span class="c1"># complex plane-wave reflection coefficient</span>
        <span class="n">Amat</span> <span class="o">=</span> <span class="n">gam</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">gam</span><span class="p">)</span> <span class="o">*</span> <span class="n">Fcap</span>  <span class="c1"># a complex spherical-wave reflection coefficient</span>
        <span class="n">Rvec</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Amat</span><span class="p">)</span>  <span class="c1"># R = magnitude of the complex spherical-wave reflection coefficient</span>
        <span class="n">alfa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">real</span><span class="p">)</span> <span class="k">for</span> <span class="n">A</span> <span class="ow">in</span> <span class="n">Amat</span><span class="p">])</span>
        <span class="n">Ccap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">ainc</span> <span class="o">*</span> <span class="n">k</span> <span class="o">*</span> <span class="n">dr</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># coherence coefficient</span>

        <span class="n">Kcap</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mf">6.0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_b</span><span class="p">))</span>

        <span class="n">G1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">Rvec</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Rvec</span> <span class="o">*</span> <span class="n">Ccap</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">alfa</span> <span class="o">+</span> <span class="n">k</span> <span class="o">*</span> <span class="n">dr</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">((</span><span class="n">Kcap</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">k</span> <span class="o">*</span> <span class="n">dr</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">Kcap</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">k</span> <span class="o">*</span> <span class="n">dr</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">G1</span></div>


<div class="viewcode-block" id="PropagationEffects.getDopplerShift">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.PropagationEffects.getDopplerShift">[docs]</a>
    <span class="k">def</span> <span class="nf">getDopplerShift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fband</span><span class="p">,</span> <span class="n">xsii</span><span class="p">,</span> <span class="n">Mai</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Computes the frequency shift due to the movement of the aircraft. &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">fb</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">Mai</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">xsii</span><span class="p">))</span> <span class="k">for</span> <span class="n">fb</span> <span class="ow">in</span> <span class="n">fband</span><span class="p">])</span></div>


<div class="viewcode-block" id="PropagationEffects.subband_division">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.PropagationEffects.subband_division">[docs]</a>
    <span class="k">def</span> <span class="nf">subband_division</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prms</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Divide into subbands to be used in the ground effects application.&quot;&quot;&quot;</span>

        <span class="c1"># Ratio of subband center frequencies</span>
        <span class="n">w</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_b</span><span class="p">))</span>

        <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_b</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">N_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Subband center frequency</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">w</span> <span class="o">**</span> <span class="p">(</span><span class="n">h</span> <span class="o">-</span> <span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">fb</span> <span class="k">for</span> <span class="n">fb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fband</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_b</span><span class="p">)</span>

        <span class="c1"># Calculate prms for each subband</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">prms</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">prms</span><span class="p">)</span>
        <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">prms</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">prms</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># slope in lower half of band</span>
        <span class="n">v</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span>  <span class="c1"># slope in upper half of band</span>
        <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">v</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>

        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ui</span> <span class="o">**</span> <span class="p">((</span><span class="n">h</span><span class="p">[:</span><span class="n">m</span><span class="p">]</span> <span class="o">-</span> <span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_b</span><span class="p">)</span> <span class="o">+</span> <span class="n">vi</span> <span class="o">**</span> <span class="p">(</span><span class="n">h</span><span class="p">[:</span><span class="n">m</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_b</span><span class="p">))</span> <span class="k">for</span> <span class="n">ui</span><span class="p">,</span> <span class="n">vi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">u</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">v</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span>
                      <span class="nb">range</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span><span class="o">.</span><span class="n">T</span>

        <span class="n">prms_subband</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="n">prms</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">):</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_b</span> <span class="o">+</span> <span class="n">h</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">prms_subband</span><span class="p">[</span><span class="n">j</span><span class="p">[:</span><span class="n">m</span><span class="p">],</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">prms</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">prms</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">[:</span><span class="n">m</span><span class="p">]),</span> <span class="mi">1</span><span class="p">))</span>
                                              <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="p">((</span><span class="n">h</span><span class="p">[:</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">[:</span><span class="n">m</span><span class="p">]),</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_b</span><span class="p">))</span>
            <span class="n">prms_subband</span><span class="p">[</span><span class="n">j</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">prms</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">prms_subband</span><span class="p">[</span><span class="n">j</span><span class="p">[</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:],</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
                <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">prms</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">prms</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]),</span> <span class="mi">1</span><span class="p">))</span>
                 <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="p">((</span><span class="n">h</span><span class="p">[</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]),</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_b</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">prms_subband</span></div>


<div class="viewcode-block" id="PropagationEffects.subband_combination">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.PropagationEffects.subband_combination">[docs]</a>
    <span class="k">def</span> <span class="nf">subband_combination</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prms_subband</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Combine into subband prms.&quot;&quot;&quot;</span>

        <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_b</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">prms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">prms_subband</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">):</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_b</span> <span class="o">+</span> <span class="n">h</span>
            <span class="n">prms</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">prms_subband</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">prms</span></div>


<div class="viewcode-block" id="PropagationEffects.tones_to_3rd_octave_bands">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.PropagationEffects.tones_to_3rd_octave_bands">[docs]</a>
    <span class="k">def</span> <span class="nf">tones_to_3rd_octave_bands</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spl_dop</span><span class="p">,</span> <span class="n">DF</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Convert dopplerized frequency spectrum of tonal components to 1/3 octave bands&quot;&quot;&quot;</span>

        <span class="n">dn</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">DF</span><span class="p">)</span>
        <span class="n">nt</span> <span class="o">=</span> <span class="n">spl_dop</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">spl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">spl_dop</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nt</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dn</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">dn</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">dn</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                    <span class="n">spl</span><span class="p">[</span><span class="n">n</span><span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">spl_dop</span><span class="p">[:</span><span class="o">-</span><span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">dn</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                    <span class="n">spl</span><span class="p">[:</span><span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">spl_dop</span><span class="p">[</span><span class="o">-</span><span class="n">n</span><span class="p">:,</span> <span class="n">i</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">spl</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">spl_dop</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">spl</span></div>


<div class="viewcode-block" id="PropagationEffects.convert_to_3rd_octave_bands">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.PropagationEffects.convert_to_3rd_octave_bands">[docs]</a>
    <span class="k">def</span> <span class="nf">convert_to_3rd_octave_bands</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spl_dop</span><span class="p">,</span> <span class="n">fdop_u</span><span class="p">,</span> <span class="n">fdop_l</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Convert dopplerized frequency spectrum to 1/3 octave bands&quot;&quot;&quot;</span>

        <span class="n">fband</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fband</span>
        <span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">choice_data</span><span class="o">.</span><span class="n">fmin</span><span class="p">,</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">fmax</span><span class="p">)</span>
        <span class="n">fband_upper</span> <span class="o">=</span> <span class="n">fband</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">6</span><span class="p">))</span>
        <span class="n">fband_lower</span> <span class="o">=</span> <span class="n">fband</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">6</span><span class="p">))</span>
        <span class="n">nt</span> <span class="o">=</span> <span class="n">spl_dop</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">spl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">spl_dop</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nt</span><span class="p">):</span>
            <span class="n">spl_narrow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_to_narrowband</span><span class="p">(</span><span class="n">spl_dop</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">fdop_u</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">fdop_l</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">freq</span><span class="p">)</span>
            <span class="c1"># Compute mean square acoustic pressure in the narrowband frequencies</span>
            <span class="n">psd_initial</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">spl_narrow</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
            <span class="c1"># Sum mean square acoustic pressures falling in the same 1/3 octave band</span>
            <span class="n">pressure_amplitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">fband</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">fi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">):</span>
                <span class="n">freq_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">freq</span> <span class="o">&gt;=</span> <span class="n">fband_lower</span><span class="p">[</span><span class="n">fi</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">freq</span> <span class="o">&lt;=</span> <span class="n">fband_upper</span><span class="p">[</span><span class="n">fi</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">portion_lower</span> <span class="o">=</span> <span class="n">fband_lower</span><span class="p">[</span><span class="n">fi</span><span class="p">]</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">fband_lower</span><span class="p">[</span><span class="n">fi</span><span class="p">])</span>
                <span class="n">portion_upper</span> <span class="o">=</span> <span class="n">fband_upper</span><span class="p">[</span><span class="n">fi</span><span class="p">]</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">fband_upper</span><span class="p">[</span><span class="n">fi</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">fi</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">psd_band</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">psd_initial</span><span class="p">[</span><span class="n">freq_ind</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span> <span class="o">+</span> <span class="n">psd_initial</span><span class="p">[</span><span class="n">freq_ind</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">portion_lower</span><span class="p">)</span> <span class="o">+</span> \
                               <span class="n">psd_initial</span><span class="p">[</span><span class="n">freq_ind</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">*</span> <span class="n">portion_upper</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">psd_band</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">psd_initial</span><span class="p">[</span><span class="n">freq_ind</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span> <span class="o">+</span> <span class="n">psd_initial</span><span class="p">[</span><span class="n">freq_ind</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">*</span> <span class="n">portion_upper</span>
                <span class="c1"># Compute pressure amplitude at desired frequency resolution</span>
                <span class="n">pressure_amplitude</span><span class="p">[</span><span class="n">fi</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">psd_band</span><span class="p">)</span>
            <span class="n">spl</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">prms2SPL</span><span class="p">(</span><span class="n">pressure_amplitude</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">spl</span></div>


<div class="viewcode-block" id="PropagationEffects.convert_to_narrowband">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.PropagationEffects.convert_to_narrowband">[docs]</a>
    <span class="k">def</span> <span class="nf">convert_to_narrowband</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Lp</span><span class="p">,</span> <span class="n">fupper</span><span class="p">,</span> <span class="n">flower</span><span class="p">,</span> <span class="n">fc_new</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Compute the narrowband spectrum&quot;&quot;&quot;</span>

        <span class="n">Lp_narrow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">fc_new</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">prms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">fc_new</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">jfend</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">fc_new</span> <span class="o">&gt;=</span> <span class="n">flower</span><span class="p">[</span><span class="mi">0</span><span class="p">]))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">fi</span><span class="p">,</span> <span class="n">lp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Lp</span><span class="p">):</span>
            <span class="c1"># Compute number of narrowband bins in the band</span>
            <span class="n">nf</span> <span class="o">=</span> <span class="p">(</span><span class="n">fc_new</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">fc_new</span> <span class="o">&gt;=</span> <span class="n">flower</span><span class="p">[</span><span class="n">fi</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">fc_new</span> <span class="o">&lt;=</span> <span class="n">fupper</span><span class="p">[</span><span class="n">fi</span><span class="p">]))])</span><span class="o">.</span><span class="n">size</span>
            <span class="n">jfstart</span> <span class="o">=</span> <span class="n">jfend</span>
            <span class="n">jfend</span> <span class="o">=</span> <span class="n">jfend</span> <span class="o">+</span> <span class="n">nf</span>
            <span class="c1"># Compute mean square acoustic pressure and divide with the number of bins within the band</span>
            <span class="n">prms_sq</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">SPL2prms</span><span class="p">(</span><span class="n">lp</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
            <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">prms</span><span class="p">[</span><span class="n">jfstart</span><span class="p">:</span><span class="n">jfend</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">prms_sq</span> <span class="o">/</span> <span class="n">nf</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">prms</span><span class="p">[</span><span class="n">jfstart</span><span class="p">:</span><span class="n">jfend</span><span class="p">]</span> <span class="o">=</span> <span class="n">choice_data</span><span class="o">.</span><span class="n">p0</span>
            <span class="n">Lp_narrow</span><span class="p">[</span><span class="n">jfstart</span><span class="p">:</span><span class="n">jfend</span><span class="p">]</span> <span class="o">=</span> <span class="n">choice_aux</span><span class="o">.</span><span class="n">prms2SPL</span><span class="p">(</span><span class="n">prms</span><span class="p">[</span><span class="n">jfstart</span><span class="p">:</span><span class="n">jfend</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">Lp_narrow</span></div>


<div class="viewcode-block" id="PropagationEffects.atmospheric_attenuation">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.PropagationEffects.atmospheric_attenuation">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">atmospheric_attenuation</span><span class="p">(</span><span class="n">t_k</span><span class="p">,</span> <span class="n">pa</span><span class="p">,</span> <span class="n">relHum</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">fband</span><span class="p">,</span> <span class="n">third_octave_band</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the absorption for a sound wave travelling through the atmosphere. Modelled according to the</span>
<span class="sd">        ISO 9613-1:1993 report.</span>

<span class="sd">        :param t_k: 1D array containing atmospheric temperature (K)</span>
<span class="sd">        :param pa: 1D array containing atmospheric pressure (Pa)</span>
<span class="sd">        :param float relHum: Relative humidity</span>
<span class="sd">        :param r: 1D array containing distance between source and observer (m)</span>
<span class="sd">        :param ndarray fband: 1D array containing the 1/3 octave band frequencies (Hz)</span>
<span class="sd">        :param bool third_octave_band: If True 1/3 octave bands are used and coefficients are estimated using the Volpe</span>
<span class="sd">            method (E. D. Rickley, G. G. Fleming, C. Roof. &quot;Simplified procedure for computing the absorption of sound</span>
<span class="sd">            by the atmosphere&quot;)</span>

<span class="sd">        :return ndarray: 1D array containing the atmospheric absorption in dB.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pr</span> <span class="o">=</span> <span class="mi">101325</span>  <span class="c1"># Reference pressure (Pa)</span>
        <span class="n">Tr</span> <span class="o">=</span> <span class="mf">293.15</span>  <span class="c1"># Reference temperature (K)</span>
        <span class="n">T01</span> <span class="o">=</span> <span class="mf">273.16</span>  <span class="c1"># Triple-point isotherm temperature</span>

        <span class="c1"># Molar concentration of water vapour</span>
        <span class="n">V</span> <span class="o">=</span> <span class="mf">10.79586</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">T01</span> <span class="o">/</span> <span class="n">t_k</span><span class="p">)</span> <span class="o">-</span> <span class="mf">5.02808</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">t_k</span> <span class="o">/</span> <span class="n">T01</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.50474e-4</span> <span class="o">*</span> <span class="p">(</span>
                    <span class="mi">1</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">8.29692</span> <span class="o">*</span> <span class="p">(</span><span class="n">t_k</span> <span class="o">/</span> <span class="n">T01</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span> \
            <span class="o">+</span> <span class="mf">0.42873e-3</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">**</span> <span class="mf">4.76955</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">T01</span> <span class="o">/</span> <span class="n">t_k</span><span class="p">))</span> <span class="o">-</span> <span class="mf">2.2195983</span>
        <span class="n">psat</span> <span class="o">=</span> <span class="n">pr</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">V</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">relHum</span> <span class="o">*</span> <span class="p">(</span><span class="n">psat</span> <span class="o">/</span> <span class="n">pr</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">pa</span> <span class="o">/</span> <span class="n">pr</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Relaxation frequency of oxygen</span>
        <span class="n">fro</span> <span class="o">=</span> <span class="n">pa</span> <span class="o">/</span> <span class="n">pr</span> <span class="o">*</span> <span class="p">(</span><span class="mf">24.0</span> <span class="o">+</span> <span class="mf">4.04</span> <span class="o">*</span> <span class="mf">10.0</span> <span class="o">**</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">h</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.02</span> <span class="o">+</span> <span class="n">h</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.391</span> <span class="o">+</span> <span class="n">h</span><span class="p">))</span>

        <span class="c1"># Relaxation frequency of nitrogen</span>
        <span class="n">frn</span> <span class="o">=</span> <span class="n">pa</span> <span class="o">/</span> <span class="n">pr</span> <span class="o">*</span> <span class="p">(</span><span class="n">t_k</span> <span class="o">/</span> <span class="n">Tr</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">9.0</span> <span class="o">+</span> <span class="mf">280.0</span> <span class="o">*</span> <span class="n">h</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">4.170</span> <span class="o">*</span> <span class="p">((</span><span class="n">t_k</span> <span class="o">/</span> <span class="n">Tr</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)))</span>

        <span class="c1"># Mid-band attenuation rate in dB/m</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mf">8.686</span> <span class="o">*</span> <span class="n">fband</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="mf">1.84</span> <span class="o">*</span> <span class="mf">10.0</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">11.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">pr</span> <span class="o">/</span> <span class="n">pa</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">t_k</span> <span class="o">/</span> <span class="n">Tr</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">t_k</span> <span class="o">/</span> <span class="n">Tr</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">)</span> <span class="o">*</span>
                                      <span class="p">(</span><span class="mf">0.01275</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">2239.1</span> <span class="o">/</span> <span class="n">t_k</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">fro</span> <span class="o">/</span> <span class="p">(</span><span class="n">fband</span> <span class="o">**</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="n">fro</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span>
                                       <span class="mf">0.1068</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">3352.0</span> <span class="o">/</span> <span class="n">t_k</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">frn</span> <span class="o">/</span> <span class="p">(</span><span class="n">fband</span> <span class="o">**</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="n">frn</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))))</span>
        <span class="c1"># Mid_band attenuation in dB</span>
        <span class="n">delta_t</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">r</span>

        <span class="c1"># Volpe Method for calculating attenuation by atmospheric absorption on wideband sounds analyzed by 1/3</span>
        <span class="c1"># octave-band filters</span>
        <span class="k">if</span> <span class="n">third_octave_band</span><span class="p">:</span>
            <span class="n">A</span> <span class="o">=</span> <span class="mf">0.867942</span>
            <span class="n">B</span> <span class="o">=</span> <span class="mf">0.111761</span>
            <span class="n">C</span> <span class="o">=</span> <span class="mf">0.95824</span>
            <span class="n">D</span> <span class="o">=</span> <span class="mf">0.008191</span>
            <span class="n">E</span> <span class="o">=</span> <span class="mf">1.6</span>
            <span class="n">F</span> <span class="o">=</span> <span class="mf">9.2</span>
            <span class="n">G</span> <span class="o">=</span> <span class="mf">0.765</span>
            <span class="n">delta_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">delta_t</span><span class="p">)</span>
            <span class="n">delta_b</span><span class="p">[</span><span class="n">delta_t</span> <span class="o">&lt;</span> <span class="mi">150</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="n">delta_t</span><span class="p">[</span><span class="n">delta_t</span> <span class="o">&lt;</span> <span class="mi">150</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">B</span> <span class="o">*</span> <span class="p">(</span><span class="n">C</span> <span class="o">-</span> <span class="n">D</span> <span class="o">*</span> <span class="n">delta_t</span><span class="p">[</span><span class="n">delta_t</span> <span class="o">&lt;</span> <span class="mi">150</span><span class="p">]))</span> <span class="o">**</span> <span class="n">E</span>
            <span class="n">delta_b</span><span class="p">[</span><span class="n">delta_t</span> <span class="o">&gt;=</span> <span class="mi">150</span><span class="p">]</span> <span class="o">=</span> <span class="n">F</span> <span class="o">+</span> <span class="n">G</span> <span class="o">*</span> <span class="n">delta_t</span><span class="p">[</span><span class="n">delta_t</span> <span class="o">&gt;=</span> <span class="mi">150</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">delta_b</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">delta_t</span></div>


<div class="viewcode-block" id="PropagationEffects.lateral_attenuation">
<a class="viewcode-back" href="../../source/api/choice.html#choice.choice_physics.PropagationEffects.lateral_attenuation">[docs]</a>
    <span class="k">def</span> <span class="nf">lateral_attenuation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;wing&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of engine-installation effects (lateral directional effects attributed to wing or fuselage mounted</span>
<span class="sd">        engines) for conventional aircraft. The method is based on the SAE AIR 5662 report, &quot;Method for Predicting Lateral</span>
<span class="sd">        Attenuation of Airplane Noise&quot;.</span>

<span class="sd">        :param phi: depression angle (deg)</span>
<span class="sd">        :param engine: wing or fus depending on where the engine is mounted</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># The method accounts for engine installation effects, ground effects and refraction and scattering due to wind</span>
        <span class="c1"># and meteorological conditions. Here only the installations effects are implemented as more accurate models are</span>
        <span class="c1"># used for the propagation effects in all directions (not just lateral). The correction for installation effects is</span>
        <span class="c1"># applied to the total aircraft source noise, directly under it</span>

        <span class="n">phi</span><span class="p">[</span><span class="n">phi</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">phi</span><span class="p">[</span><span class="n">phi</span> <span class="o">&gt;</span> <span class="mi">180</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">phi_rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>

        <span class="n">Einst</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">phi_rad</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;wing&#39;</span> <span class="ow">in</span> <span class="n">engine</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="c1"># Engine installation effects for wing mounted engines</span>
            <span class="n">Einst</span> <span class="o">=</span> <span class="n">Einst</span> <span class="o">-</span> <span class="mf">1.49</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">phi</span> <span class="o">&lt;=</span> <span class="mi">180</span><span class="p">)</span>
            <span class="n">Einst</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">((</span><span class="mf">0.0039</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi_rad</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi_rad</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.062</span> <span class="o">/</span>
                                       <span class="p">(</span><span class="mf">0.8786</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">phi_rad</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">phi_rad</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
        <span class="k">elif</span> <span class="s1">&#39;fus&#39;</span> <span class="ow">in</span> <span class="n">engine</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="c1"># Engine installation effects for fuselage mounted engines</span>
            <span class="n">Einst</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">((</span><span class="mf">0.1225</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi_rad</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi_rad</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.329</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Lateral attenuation method is not valid for this configuration and it will be ignored&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">Einst</span></div>
</div>



<span class="k">class</span> <span class="nc">PerceivedNoiseMetrics</span><span class="p">:</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">getPNL</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">nti</span><span class="p">,</span> <span class="n">fdoppler</span><span class="p">,</span> <span class="n">SPLp</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the Perceived Noise Level.</span>

<span class="sd">        :param int nti: Number of times (for interpolated grid)</span>
<span class="sd">        :param ndarray fdoppler: 1D array containing the Doppler shifted frequency (Hz)</span>
<span class="sd">        :param ndarray SPLp: 2D array containing Sound Pressure Level (dB)</span>

<span class="sd">        :return ndarray: 1D array containing PNL</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">vec2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nti</span><span class="p">)</span>
        <span class="n">Ffactor</span> <span class="o">=</span> <span class="mf">0.15</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nti</span><span class="p">):</span>
            <span class="n">wrk</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">getNoys</span><span class="p">(</span><span class="n">fdoppler</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">SPLp</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
            <span class="n">vec1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">wrk</span><span class="p">)</span>
            <span class="n">vec2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">Ffactor</span><span class="p">)</span> <span class="o">*</span> <span class="n">vec1</span> <span class="o">+</span> <span class="n">Ffactor</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">(</span><span class="n">wrk</span><span class="p">)</span>

        <span class="k">return</span> <span class="mf">40.0</span> <span class="o">+</span> <span class="p">(</span><span class="mf">10.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">vec2</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">getPNLT</span><span class="p">(</span><span class="n">nti</span><span class="p">,</span> <span class="n">fband</span><span class="p">,</span> <span class="n">PNL</span><span class="p">,</span> <span class="n">SPL</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the Perceived Noise Level corrected for spectral irregularities</span>

<span class="sd">        :param int nti: Number of times / points</span>
<span class="sd">        :param ndarray fband: 1D array containing octave band frequencies (Hz)</span>
<span class="sd">        :param ndarray PNL: 1D array containing Perceived Noise Level (dB)</span>
<span class="sd">        :param ndarray SPL: 2D array containing Sound Pressure Level (dB)</span>

<span class="sd">        :return ndarray: 1D array containing PNLT</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nfr</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fband</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfr</span><span class="p">,</span> <span class="n">nti</span><span class="p">))</span>
        <span class="n">encircled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfr</span><span class="p">,</span> <span class="n">nti</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">snew</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfr</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nti</span><span class="p">))</span>
        <span class="n">sbar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfr</span><span class="p">,</span> <span class="n">nti</span><span class="p">))</span>
        <span class="n">SPLfinal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfr</span><span class="p">,</span> <span class="n">nti</span><span class="p">))</span>

        <span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="n">nfr</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">SPL</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="n">nfr</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">SPL</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="n">nfr</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nfr</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nti</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mf">5.0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span> <span class="ow">and</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">]:</span>
                        <span class="n">encircled</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">elif</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.0</span> <span class="o">&lt;</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">]:</span>
                        <span class="n">encircled</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">SPLnew</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfr</span><span class="p">,</span> <span class="n">nti</span><span class="p">))</span>

        <span class="n">SPLnew</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">SPL</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">SPLnew</span><span class="p">[</span><span class="n">encircled</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">SPL</span><span class="p">[</span><span class="n">encircled</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nfr</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nti</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">23</span> <span class="ow">and</span> <span class="n">encircled</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">SPLnew</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">SPL</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">SPL</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">])</span>
                <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">23</span> <span class="ow">and</span> <span class="n">encircled</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">SPLnew</span><span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">SPL</span><span class="p">[</span><span class="mi">22</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="mi">22</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span>

        <span class="c1"># new slopes</span>
        <span class="n">snew</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="n">nfr</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">SPLnew</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="n">nfr</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">SPLnew</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="n">nfr</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">snew</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">snew</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">snew</span><span class="p">[</span><span class="n">nfr</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">snew</span><span class="p">[</span><span class="n">nfr</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>

        <span class="n">sbar</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="n">nfr</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">snew</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="n">nfr</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span> <span class="n">snew</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="n">nfr</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span> <span class="n">snew</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="n">nfr</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>

        <span class="c1"># SPLfinal</span>
        <span class="n">SPLfinal</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">SPL</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">nfr</span><span class="p">):</span>
            <span class="n">SPLfinal</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">SPLfinal</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span> <span class="n">sbar</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>

        <span class="c1"># difference</span>
        <span class="n">F</span> <span class="o">=</span> <span class="n">SPL</span> <span class="o">-</span> <span class="n">SPLfinal</span>

        <span class="n">F</span><span class="p">[</span><span class="n">F</span> <span class="o">&lt;</span> <span class="mf">1.5</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">F</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">nfr</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nti</span><span class="p">):</span>
                <span class="k">if</span> <span class="mf">500.0</span> <span class="o">&gt;</span> <span class="n">fband</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">50.0</span> <span class="ow">or</span> <span class="n">fband</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">5000.0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="mf">3.0</span> <span class="o">&lt;=</span> <span class="n">F</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">20.0</span><span class="p">:</span>
                        <span class="n">F</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">F</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">/</span> <span class="mf">6.0</span>
                    <span class="k">elif</span> <span class="n">F</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">20.0</span><span class="p">:</span>
                        <span class="n">F</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="o">/</span> <span class="mf">3.0</span>
                    <span class="k">elif</span> <span class="mf">1.5</span> <span class="o">&lt;=</span> <span class="n">F</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">3.0</span><span class="p">:</span>
                        <span class="n">F</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">F</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">/</span> <span class="mf">3.0</span> <span class="o">-</span> <span class="mf">0.5</span>
                <span class="k">elif</span> <span class="mf">500.0</span> <span class="o">&lt;=</span> <span class="n">fband</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">5000.0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="mf">3.0</span> <span class="o">&lt;=</span> <span class="n">F</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">20.0</span><span class="p">:</span>
                        <span class="n">F</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">F</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">/</span> <span class="mf">3.0</span>
                    <span class="k">elif</span> <span class="n">F</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">20.0</span><span class="p">:</span>
                        <span class="n">F</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">20.0</span> <span class="o">/</span> <span class="mf">3.0</span>
                    <span class="k">elif</span> <span class="mf">1.5</span> <span class="o">&lt;=</span> <span class="n">F</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">3.0</span><span class="p">:</span>
                        <span class="n">F</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">F</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">/</span> <span class="mf">3.0</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">PNL</span> <span class="o">+</span> <span class="n">C</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">getEPNL</span><span class="p">(</span><span class="n">PNLT</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the Effective Perceived Noise Level.</span>

<span class="sd">        :param ndarray PNLT: 1D array containing the corrected Perceived Noise Level (dB)</span>
<span class="sd">        :param float dt: Sampling time interval or timestep at microphone (sec)</span>

<span class="sd">        :return float: EPNL</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">PNLTM</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">PNLT</span><span class="p">)</span>
        <span class="c1"># Duration correction D calculated based on the threshold PNLTM-10 for all the conditions</span>
        <span class="n">istart</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">PNLTM</span> <span class="o">-</span> <span class="n">PNLT</span> <span class="o">&lt;</span> <span class="mf">10.0</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">istop</span> <span class="o">=</span> <span class="n">istart</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">PNLTM</span> <span class="o">-</span> <span class="n">PNLT</span><span class="p">[</span><span class="n">istart</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">10.0</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">istop</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">PNLT</span><span class="p">):</span> <span class="n">istop</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">PNLT</span><span class="p">)</span>

        <span class="n">PNLTsum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">PNLT</span><span class="p">[</span><span class="n">istart</span><span class="p">:</span><span class="n">istop</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mf">10.0</span><span class="p">))</span>

        <span class="n">D</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">PNLTsum</span><span class="p">)</span> <span class="o">-</span> <span class="n">PNLTM</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dt</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">D</span> <span class="o">+</span> <span class="n">PNLTM</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">getNoys</span><span class="p">(</span><span class="n">fband</span><span class="p">,</span> <span class="n">SPL_vec</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Computes Noys metric from SPL and frequency. Source:</span>
<span class="sd">        https://www.ecfr.gov/current/title-14/chapter-I/subchapter-C/part-36/appendix-Appendix%20A%20to%20Part%2036&quot;&quot;&quot;</span>
        <span class="n">Noys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fband</span><span class="p">))</span>

        <span class="n">Mb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.043478</span><span class="p">,</span> <span class="mf">0.040570</span><span class="p">,</span> <span class="mf">0.036831</span><span class="p">,</span> <span class="mf">0.036831</span><span class="p">,</span> <span class="mf">0.035336</span><span class="p">,</span> <span class="mf">0.033333</span><span class="p">,</span> <span class="mf">0.033333</span><span class="p">,</span> <span class="mf">0.032051</span><span class="p">,</span> <span class="mf">0.030675</span><span class="p">,</span>
                       <span class="mf">0.030103</span><span class="p">,</span> <span class="mf">0.030103</span><span class="p">,</span> <span class="mf">0.030103</span><span class="p">,</span> <span class="mf">0.030103</span><span class="p">,</span> <span class="mf">0.030103</span><span class="p">,</span> <span class="mf">0.030103</span><span class="p">,</span> <span class="mf">0.029960</span><span class="p">,</span> <span class="mf">0.029960</span><span class="p">,</span> <span class="mf">0.029960</span><span class="p">,</span>
                       <span class="mf">0.029960</span><span class="p">,</span> <span class="mf">0.029960</span><span class="p">,</span> <span class="mf">0.029960</span><span class="p">,</span> <span class="mf">0.029960</span><span class="p">,</span> <span class="mf">0.042285</span><span class="p">,</span> <span class="mf">0.042285</span><span class="p">])</span>
        <span class="n">Mc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.030103</span><span class="p">,</span> <span class="mf">0.030103</span><span class="p">,</span> <span class="mf">0.030103</span><span class="p">,</span> <span class="mf">0.030103</span><span class="p">,</span> <span class="mf">0.030103</span><span class="p">,</span> <span class="mf">0.030103</span><span class="p">,</span> <span class="mf">0.030103</span><span class="p">,</span> <span class="mf">0.030103</span><span class="p">,</span> <span class="mf">0.030103</span><span class="p">,</span>
                       <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.029960</span><span class="p">,</span> <span class="mf">0.029960</span><span class="p">])</span>
        <span class="n">Md</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.079520</span><span class="p">,</span> <span class="mf">0.068160</span><span class="p">,</span> <span class="mf">0.068160</span><span class="p">,</span> <span class="mf">0.059640</span><span class="p">,</span> <span class="mf">0.053013</span><span class="p">,</span> <span class="mf">0.053013</span><span class="p">,</span> <span class="mf">0.053013</span><span class="p">,</span> <span class="mf">0.053013</span><span class="p">,</span> <span class="mf">0.053013</span><span class="p">,</span>
                       <span class="mf">0.053013</span><span class="p">,</span> <span class="mf">0.053013</span><span class="p">,</span> <span class="mf">0.053013</span><span class="p">,</span> <span class="mf">0.053013</span><span class="p">,</span> <span class="mf">0.053013</span><span class="p">,</span> <span class="mf">0.059640</span><span class="p">,</span> <span class="mf">0.053013</span><span class="p">,</span> <span class="mf">0.053013</span><span class="p">,</span> <span class="mf">0.047712</span><span class="p">,</span>
                       <span class="mf">0.047712</span><span class="p">,</span> <span class="mf">0.053013</span><span class="p">,</span> <span class="mf">0.053013</span><span class="p">,</span> <span class="mf">0.068160</span><span class="p">,</span> <span class="mf">0.079520</span><span class="p">,</span> <span class="mf">0.059640</span><span class="p">])</span>
        <span class="n">Me</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.058098</span><span class="p">,</span> <span class="mf">0.058098</span><span class="p">,</span> <span class="mf">0.052288</span><span class="p">,</span> <span class="mf">0.047534</span><span class="p">,</span> <span class="mf">0.043573</span><span class="p">,</span> <span class="mf">0.043573</span><span class="p">,</span> <span class="mf">0.040221</span><span class="p">,</span> <span class="mf">0.037349</span><span class="p">,</span> <span class="mf">0.034859</span><span class="p">,</span>
                       <span class="mf">0.034859</span><span class="p">,</span> <span class="mf">0.034859</span><span class="p">,</span> <span class="mf">0.034859</span><span class="p">,</span> <span class="mf">0.034859</span><span class="p">,</span> <span class="mf">0.034859</span><span class="p">,</span> <span class="mf">0.034859</span><span class="p">,</span> <span class="mf">0.040221</span><span class="p">,</span> <span class="mf">0.037349</span><span class="p">,</span> <span class="mf">0.034859</span><span class="p">,</span>
                       <span class="mf">0.034859</span><span class="p">,</span> <span class="mf">0.034859</span><span class="p">,</span> <span class="mf">0.034859</span><span class="p">,</span> <span class="mf">0.037349</span><span class="p">,</span> <span class="mf">0.037349</span><span class="p">,</span> <span class="mf">0.043573</span><span class="p">])</span>
        <span class="n">SPLa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">91.0</span><span class="p">,</span> <span class="mf">85.9</span><span class="p">,</span> <span class="mf">87.3</span><span class="p">,</span> <span class="mf">79.9</span><span class="p">,</span> <span class="mf">79.8</span><span class="p">,</span> <span class="mf">76.0</span><span class="p">,</span> <span class="mf">74.0</span><span class="p">,</span> <span class="mf">74.9</span><span class="p">,</span> <span class="mf">94.6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span>
                         <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mf">44.3</span><span class="p">,</span> <span class="mf">50.7</span><span class="p">])</span>
        <span class="n">SPLb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">64.0</span><span class="p">,</span> <span class="mf">60.0</span><span class="p">,</span> <span class="mf">56.0</span><span class="p">,</span> <span class="mf">53.0</span><span class="p">,</span> <span class="mf">51.0</span><span class="p">,</span> <span class="mf">48.0</span><span class="p">,</span> <span class="mf">46.0</span><span class="p">,</span> <span class="mf">44.0</span><span class="p">,</span> <span class="mf">42.0</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">,</span> <span class="mf">34.0</span><span class="p">,</span>
                         <span class="mf">32.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">29.0</span><span class="p">,</span> <span class="mf">29.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">37.0</span><span class="p">,</span> <span class="mf">41.0</span><span class="p">])</span>
        <span class="n">SPLc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">52.0</span><span class="p">,</span> <span class="mf">51.0</span><span class="p">,</span> <span class="mf">49.0</span><span class="p">,</span> <span class="mf">47.0</span><span class="p">,</span> <span class="mf">46.0</span><span class="p">,</span> <span class="mf">45.0</span><span class="p">,</span> <span class="mf">43.0</span><span class="p">,</span> <span class="mf">42.0</span><span class="p">,</span> <span class="mf">41.0</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">,</span> <span class="mf">34.0</span><span class="p">,</span>
                         <span class="mf">32.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">29.0</span><span class="p">,</span> <span class="mf">29.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">31.0</span><span class="p">,</span> <span class="mf">34.0</span><span class="p">,</span> <span class="mf">37.0</span><span class="p">])</span>
        <span class="n">SPLd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">49</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">21</span><span class="p">])</span>
        <span class="n">SPLe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="mi">55</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">29</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fb</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fband</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">SPL_vec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">SPLa</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">Noys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">Mc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">SPL_vec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">SPLc</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="k">elif</span> <span class="n">SPLb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">SPL_vec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">SPLa</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">Noys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">Mb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">SPL_vec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">SPLb</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="k">elif</span> <span class="n">SPLe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">SPL_vec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">SPLb</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">Noys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">Me</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">SPL_vec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">SPLe</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="k">elif</span> <span class="n">SPLd</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">SPL_vec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">SPLe</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">Noys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">Md</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">SPL_vec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">SPLd</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

        <span class="k">return</span> <span class="n">Noys</span>


<span class="k">class</span> <span class="nc">DynamicViscocity</span><span class="p">:</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Computes the dynamic viscocity for a given temperature. &quot;&quot;&quot;</span>
        <span class="n">mu_0</span> <span class="o">=</span> <span class="mf">17.1e-6</span>
        <span class="k">if</span> <span class="mf">273.15</span> <span class="o">&lt;=</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mf">373.15</span><span class="p">:</span>
            <span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.4743742289</span><span class="p">,</span> <span class="mf">0.0445219791</span><span class="p">,</span> <span class="mf">0.1651857290</span><span class="p">])</span>
        <span class="k">elif</span> <span class="mf">373.15</span> <span class="o">&lt;=</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mf">973.15</span><span class="p">:</span>
            <span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5688972460</span><span class="p">,</span> <span class="mf">0.0414204258</span><span class="p">,</span> <span class="mf">0.1192514508</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mf">273.15</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">17.1e-6</span>
        <span class="k">elif</span> <span class="n">t</span> <span class="o">&gt;</span> <span class="mf">973.15</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">41.5e-6</span>
        <span class="k">return</span> <span class="n">mu_0</span> <span class="o">*</span> <span class="p">((</span><span class="n">t</span> <span class="o">/</span> <span class="mf">288.15</span><span class="p">)</span> <span class="o">**</span> <span class="n">beta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">beta</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="mf">288.15</span><span class="p">)</span> <span class="o">+</span> <span class="n">beta</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">t</span> <span class="o">/</span> <span class="mf">288.15</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Evangelia Maria Thoma, Xin Zhao, Tomas Grönstedt.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>